<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é™æ€åº“å’ŒåŠ¨æ€åº“çš„ç¼–è¯‘</title>
      <link href="/2023/04/02/%E9%9D%99%E6%80%81%E5%BA%93%E5%92%8C%E5%8A%A8%E6%80%81%E5%BA%93%E7%9A%84%E7%BC%96%E8%AF%91/"/>
      <url>/2023/04/02/%E9%9D%99%E6%80%81%E5%BA%93%E5%92%8C%E5%8A%A8%E6%80%81%E5%BA%93%E7%9A%84%E7%BC%96%E8%AF%91/</url>
      
        <content type="html"><![CDATA[<h2 id="é™æ€åº“"><a href="#é™æ€åº“" class="headerlink" title="é™æ€åº“"></a>é™æ€åº“</h2><p>é™æ€åº“æ˜¯åœ¨ç¼–è¯‘æœŸé—´å°†åº“ä»£ç å’Œåº”ç”¨ç¨‹åºä»£ç åˆå¹¶åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„åº“ã€‚å› æ­¤ï¼Œé™æ€åº“çš„å¤§å°æ¯”è¾ƒå¤§ï¼Œä½†æ˜¯å®ƒçš„ä¼˜ç‚¹æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶ä¸éœ€è¦åŠ è½½åº“æ–‡ä»¶ï¼Œå› æ­¤æ‰§è¡Œé€Ÿåº¦æ¯”è¾ƒå¿«ã€‚é™æ€åº“çš„æ–‡ä»¶æ‰©å±•åé€šå¸¸ä¸º.a æˆ– .libã€‚</p><p><img src="https://typora-1307795383.cos.ap-chengdu.myqcloud.com/typora/%E9%9D%99%E6%80%81%E5%BA%93.svg" alt="é™æ€åº“"></p><h2 id="åŠ¨æ€åº“"><a href="#åŠ¨æ€åº“" class="headerlink" title="åŠ¨æ€åº“"></a>åŠ¨æ€åº“</h2><p>åŠ¨æ€åº“æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰åŠ è½½çš„åº“ï¼Œå› æ­¤å®ƒçš„æ–‡ä»¶å¤§å°æ¯”è¾ƒå°ã€‚åŠ¨æ€åº“çš„ä¼˜ç‚¹æ˜¯å¤šä¸ªç¨‹åºå¯ä»¥å…±äº«åŒä¸€ä¸ªåŠ¨æ€åº“ï¼Œä»è€ŒèŠ‚çœç³»ç»Ÿèµ„æºã€‚ä½†æ˜¯ï¼Œä¸é™æ€åº“ç›¸æ¯”ï¼Œå®ƒçš„æ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢ã€‚åŠ¨æ€åº“çš„æ–‡ä»¶æ‰©å±•åé€šå¸¸ä¸º.so æˆ– .dllã€‚</p><p><img src="https://typora-1307795383.cos.ap-chengdu.myqcloud.com/typora/%E5%8A%A8%E6%80%81%E5%BA%93%20%EF%BC%88%E5%85%B1%E4%BA%AB%E5%BA%93%EF%BC%89.svg" alt="åŠ¨æ€åº“ ï¼ˆå…±äº«åº“ï¼‰"></p><h2 id="é™æ€åº“å’ŒåŠ¨æ€åº“çš„åŒºåˆ«"><a href="#é™æ€åº“å’ŒåŠ¨æ€åº“çš„åŒºåˆ«" class="headerlink" title="é™æ€åº“å’ŒåŠ¨æ€åº“çš„åŒºåˆ«"></a>é™æ€åº“å’ŒåŠ¨æ€åº“çš„åŒºåˆ«</h2><p>é™æ€åº“å’ŒåŠ¨æ€åº“éƒ½æ˜¯ç”¨äºå­˜å‚¨ç¼–è¯‘åçš„äºŒè¿›åˆ¶ä»£ç å’Œå‡½æ•°åº“çš„æ–‡ä»¶ã€‚é™æ€åº“å’ŒåŠ¨æ€åº“çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒä»¬åœ¨ç¨‹åºç¼–è¯‘æœŸå’Œè¿è¡ŒæœŸçš„ä½¿ç”¨ä¸åŒã€‚</p><blockquote><p>æ€»çš„æ¥è¯´ï¼Œé™æ€åº“é€‚åˆäºå°å‹åº”ç”¨ç¨‹åºå’Œç‹¬ç«‹è¿è¡Œçš„ç¨‹åºï¼Œè€ŒåŠ¨æ€åº“é€‚åˆäºå¤§å‹åº”ç”¨ç¨‹åºå’Œéœ€è¦å…±äº«åº“çš„ç¨‹åºã€‚</p></blockquote><blockquote><p>ä¸‰ç§æ–‡ä»¶ï¼š</p><ul><li>å¤´æ–‡ä»¶ .h</li><li>åŠŸèƒ½æ–‡ä»¶ .c</li><li>ä¸»æ–‡ä»¶ .c</li></ul><p>ä½ç½®ï¼š</p><ul><li>å¤´æ–‡ä»¶ä¸€èˆ¬æ”¾åœ¨includeæ–‡ä»¶å¤¹é‡Œé¢</li><li>æ‰“åŒ…æˆåº“çš„ä¸€èˆ¬å°±æ˜¯åŠŸèƒ½æ–‡ä»¶ï¼Œæ”¾åœ¨libç›®å½•ä¸‹</li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> Cè¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cè¯­è¨€ </tag>
            
            <tag> åŠ¨æ€åº“ </tag>
            
            <tag> é™æ€åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€è¿›ç¨‹</title>
      <link href="/2023/03/31/C%E8%AF%AD%E8%A8%80%E8%BF%9B%E7%A8%8B/"/>
      <url>/2023/03/31/C%E8%AF%AD%E8%A8%80%E8%BF%9B%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¨‹åºå’Œè¿›ç¨‹"><a href="#ç¨‹åºå’Œè¿›ç¨‹" class="headerlink" title="ç¨‹åºå’Œè¿›ç¨‹"></a>ç¨‹åºå’Œè¿›ç¨‹</h2><blockquote><p>ç¨‹åºï¼šæ˜¯ä¸€äº›äºŒè¿›åˆ¶ã€æ•°æ®çš„æœ‰åºé›†åˆï¼Œæ²¡æœ‰è¢«åŠ è½½åˆ°å†…å­˜ã€‚æ²¡æœ‰â€œç”Ÿå‘½â€</p><p>è¿›ç¨‹ï¼šç¨‹åºæ‰§è¡Œçš„ä¸€æ¬¡çš„è¿‡ç¨‹ï¼Œèµ„æºåˆ†é…çš„æ€»æˆ</p></blockquote><h4 id="ç¨‹åºè¿è¡ŒçŠ¶æ€"><a href="#ç¨‹åºè¿è¡ŒçŠ¶æ€" class="headerlink" title="ç¨‹åºè¿è¡ŒçŠ¶æ€"></a>ç¨‹åºè¿è¡ŒçŠ¶æ€</h4><blockquote><ul><li>è¿è¡Œæ€ï¼šæ­¤æ—¶è¿›ç¨‹æˆ–è€…æ­£åœ¨è¿è¡Œï¼Œæˆ–è€…å‡†å¤‡è¿è¡Œ</li><li>ç­‰å¾…æ€ï¼šï¼ˆæŒ‚èµ·ï¼‰æ­¤æ—¶è¿›ç¨‹åœ¨ç­‰å¾…ä¸€ä¸ªäº‹ä»¶çš„å‘ç”Ÿæˆ–æŸç§ç³»ç»Ÿèµ„æº<ul><li>å¯ä¸­æ–­</li><li>ä¸å¯ä¸­æ–­</li></ul></li><li>åœæ­¢æ€ï¼šæ­¤æ—¶è¿›ç¨‹è¢«ä¸­æ­¢</li><li>æ­»äº¡æ€ï¼šï¼ˆåƒµå°¸æ€ï¼‰è¿™æ˜¯ä¸€ä¸ªå·²ç»ˆæ­¢çš„è¿›ç¨‹ï¼Œä½†è¿˜åœ¨è¿›ç¨‹è¿˜åœ¨è¿›ç¨‹å‘é‡ç»„ä¸­å æœ‰ä¸€ä¸ªtask_structç»“æ„</li></ul></blockquote><h4 id="è¿›ç¨‹çŠ¶æ€å›¾"><a href="#è¿›ç¨‹çŠ¶æ€å›¾" class="headerlink" title="è¿›ç¨‹çŠ¶æ€å›¾"></a>è¿›ç¨‹çŠ¶æ€å›¾</h4><p><img src="https://typora-1307795383.cos.ap-chengdu.myqcloud.com/image-20230331144441349.png"></p><h4 id="è¿›ç¨‹ç›¸å…³å‘½ä»¤"><a href="#è¿›ç¨‹ç›¸å…³å‘½ä»¤" class="headerlink" title="è¿›ç¨‹ç›¸å…³å‘½ä»¤"></a>è¿›ç¨‹ç›¸å…³å‘½ä»¤</h4><h5 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">ps -ef</span><br><span class="line"></span><br><span class="line">ps -aux æœ‰ä¸ªçŠ¶æ€STATæ ‡è¯†</span><br><span class="line"></span><br><span class="line">top</span><br><span class="line"></span><br><span class="line">nice</span><br><span class="line"></span><br><span class="line">renice</span><br><span class="line"></span><br><span class="line">kill</span><br><span class="line"></span><br><span class="line">bg è¦å…ˆjobsè·å–ä¸€ä¸ªåºå·ï¼Œç„¶åç”¨bg åºå·ï¼ŒæŠŠç¨‹åºç§»å…¥åå°</span><br><span class="line"></span><br><span class="line">fg å’Œbgç”¨æ³•ä¸€æ ·</span><br><span class="line"></span><br><span class="line">### ç³»ç»Ÿè°ƒç”¨</span><br></pre></td></tr></tbody></table></figure><h4 id="fork"><a href="#fork" class="headerlink" title="fork"></a>fork</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">pid_t</span> <span class="title function_">fork</span><span class="params">(<span class="type">void</span>)</span>; </span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹å‡ºæ¥ è¿”å›å€¼ï¼š0è¡¨ç¤ºå­è¿›ç¨‹ï¼Œå¤§äº0è¡¨ç¤ºçˆ¶è¿›ç¨‹ï¼Œ-1å‡ºé”™</span></span><br></pre></td></tr></tbody></table></figure><h4 id="vfork"><a href="#vfork" class="headerlink" title="vfork"></a>vfork</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">pid_t</span> <span class="title function_">vfork</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼š0è¡¨ç¤ºå­è¿›ç¨‹ï¼Œå¤§äº0è¡¨ç¤ºçˆ¶è¿›ç¨‹ï¼Œ-1å‡ºé”™</span></span><br><span class="line"><span class="comment">//ä¸€å®šæ˜¯å­è¿›ç¨‹å…ˆè¿è¡Œï¼Œå¹¶ä¸”å­è¿›ç¨‹ä¸ç»“æŸexit()æˆ–è€…ä¸è°ƒç”¨execå‡½æ•°ç°‡ï¼Œçˆ¶è¿›ç¨‹ä¸ä¼šæ­£ç¡®è¿è¡Œï¼ˆåº”è¯¥æ˜¯åŒä¸€ç‰‡ç©ºé—´ï¼Œå­è¿›ç¨‹ä¸é‡Šæ”¾ï¼Œçˆ¶è¿›ç¨‹å°±ä¸èƒ½è®¿é—®ï¼Œæ•…æ‰€ä»¥ä¼šå‡ºç°æ®µé”™è¯¯ï¼‰</span></span><br></pre></td></tr></tbody></table></figure><h4 id="execå‡½æ•°æ—"><a href="#execå‡½æ•°æ—" class="headerlink" title="execå‡½æ•°æ—"></a>execå‡½æ•°æ—</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">execl</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">const</span> <span class="type">char</span> *arg, ...<span class="comment">/*(char *) NULL */</span>)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">execlp</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *file, <span class="type">const</span> <span class="type">char</span> *arg, ...<span class="comment">/*(char *) NULL */</span>)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">execle</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">const</span> <span class="type">char</span> *arg, ..., <span class="type">char</span> *<span class="type">const</span> envp[]<span class="comment">/*(char *) NULL, char *const envp[] */</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">execv</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">char</span> *<span class="type">const</span> argv[])</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">execvp</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *file, <span class="type">char</span> *<span class="type">const</span> argv[])</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">execvpe</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *file, <span class="type">char</span> *<span class="type">const</span> argv[], <span class="type">char</span> *<span class="type">const</span> envp[])</span></span><br></pre></td></tr></tbody></table></figure><ul><li>ç®€å•æ¥è¯´ï¼Œ<code>exec</code>å‡½æ•°æ—éƒ½æ˜¯ä»¥<code>exec</code>å¼€å¤´ï¼Œåé¢è·Ÿçš„ä¸åŒå­—æ¯è¡¨ç¤ºä¸åŒçš„æ¶µä¹‰ï¼š<ul><li><code>l</code> è¡¨ç¤º <code>list</code>ï¼ŒæŒ‡ä»£çš„æ˜¯å‘½ä»¤è¡Œå‚æ•°åˆ—è¡¨ã€‚</li><li><code>p</code> è¡¨ç¤º <code>path</code>ï¼ŒæŒ‡å®šæœç´¢æ–‡ä»¶<code>file</code>æ—¶æ‰€ä½¿ç”¨çš„<code>path</code>å˜é‡ã€‚</li><li><code>v</code> è¡¨ç¤º<code>vector</code>ï¼ŒæŒ‡ä»£çš„æ˜¯å‘½ä»¤è¡Œå‚æ•°æ•°ç»„ã€‚</li><li><code>e</code> è¡¨ç¤º <code>environment</code>ï¼ŒæŒ‡ä»£çš„æ˜¯ç¯å¢ƒå˜é‡æ•°ç»„ã€‚</li></ul></li><li>å‡½æ•°å‚æ•°<ul><li><code>path</code> è¡¨ç¤ºè¦æ‰§è¡Œçš„ç¨‹åºè·¯å¾„ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„æˆ–æ˜¯ç›¸å¯¹è·¯å¾„ã€‚</li><li><code>file</code> è¡¨ç¤ºè¦æ‰§è¡Œçš„ç¨‹åºåç§°ï¼Œå¦‚æœè¯¥å‚æ•°ä¸­åŒ…å«<code>/</code>å­—ç¬¦åˆ™è§†ä¸ºè·¯å¾„åå¹¶ç›´æ¥æ‰§è¡Œï¼Œå¦åˆ™åˆ™è§†ä¸ºå•ç‹¬çš„æ–‡ä»¶åï¼Œç³»ç»Ÿå°†ä¼šæ ¹æ®ç¯å¢ƒå˜é‡<code>PATH</code>ä¸­è®¾ç½®çš„è·¯å¾„é¡ºåºå»æœç´¢æŒ‡å®šçš„æ–‡ä»¶ã€‚</li><li><code>argv</code> è¡¨ç¤ºå‘½ä»¤è¡Œå‚æ•°çš„çŸ¢é‡æ•°ç»„</li><li><code>envp</code> è¡¨ç¤ºå¸¦æœ‰è¯¥å‚æ•°çš„<code>exec</code>å‡½æ•°å¯ä»¥åœ¨è°ƒç”¨æ—¶æŒ‡å®šä¸€ä¸ªç¯å¢ƒå˜é‡æ•°ç»„ï¼Œå…¶ä»–ä¸å¸¦è¯¥å‚æ•°çš„<code>exec</code>å‡½æ•°åˆ™ä½¿ç”¨è°ƒç”¨è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ã€‚</li><li><code>arg</code> è¡¨ç¤ºç¨‹åºçš„ç¬¬0ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºåæœ¬èº«ï¼Œç›¸å½“äº<code>argv[0]</code>ã€‚</li><li><code>...</code> è¡¨ç¤ºå‘½ä»¤è¡Œå‚æ•°åˆ—è¡¨ï¼Œè°ƒç”¨ç›¸åº”ç¨‹åºæ—¶æœ‰å¤šå°‘ä¸ªå‘½ä»¤è¡Œå‚æ•°å°±éœ€è¦æœ‰å¤šå°‘ä¸ªè¾“å…¥å‚æ•°é¡¹ã€‚</li></ul></li><li>è¿”å›å€¼<ul><li>å‡½æ•°æ‰§è¡ŒæˆåŠŸä¸ä¼šè¿”å›ï¼Œè‹¥æ‰§è¡Œå¤±è´¥åˆ™è¿”å›-1ï¼Œå¤±è´¥åŸå› ä¼šè®°å½•åœ¨<code>error</code>ä¸­ã€‚</li></ul></li></ul><p>äº‹å®ä¸Šï¼Œè¿™6ä¸ªå‡½æ•°ä¸­çœŸæ­£çš„ç³»ç»Ÿè°ƒç”¨åªæœ‰<code>execve</code>å‡½æ•°ï¼Œå…¶å®ƒ5ä¸ªéƒ½æ˜¯åº“å‡½æ•°ï¼Œå®ƒä»¬æœ€ç»ˆéƒ½ä¼šè°ƒç”¨<code>execve</code>è¿™ä¸ªç³»ç»Ÿè°ƒç”¨ã€‚</p><h4 id="è¿›ç¨‹é€€å‡º"><a href="#è¿›ç¨‹é€€å‡º" class="headerlink" title="è¿›ç¨‹é€€å‡º"></a>è¿›ç¨‹é€€å‡º</h4><h5 id="exit"><a href="#exit" class="headerlink" title="exit"></a>exit</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">exit</span><span class="params">(<span class="type">int</span> status)</span>;</span><br><span class="line">åŠŸèƒ½ï¼šä¸»åŠ¨ç»“æŸè¿›ç¨‹</span><br><span class="line">statusï¼šè¿›ç¨‹é€€å‡ºæ—¶å‘Šè¯‰åˆ«äººä¸€ä¸ªçŠ¶æ€ï¼ˆå›æ”¶å®ƒçš„äººï¼‰</span><br></pre></td></tr></tbody></table></figure><h5 id="exit-1"><a href="#exit-1" class="headerlink" title="_exit"></a>_exit</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">void</span> _exit(<span class="type">int</span> status);</span><br><span class="line">åŠŸèƒ½ï¼šä¸»åŠ¨ç»“æŸè¿›ç¨‹</span><br><span class="line">statusï¼šè¿›ç¨‹é€€å‡ºæ—¶å‘Šè¯‰åˆ«äººä¸€ä¸ªçŠ¶æ€ï¼ˆå›æ”¶å®ƒçš„äººï¼‰</span><br></pre></td></tr></tbody></table></figure><p>åŒºåˆ«ï¼šexité€€å‡ºæ—¶ä¼šæ¸…ç©ºç¼“å†²ï¼Œ_exitä¸æ¸…ç©ºIOç¼“å†²åŒº</p><h4 id="è¿›ç¨‹å›æ”¶Â·"><a href="#è¿›ç¨‹å›æ”¶Â·" class="headerlink" title="è¿›ç¨‹å›æ”¶Â·"></a>è¿›ç¨‹å›æ”¶Â·</h4><h5 id="wait"><a href="#wait" class="headerlink" title="wait"></a>wait</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">pid_t</span> <span class="title function_">wait</span><span class="params">(<span class="type">int</span> *wstatus)</span>;</span><br><span class="line"><span class="type">pid_t</span> <span class="title function_">wait</span><span class="params">(<span class="type">int</span> *wstatus)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå›æ”¶å·²ç»å¤„äºåƒµå°¸æ€ï¼ˆå·²ç»ç»“æŸï¼‰çš„è¿›ç¨‹</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›å›æ”¶çš„å­è¿›ç¨‹IDå·ï¼Œå¤±è´¥è¿”å›-1</span></span><br><span class="line">wstatusï¼šå­è¿›ç¨‹ç»“æŸæ—¶è¦ä¼ é€’çš„çŠ¶æ€ã€‚å¦‚æœä¸åœ¨æ„å­è¿›ç¨‹é€€å‡ºçš„çŠ¶æ€å°±å†™<span class="literal">NULL</span></span><br><span class="line"></span><br><span class="line">çˆ¶è¿›ç¨‹è°ƒç”¨waitå›æ”¶å­è¿›ç¨‹çš„èµ„æºï¼Œå­è¿›ç¨‹å¦‚æœæ‰§è¡Œå®Œäº†çˆ¶è¿›ç¨‹æ‰ä¼šä»waitç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™waitä¼šé˜»å¡</span><br></pre></td></tr></tbody></table></figure><h5 id="waitpid"><a href="#waitpid" class="headerlink" title="waitpid"></a>waitpid</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">pid_t</span> <span class="title function_">waitpid</span><span class="params">(<span class="type">pid_t</span> pid, <span class="type">int</span> *wstatus, <span class="type">int</span> options)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå›æ”¶å·²ç»ç»“æŸçš„å­è¿›ç¨‹</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šå¦‚æœæˆåŠŸå›æ”¶è¿”å›å­è¿›ç¨‹çš„IDï¼Œå¦‚æœæ˜¯éé˜»å¡æƒ…å†µä¸‹æ²¡æœ‰å­è¿›ç¨‹ç»“æŸï¼Œè¿”å›0.å¤±è´¥è¿”å›-1</span></span><br><span class="line">pidï¼šæŒ‡å®šè¦å›æ”¶çš„è¿›ç¨‹å·</span><br><span class="line">&gt; <span class="number">0</span> è¡¨ç¤ºä¸€ä¸ªå…·ä½“çš„è¿›ç¨‹ID</span><br><span class="line"><span class="number">-1</span> è¡¨ç¤ºå¯ä»¥å›æ”¶ä»»æ„å­è¿›ç¨‹</span><br><span class="line">wstatusï¼šå­è¿›ç¨‹é€€å‡ºæ—¶çš„çŠ¶æ€</span><br><span class="line">optionsï¼šwaitpidçš„å·¥ä½œæ¨¡å¼ï¼Œå¯ä»¥æ˜¯é˜»å¡ä¹Ÿå¯ä»¥éé˜»å¡</span><br><span class="line"><span class="number">0</span>è¡¨ç¤ºé˜»å¡ï¼ŒWNOHANGè¡¨ç¤ºéé˜»å¡</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="type">pid_t</span> <span class="title function_">wait</span><span class="params">(<span class="type">int</span> *wstatus)</span>;</span><br><span class="line"><span class="type">pid_t</span> <span class="title function_">waitpid</span><span class="params">(<span class="type">pid_t</span> pid, <span class="type">int</span> *wstatus, <span class="type">int</span> options)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">waitid</span><span class="params">(<span class="type">idtype_t</span> idtype, <span class="type">id_t</span> id, <span class="type">siginfo_t</span> *infop, <span class="type">int</span> options)</span>;</span><br><span class="line">ğŸ“<span class="comment">//pidçš„å€¼</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">The value of pid can be:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ğŸ’¬&lt;-1   meaning wait for any child process whose process group ID is equal to theabsolute value of pid.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">â©-1    meaning wait for any child process.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">â© 0    meaning  wait  for  any  child process whose process group ID is equal to that of the calling process at the ti me of the call to waitpid().</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">â©&gt;0    meaning wait for the child whose process ID is equal to the value of pid.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">ğŸ“<span class="comment">//å‚æ•°options</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">The value of options is an OR of zero or more of the following constants:</span></span><br><span class="line"><span class="comment">â©WNOHANG</span></span><br><span class="line"><span class="comment">       return immediately if no child has exited.</span></span><br><span class="line"><span class="comment">â©WUNTRACED</span></span><br><span class="line"><span class="comment">       also return if a child has stopped (but not traced via ptrace(2)).   Status  for  traced children which have stopped is provided even if this option is not specified.</span></span><br><span class="line"><span class="comment">â©WCONTINUED (since Linux 2.6.10)</span></span><br><span class="line"><span class="comment">       also return if a stopped child has been resumed by delivery of SIGCONT.</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></tbody></table></figure><h4 id="å®ˆæŠ¤è¿›ç¨‹"><a href="#å®ˆæŠ¤è¿›ç¨‹" class="headerlink" title="å®ˆæŠ¤è¿›ç¨‹"></a>å®ˆæŠ¤è¿›ç¨‹</h4><p>åˆ›å»ºæ­¥éª¤</p><blockquote><ul><li><p>åˆ›å»ºå­è¿›ç¨‹ï¼Œé€€å‡ºçˆ¶</p><ul><li>forkï¼ˆï¼‰</li></ul></li><li><p>å­è¿›ç¨‹</p><ul><li>setsid()</li></ul></li><li><p>æ”¹å˜</p><ul><li>chdir(â€œ/tempâ€);</li><li>umask(0);</li></ul></li><li><p>å…³é—­æ‰€æœ‰</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt; getdtablesize();i++){</span><br><span class="line">    close(i);</span><br><span class="line">}</span><br><span class="line"><span class="comment">//getdtablesize()æ˜¯è·å–æœ€å¤§çš„æ–‡ä»¶æ ‡è¯†ç¬¦</span></span><br></pre></td></tr></tbody></table></figure></li></ul></blockquote><h5 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line">        <span class="type">pid_t</span> pt=fork();</span><br><span class="line">        <span class="keyword">if</span>(pt&lt;<span class="number">0</span>){</span><br><span class="line">                perror(<span class="string">"fork()"</span>);</span><br><span class="line">        }<span class="keyword">else</span> <span class="keyword">if</span>(pt&gt;<span class="number">0</span>){</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">        setsid();</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span>!=chdir(<span class="string">"/tmp"</span>)){</span><br><span class="line">                perror(<span class="string">"chdir"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;getdtablesize();i++){</span><br><span class="line">                close(i);</span><br><span class="line">        }</span><br><span class="line">        umask(<span class="number">0</span>);</span><br><span class="line">        <span class="type">time_t</span> tt;</span><br><span class="line">        FILE *f=fopen(<span class="string">"log_time.txt"</span>,<span class="string">"a+"</span>);</span><br><span class="line">                <span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line">                        time(&amp;tt);</span><br><span class="line">                        <span class="built_in">fprintf</span>(f,ctime(&amp;tt));</span><br><span class="line">                    sleep(<span class="number">1</span>);</span><br><span class="line">                }</span><br><span class="line">        }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h2><blockquote><p>æ¦‚å¿µï¼šè½»é‡çº§çš„è¿›ç¨‹ï¼Œä»»åŠ¡è°ƒåº¦çš„æœ€å°å•ä½ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ä»»åŠ¡çš„åˆ‡æ¢ï¼Œçº¿ç¨‹ä»¬å…±äº«åŒä¸€ä¸ªè¿›ç¨‹çš„ç©ºé—´ã€‚é‚£ä¹ˆåˆ‡æ¢åŒä¸€ä¸ªè¿›ç¨‹ä¸‹çš„ä»»åŠ¡æ—¶å°±ä¸éœ€è¦å†åˆ‡æ¢å†…å­˜äº†</p></blockquote><h3 id="çº¿ç¨‹çš„åˆ›å»º"><a href="#çº¿ç¨‹çš„åˆ›å»º" class="headerlink" title="çº¿ç¨‹çš„åˆ›å»º"></a>çº¿ç¨‹çš„åˆ›å»º</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_create</span><span class="params">(<span class="type">pthread_t</span> *thread, <span class="type">const</span> <span class="type">pthread_attr_t</span> *attr,</span></span><br><span class="line"><span class="params">                   <span class="type">void</span> *(*start_routine) (<span class="type">void</span> *), <span class="type">void</span> *arg)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šåœ¨ç³»ç»Ÿä¸­åˆ›å»ºå‡ºæ¥ä¸€ä¸ªçº¿ç¨‹ï¼ˆä»»åŠ¡ï¼‰</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›é0</span></span><br><span class="line">threadï¼šçº¿ç¨‹å¯¹è±¡</span><br><span class="line">attrï¼šçº¿ç¨‹å±æ€§ï¼Œä¸€èˆ¬ä½¿ç”¨ç³»ç»Ÿæä¾›çš„é»˜è®¤å±æ€§ï¼Œå†™<span class="literal">NULL</span></span><br><span class="line">start_routineï¼šçº¿ç¨‹è¦å»æ‰§è¡Œçš„å‡½æ•°å</span><br><span class="line">argï¼šè¦ä¼ é€’ç»™start_routineæ‰€æŒ‡å‘å‡½æ•°çš„å‚æ•°</span><br></pre></td></tr></tbody></table></figure><h3 id="çº¿ç¨‹é€€å‡º"><a href="#çº¿ç¨‹é€€å‡º" class="headerlink" title="çº¿ç¨‹é€€å‡º"></a>çº¿ç¨‹é€€å‡º</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">pthread_exit</span><span class="params">(<span class="type">void</span> *retval)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šä¸»åŠ¨é€€å‡ºä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="comment">//retvalï¼šé€€å‡ºæ—¶è¦ä¼ é€’çš„ä¿¡æ¯</span></span><br></pre></td></tr></tbody></table></figure><h3 id="çº¿ç¨‹å›æ”¶"><a href="#çº¿ç¨‹å›æ”¶" class="headerlink" title="çº¿ç¨‹å›æ”¶"></a>çº¿ç¨‹å›æ”¶</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">pthread_join</span><span class="params">(<span class="type">pthread_t</span> thread, <span class="type">void</span> **retval)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šé˜»å¡ç­‰å¾…å­çº¿ç¨‹çš„é€€å‡º</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›é”™è¯¯å·</span></span><br><span class="line">threadï¼šè¦å›æ”¶çš„å­çº¿ç¨‹</span><br><span class="line">retvalï¼šç”¨äºå­˜æ”¾å­çº¿ç¨‹é€€å‡ºæ—¶æŒ‡å‘çš„åœ°å€ç©ºé—´</span><br></pre></td></tr></tbody></table></figure><h3 id="çº¿ç¨‹åˆ†ç¦»"><a href="#çº¿ç¨‹åˆ†ç¦»" class="headerlink" title="çº¿ç¨‹åˆ†ç¦»"></a>çº¿ç¨‹åˆ†ç¦»</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">pthread_detach</span><span class="params">(<span class="type">pthread_t</span> thread)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šä½¿å½“å‰çº¿ç¨‹å’Œthreadè¡¨ç¤ºçš„çº¿ç¨‹æ–­å¼€è”ç³»</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›é”™è¯¯å·</span></span><br><span class="line">threadï¼šè¦åˆ†ç¦»çš„çº¿ç¨‹</span><br></pre></td></tr></tbody></table></figure><h3 id="çº¿ç¨‹é—´é€šè®¯æ–¹å¼"><a href="#çº¿ç¨‹é—´é€šè®¯æ–¹å¼" class="headerlink" title="çº¿ç¨‹é—´é€šè®¯æ–¹å¼"></a>çº¿ç¨‹é—´é€šè®¯æ–¹å¼</h3><h4 id="åŒæ­¥å’Œäº’æ–¥"><a href="#åŒæ­¥å’Œäº’æ–¥" class="headerlink" title="åŒæ­¥å’Œäº’æ–¥"></a>åŒæ­¥å’Œäº’æ–¥</h4><h5 id="äº’æ–¥é”"><a href="#äº’æ–¥é”" class="headerlink" title="äº’æ–¥é”"></a>äº’æ–¥é”</h5><p>ç›¸äº’æ’æ–¥ï¼Œåªèƒ½å­˜åœ¨ä¸€ä¸ªã€‚è¡¨ç¤ºç³»ç»Ÿä¸­çš„ä¸€ç§èµ„æºï¼Œä¸»è¦ç”¨äºä¿æŠ¤ä»£ç ï¼Œè¿™ç§èµ„æºäº‰æŠ¢åˆ°ä¸ªæ•°å°±ä¼šå‡ä¸€ï¼Œé‡Šæ”¾å‡ºæ¥å°±ä¼šåŠ ä¸€</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_init</span><span class="params">(<span class="type">pthread_mutex_t</span>  *mutex,  <span class="type">const</span>  pthread_mutexâ€</span></span><br><span class="line"><span class="params">       <span class="type">attr_t</span> *mutexattr)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”³è¯·é”</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_lock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//é‡Šæ”¾é”</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_unlock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;</span><br></pre></td></tr></tbody></table></figure><ul><li><p>ç»ƒä¹ </p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> a=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> b=<span class="number">0</span>;</span><br><span class="line"><span class="type">pthread_mutex_t</span> pmt;</span><br><span class="line"><span class="type">void</span> *<span class="title function_">compare</span><span class="params">()</span>{</span><br><span class="line"><span class="comment">//void *compare(){</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _LOCK_</span></span><br><span class="line">pthread_mutex_lock(&amp;pmt);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="keyword">if</span>(a!=b){</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"a=%d , b=%d\n"</span>,a,b);</span><br><span class="line">}</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _LOCK_</span></span><br><span class="line">pthread_mutex_unlock(&amp;pmt);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line">pthread_mutex_init(&amp;pmt,<span class="literal">NULL</span>);</span><br><span class="line"><span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line"><span class="type">pthread_t</span> pt;</span><br><span class="line"><span class="type">int</span> flag=pthread_create(&amp;pt,<span class="literal">NULL</span>,compare,<span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">if</span>(flag!=<span class="number">0</span>)</span><br><span class="line">perror(<span class="string">"pthread_create"</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _LOCK_ </span></span><br><span class="line">pthread_mutex_lock(&amp;pmt);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">count++;</span><br><span class="line">a=count;</span><br><span class="line">b=count;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _LOCK_</span></span><br><span class="line">pthread_mutex_unlock(&amp;pmt);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">}</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li></ul><h5 id="åŒæ­¥é”"><a href="#åŒæ­¥é”" class="headerlink" title="åŒæ­¥é”"></a>åŒæ­¥é”</h5><h6 id="ä¿¡å·é‡"><a href="#ä¿¡å·é‡" class="headerlink" title="ä¿¡å·é‡"></a>ä¿¡å·é‡</h6><p>ç”¨äºè¡¨ç¤ºç³»ç»Ÿä¸­çš„æŸç§èµ„æºï¼Œè¿™ç§èµ„æºçš„ä¸ªæ•°å¯ä»¥ä¸å®šã€‚éœ€è¦ç¨‹åºç”³è¯·æˆ–è€…é‡Šæ”¾èµ„æº</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_init</span><span class="params">(<span class="type">sem_t</span> *sem, <span class="type">int</span> pshared, <span class="type">unsigned</span> <span class="type">int</span> value)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šåœ¨ç³»ç»Ÿä¸­åˆ›å»ºå‡ºæ¥ä¸€ç§èµ„æºå¹¶åˆå§‹åŒ–ä¸ªæ•°</span></span><br><span class="line">semï¼šä¿¡å·é‡å¯¹è±¡</span><br><span class="line">psharedï¼š<span class="number">0</span> è¡¨ç¤ºä¿¡å·é‡ä½œç”¨äºçº¿ç¨‹ä¹‹é—´ï¼Œé<span class="number">0</span>è¡¨ç¤ºç”¨äºè¿›ç¨‹ä¹‹é—´</span><br><span class="line">valueï¼šä¿¡å·é‡åˆå§‹|ä¸ªæ•°</span><br></pre></td></tr></tbody></table></figure><h6 id="ç”Ÿäº§è€…-Væ“ä½œ-ï¼š"><a href="#ç”Ÿäº§è€…-Væ“ä½œ-ï¼š" class="headerlink" title="ç”Ÿäº§è€…(Væ“ä½œ)ï¼š"></a>ç”Ÿäº§è€…(Væ“ä½œ)ï¼š</h6><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_post</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå‘ç³»ç»Ÿæäº¤ä¸€ä¸ªèµ„æºï¼Œä½¿ç³»ç»Ÿä¸­è¿™ç§èµ„æºçš„ä¸ªæ•°+1</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1</span></span><br><span class="line">sem:è¦æ“ä½œçš„å¯¹è±¡</span><br></pre></td></tr></tbody></table></figure><h6 id="æ¶ˆè´¹è€…-Pæ“ä½œ"><a href="#æ¶ˆè´¹è€…-Pæ“ä½œ" class="headerlink" title="æ¶ˆè´¹è€…(Pæ“ä½œ):"></a>æ¶ˆè´¹è€…(Pæ“ä½œ):</h6><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_wait</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå‘ç³»ç»Ÿç”³è¯·æŸä¸ªèµ„æºçš„ä½¿ç”¨æƒï¼Œä½¿ç³»ç»Ÿä¸­è¿™ç§èµ„æºçš„ä¸ªæ•°-1ï¼Œå¦‚æœç³»ç»Ÿä¸­è¿™ä¸ªèµ„æºçš„ä¸ªæ•°ä¸º0ï¼Œç¨‹åºä¼šé˜»å¡ç­‰å¾…èµ„æºï¼Œç›´åˆ°å¯ä»¥ç”³è¯·åˆ°è¯¥èµ„æº</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1</span></span><br><span class="line">sem:è¦æ“ä½œçš„ä¿¡å·é‡å¯¹è±¡</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="type">char</span> a[<span class="number">20</span>]={<span class="number">-1</span>};</span><br><span class="line"><span class="type">sem_t</span> st_w;</span><br><span class="line"><span class="type">sem_t</span> st_r;</span><br><span class="line"><span class="type">void</span> * <span class="title function_">count_length</span><span class="params">()</span>{</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line">sem_wait(&amp;st_w);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"length = %ld\n"</span>,<span class="built_in">strlen</span>(a)<span class="number">-1</span>);</span><br><span class="line">sem_post(&amp;st_r);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line"><span class="type">pthread_t</span> pt;</span><br><span class="line">sem_init(&amp;st_w,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">sem_init(&amp;st_r,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">pthread_create(&amp;pt,<span class="literal">NULL</span>,count_length,<span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line">sem_wait(&amp;st_r);</span><br><span class="line">fgets(a,<span class="keyword">sizeof</span>(a)<span class="number">-1</span>,<span class="built_in">stdin</span>);</span><br><span class="line">sem_post(&amp;st_w);</span><br><span class="line">}</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="æ— åç®¡é“"><a href="#æ— åç®¡é“" class="headerlink" title="æ— åç®¡é“"></a>æ— åç®¡é“</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">fd_pair</span> {</span></span><br><span class="line">    <span class="type">long</span> fd[<span class="number">2</span>];</span><br><span class="line">};</span><br><span class="line"><span class="type">int</span> <span class="title function_">pipe</span><span class="params">(<span class="type">int</span> fd[<span class="number">2</span>])</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šåœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„ç®¡é“æ–‡ä»¶(æ–‡ä»¶æ²¡æœ‰å®ä½“)ï¼Œåªèƒ½å¤Ÿç”¨äºäº²ç¼˜é—´çš„è¿›ç¨‹</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1</span></span><br><span class="line">fd:ç”¨äºå­˜æ”¾ç®¡é“è¯»ç«¯å’Œå†™ç«¯çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">    fd[<span class="number">1</span>]ä¸ºå†™å…¥ç«¯ï¼ˆå†™ç«¯ï¼‰</span><br><span class="line">    fd[<span class="number">0</span>]ä¸ºè¯»å–ç«¯ï¼ˆè¯»ç«¯ï¼‰</span><br><span class="line"><span class="comment">//ä¸€å®šè¦åœ¨fork()ä¹‹å‰ç”¨pipe</span></span><br></pre></td></tr></tbody></table></figure><p><img src="https://store.codedrawing.top/Z%60H%5B79HR@HRU@GT1E%5D%7DK%7BNV.png" alt="img"></p><blockquote><p>çˆ¶è¿›ç¨‹ä¸­çš„readï¼Œä¼šå¡ä½ï¼ˆå¦‚æœä¸åŠ sleep(5)ï¼‰ï¼Œå› ä¸ºå­è¿›ç¨‹ä¸­writeå†™å…¥åï¼Œé©¬ä¸Šå°±read(fd[0])ï¼Œä¼šæŠŠå†…å®¹ä»fd[0]ä¸­è¯»å‡ºï¼Œæ‰€ä»¥fd[0]ä¸­æ²¡æœ‰ä¸œè¥¿å¯è¯»å°±ä¼šå¡ä¸»ã€‚</p></blockquote><h5 id="è¯»ç«¯"><a href="#è¯»ç«¯" class="headerlink" title="è¯»ç«¯"></a>è¯»ç«¯</h5><blockquote><p>å†™æ®µå­˜åœ¨ï¼š</p><p>â€‹å¦‚æœç®¡é“ä¸­æœ‰æ•°æ®ï¼Œé‚£ä¹ˆreadå¯ä»¥æ­£å¸¸è¯»å–ï¼Œå¹¶ä¸”è¿”å›è¯»å–åˆ°çš„å­—èŠ‚æ•°;å¦‚æœç®¡é“ä¸­æ²¡æœ‰æ•°æ®ï¼Œreadä¼šé˜»å¡ç­‰å¾…ç®¡é“ä¸­çš„æ•°æ®ï¼ˆä¾‹å­è§ä¸Šé¢ï¼‰</p><p>å†™ç«¯ä¸å­˜åœ¨ï¼š</p><p>â€‹å¦‚æœç®¡é“ä¸­æœ‰æ•°æ®ï¼Œreadè¿˜æ˜¯æ­£å¸¸è¯»å–ï¼›ç®¡é“ä¸­æ²¡æœ‰æ•°æ®readç›´æ¥è¿”å›0ï¼Œè¡¨ç¤ºå·²ç»å…³é—­</p></blockquote><h5 id="å†™ç«¯"><a href="#å†™ç«¯" class="headerlink" title="å†™ç«¯"></a>å†™ç«¯</h5><blockquote><p>è¯»ç«¯å­˜åœ¨ï¼š</p><p>â€‹å¦‚æœå‰©ä½™ç©ºé—´å¤§äºè¦å†™å…¥çš„å­—èŠ‚æ•°ï¼Œwriteæ­£å¸¸å†™å…¥ï¼›å¦‚æœç®¡é“å‰©ä½™ç©ºé—´æ¯”å†™å…¥çš„å­—èŠ‚æ•°å°ï¼Œé‚£ä¹ˆwriteå°±ä¼šå†™ä¸€éƒ¨åˆ†è¿›å»ç„¶åé˜»å¡ã€‚</p><p>è¯»ç«¯ä¸å­˜åœ¨ï¼š</p><p>â€‹å¾€ç®¡é“é‡Œé¢å†™å…¥æ•°æ®ä¼šä½¿ç®¡é“ç ´è£‚</p></blockquote><p><code>æ³¨æ„ï¼šç®¡é“ä¸­çš„æ•°æ®æ˜¯ä¸´æ—¶çš„ï¼Œå¯ä»¥è¢«è¯»èµ°ï¼Œå½“è¯»å–äº†ç®¡é“çš„å†…å®¹æ˜¯ï¼Œç®¡é“ä¸­è¢«è¯»çš„å†…å®¹ä¼šæ¶ˆå¤±</code></p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line"><span class="type">int</span> fd[<span class="number">2</span>];</span><br><span class="line">pipe(fd);</span><br><span class="line">close(fd[<span class="number">0</span>]);</span><br><span class="line"><span class="type">pid_t</span> pid=fork();</span><br><span class="line"><span class="keyword">if</span>(pid&lt;<span class="number">0</span>){</span><br><span class="line">perror(<span class="string">"fork"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}<span class="keyword">else</span> <span class="keyword">if</span>(pid==<span class="number">0</span>){</span><br><span class="line"><span class="type">char</span> ch =<span class="number">10</span>;</span><br><span class="line">write(fd[<span class="number">1</span>],&amp;ch,<span class="number">1</span>);</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="type">int</span> status;</span><br><span class="line">wait(&amp;status);</span><br><span class="line"><span class="keyword">if</span>(WIFEXITED(status)==<span class="literal">true</span>){</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"normal\n"</span>);</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"abnormal\n"</span>);</span><br><span class="line"><span class="keyword">if</span>(WIFSIGNALED(status)==<span class="literal">true</span>){</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"sinal killed\n"</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"signal no.%d\n"</span>,status &amp; <span class="number">0x7f</span>);</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"none signal\n"</span>);</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="https://store.codedrawing.top/image-20230403135548200.png" alt="image-20230403135548200"></p><h4 id="æœ‰åç®¡é“"><a href="#æœ‰åç®¡é“" class="headerlink" title="æœ‰åç®¡é“"></a>æœ‰åç®¡é“</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mkfifo</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">mode_t</span> mode)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªç®¡é“æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1</span></span><br><span class="line">pathnameï¼šæ–‡ä»¶åï¼ˆåŒ…å«è·¯å¾„ï¼‰</span><br><span class="line">modeï¼šåˆ›å»ºæ–‡ä»¶æ—¶çš„æƒé™ <span class="number">0777</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªç®¡é“æ–‡ä»¶ï¼Œç„¶åå†å¦å¤–ä¸€ä¸ªç»ˆç«¯å¯¹è¯¥ç®¡é“è¿›è¡Œå†™å…¥å†…å®¹ï¼Œç„¶åè¯¥ç¨‹åºæŠŠå†…å®¹è¯»å‡ºæ¥</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line"><span class="type">char</span> buf[<span class="number">50</span>];</span><br><span class="line"><span class="type">int</span> mkfifo_o=mkfifo(<span class="string">"/tmp/test_mkfifo.txt"</span>,<span class="number">0775</span>);</span><br><span class="line"><span class="keyword">if</span>(mkfifo_o == <span class="number">-1</span>){</span><br><span class="line"><span class="keyword">if</span>(errno != EEXIST){<span class="comment">//errnoè¡¨ç¤ºé”™è¯¯å·  EEXIST è¡¨ç¤ºæ˜¯å¦å­˜åœ¨ </span></span><br><span class="line">perror(<span class="string">"mkfifo"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"create success\n"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line"><span class="built_in">memset</span>(buf,<span class="number">0</span>,<span class="keyword">sizeof</span>(buf));</span><br><span class="line"><span class="type">int</span> fifo=open(<span class="string">"/tmp/test_mkfifo.txt"</span>,O_RDWR); read(fifo,buf,<span class="keyword">sizeof</span>(buf));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s\n"</span>,buf);</span><br><span class="line">}</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="ä¿¡å·"><a href="#ä¿¡å·" class="headerlink" title="ä¿¡å·"></a>ä¿¡å·</h4><h5 id="è½¯ä»¶æ¨¡æ‹Ÿçš„ç»ˆç«¯"><a href="#è½¯ä»¶æ¨¡æ‹Ÿçš„ç»ˆç«¯" class="headerlink" title="è½¯ä»¶æ¨¡æ‹Ÿçš„ç»ˆç«¯"></a>è½¯ä»¶æ¨¡æ‹Ÿçš„ç»ˆç«¯</h5><h6 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h6><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">kill</span><span class="params">(<span class="type">pid_t</span> pid, <span class="type">int</span> sig)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå‘ä¸€ä¸ªè¿›ç¨‹å‘ä¸€ä¸ªä¿¡å·</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸ0ï¼Œå¤±è´¥-1</span></span><br><span class="line">pidï¼šè¦æ¥æ”¶ä¿¡å·çš„è¿›ç¨‹</span><br><span class="line">&gt;<span class="number">0</span>ï¼šä¸€ä¸ªå…·ä½“çš„è¿›ç¨‹å·</span><br><span class="line"><span class="number">-1</span>ï¼šé™¤äº†ç³»ç»Ÿè¿›ç¨‹å¤–çš„æ‰€æœ‰è¿›ç¨‹</span><br><span class="line">sigï¼šè¦å‘é€çš„ä¿¡å·</span><br><span class="line"><span class="comment">//å‘è‡ªå·±å‘é€ä¿¡å·ï¼škill(getpid(), 2);</span></span><br></pre></td></tr></tbody></table></figure><h6 id="raise"><a href="#raise" class="headerlink" title="raise"></a>raise</h6><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">raise</span><span class="params">(<span class="type">int</span> sig)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šç»™è¿›ç¨‹æ·»åŠ ä¸€ä¸ªå®šæ—¶å™¨å¼€å§‹è®¡æ—¶</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šç¬¬ä¸€æ¬¡å®šæ—¶è¿”å›0ï¼Œä¹‹åçš„å®šæ—¶éƒ½ä¼šè¿”å›ä¸Šä¸€æ¬¡å®šæ—¶å™¨è¿˜å‰©å¤šå°‘ç§’</span></span><br><span class="line">secondsï¼šå®šæ—¶å¤šå°‘ç§’</span><br><span class="line"><span class="number">0</span>å–æ¶ˆå®šæ—¶å™¨åŠŸèƒ½</span><br></pre></td></tr></tbody></table></figure><h6 id="alarm"><a href="#alarm" class="headerlink" title="alarm"></a>alarm</h6><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">alarm</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> seconds)</span>;</span><br></pre></td></tr></tbody></table></figure><h6 id="pause"><a href="#pause" class="headerlink" title="pause"></a>pause</h6><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pause</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šæš‚åœè¿›ç¨‹ï¼Œé™¤éæœ‰æ–°çš„ä¿¡å·ï¼ˆäº‹ä»¶ï¼‰äº§ç”Ÿç¨‹åºæ‰ä¼šè¢«å”¤é†’</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1</span></span><br></pre></td></tr></tbody></table></figure><h6 id="â­ï¸-signal"><a href="#â­ï¸-signal" class="headerlink" title="â­ï¸ signal"></a>â­ï¸ signal</h6><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">void</span> <span class="params">(*<span class="type">sighandler_t</span>)</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">sighandler_t</span> <span class="title function_">signal</span><span class="params">(<span class="type">int</span> signum, <span class="type">sighandler_t</span> handler)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šæ³¨å†ŒæŸä¸ªä¿¡å·çš„å¤„ç†æ–¹å¼</span></span><br><span class="line">signumï¼šè¦æ³¨å†Œçš„ä¿¡å·</span><br><span class="line">handlerï¼šè¦å¤„ç†çš„æ–¹å¼</span><br><span class="line">è‡ªå®šä¹‰ï¼šå¤„ç†</span><br><span class="line">SIG_IGNï¼šå¿½ç•¥è¿™ä¸ªä¿¡å·</span><br><span class="line">SIG_DFLï¼šä½¿ç”¨è¿™ä¸ªä¿¡å·é»˜è®¤çš„å¤„ç†æ–¹å¼</span><br></pre></td></tr></tbody></table></figure><blockquote><p>åœ¨Linuxä¸­ï¼Œä½¿ç”¨kill -læŸ¥çœ‹æ‰€æœ‰ä¿¡å·å®</p><p><img src="https://store.codedrawing.top/image-20230403171741531.png" alt="image-20230403171741531"></p><p>å¸¸è§çš„ä¿¡å·å«ä¹‰</p><ul><li>SIGHUP       ç»ˆç«¯å…³é—­ä¼šå‘é€æ—¶(æŒ‚èµ·)              </li><li>SIGINT         ç»ˆæ­¢å½“å‰è¿›ç¨‹æ—¶(ctrl + c)       </li><li>SIGQUIT      åœæ­¢å½“å‰è¿›ç¨‹æ—¶(ctrl + <code>\</code>)     </li><li>SIGKILL       æ€æ­»è¿›ç¨‹æ—¶(å¹¶ä¸”ä¸èƒ½è¢«é˜»å¡ã€å¤„ç†å’Œå¿½ç•¥)                      </li><li>SIGILL          æ–‡ä»¶æœ¬èº«å‡ºé”™,æˆ–è€…æ•°æ®æ®µã€å †æ ˆæº¢å‡ºæ—¶</li><li>SIGFPE         ç®—æœ¯è¿ç®—é”™è¯¯æ—¶(æº¢å‡ºã€é™¤æ•°ä¸º0)æ—¶</li><li>SIGUSR2      ç”¨æˆ·è‡ªå®šä¿¡å·        </li><li>SIGALRM      é—¹é’Ÿä¿¡å·     ç”±int alarm(int)å‘å‡º</li><li>SIGSTOP       ctrl+z  æŒ‚èµ·è¿›ç¨‹        è½¬æ¢æˆåå°è¿›ç¨‹  </li><li>SIGCHLD      å­è¿›ç¨‹æ”¹å˜çŠ¶æ€æ—¶ï¼Œçˆ¶è¿›ç¨‹ä¼šæ”¶åˆ°è¿™ä¸ªä¿¡å·</li><li>SIGABORT    ç”¨äºç»“æŸè¿›ç¨‹</li></ul></blockquote><p>ä¾‹å­</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">signalhander</span><span class="params">(<span class="type">int</span> signum)</span>{</span><br><span class="line">    <span class="keyword">if</span> (signum==SIGCHLD){</span><br><span class="line">        <span class="type">int</span> status;</span><br><span class="line">        waitpid(<span class="number">-1</span>,&amp;status,WNOHANG);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"type:%d\n"</span>,status &amp; <span class="number">0x7f</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> fd=fork();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fd==<span class="number">-1</span>){</span><br><span class="line">        perror(<span class="string">"fork"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span>(fd==<span class="number">0</span>){</span><br><span class="line">        sleep(<span class="number">5</span>);</span><br><span class="line">        raise(SIGKILL);</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        signal(SIGCHLD,signalhander);</span><br><span class="line">        <span class="type">int</span> i=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i++);</span><br><span class="line">            sleep(<span class="number">1</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h2 id="è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCå¯¹è±¡ï¼‰"><a href="#è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCå¯¹è±¡ï¼‰" class="headerlink" title="è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCå¯¹è±¡ï¼‰"></a>è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCå¯¹è±¡ï¼‰</h2><p>å…±äº«å†…å­˜ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¿¡å·ç¯é›†</p><p>éƒ½éœ€è¦å†…æ ¸æ¥å¸®åŠ©é€šä¿¡</p><h3 id="å…±äº«å†…å­˜"><a href="#å…±äº«å†…å­˜" class="headerlink" title="å…±äº«å†…å­˜"></a>å…±äº«å†…å­˜</h3><p><code>å…±äº«å†…å­˜</code>æ˜¯ä¸€ç§æœ€ä¸ºé«˜æ•ˆçš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œ<code>è¿›ç¨‹</code>å¯ä»¥ç›´æ¥è¯»å†™å†…å­˜ï¼Œè€Œä¸éœ€è¦ä»»ä½•æ•°æ®çš„æ‹·è´ä¸ºäº†åœ¨å¤šä¸ªè¿›ç¨‹é—´äº¤æ¢ä¿¡æ¯ï¼Œå†…æ ¸ä¸“é—¨ç•™å‡ºäº†ä¸€å—å†…å­˜åŒºï¼Œå¯ä»¥ç”±éœ€è¦è®¿é—®çš„è¿›ç¨‹å°†å…¶<br><code>æ˜ å°„</code>åˆ°è‡ªå·±çš„ç§æœ‰åœ°å€ç©ºé—´ã€‚è¿›ç¨‹å°±å¯ä»¥ç›´æ¥è¯»å†™è¿™ä¸€å†…å­˜åŒºè€Œ<code>ä¸éœ€è¦è¿›è¡Œæ•°æ®çš„æ‹·è´</code>ï¼Œä»è€Œå¤§å¤§æé«˜çš„æ•ˆç‡ã€‚</p><p>ç”±äºå¤šä¸ªè¿›ç¨‹å…±äº«ä¸€æ®µå†…å­˜ï¼Œ å› æ­¤ä¹Ÿéœ€è¦ä¾é æŸç§åŒæ­¥æœºåˆ¶ï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ã€‚</p><p>è¡¨ç¤ºipcå¯¹è±¡çš„keyï¼š</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">key_t</span> <span class="title function_">ftok</span> <span class="params">(<span class="type">const</span> <span class="type">char</span> * pathnameï¼Œ<span class="type">int</span> proj. _id)</span>;</span><br><span class="line">åŠŸèƒ½:ç”¨æ–‡ä»¶çš„inodeèŠ‚ç‚¹å·å’Œç”¨æˆ·æä¾›çš„æ•°æ®ç»„åˆç”Ÿæˆä¸€ä¸ªkey</span><br><span class="line">è¿”å›å€¼:æˆåŠŸè¿”å›keyï¼Œå¤±è´¥è¿”å›<span class="number">-1</span></span><br><span class="line">pathname:æ–‡ä»¶å(åŒ…å«è·¯å¾„)</span><br><span class="line">proj_id:ç”¨æˆ·æä¾›çš„æ•°æ®</span><br></pre></td></tr></tbody></table></figure><h4 id="1ã€æ‰“å¼€ã€åˆ›å»ºå…±äº«å†…å­˜å¯¹è±¡"><a href="#1ã€æ‰“å¼€ã€åˆ›å»ºå…±äº«å†…å­˜å¯¹è±¡" class="headerlink" title="1ã€æ‰“å¼€ã€åˆ›å»ºå…±äº«å†…å­˜å¯¹è±¡"></a>1ã€æ‰“å¼€ã€åˆ›å»ºå…±äº«å†…å­˜å¯¹è±¡</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">shmget</span><span class="params">(<span class="type">key_t</span> key, <span class="type">size_t</span> sizeï¼Œ <span class="type">int</span> shmf1g)</span>;</span><br><span class="line">åŠŸèƒ½:åˆ›å»º/æ‰“å¼€ä¸€ä¸€ä¸ªå…±äº«å†…å­˜å¯¹è±¡</span><br><span class="line">è¿”å›å€¼:æˆåŠŸè¿”å›IDå·ï¼Œå¤±è´¥è¿”å›<span class="number">-1</span> </span><br><span class="line">key:è¡¨ç¤ºè¦æ‰“å¼€æˆ–è€…åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„<span class="string">"å¯†é’¥"</span></span><br><span class="line">    å¯ä»¥å†™<span class="number">0</span>æˆ–è€…IPC_PRIVATEè¡¨ç¤ºå…±äº«å†…å­˜å¯¹è±¡ä¸ºç§æœ‰</span><br><span class="line">size:è¦åˆ›å»ºçš„å…±äº«å†…å­˜å¤§å°</span><br><span class="line">shmf1g:æ‰“å¼€æˆ–è€…åˆ›å»ºæ—¶çš„æƒé™</span><br><span class="line">    IPC_CREAT:ä¸å­˜åœ¨åˆ™åˆ›å»º</span><br><span class="line">    IPC_EXCL:å­˜åœ¨(å¦‚æœåŠ ä¸Šäº†IPC_CREAT) å°±æŠ¥é”™</span><br><span class="line">    åˆ›å»ºéœ€è¦ç»™æƒé™ | <span class="number">0666</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h4 id="2ã€æ˜ å°„ç©ºé—´åœ°å€"><a href="#2ã€æ˜ å°„ç©ºé—´åœ°å€" class="headerlink" title="2ã€æ˜ å°„ç©ºé—´åœ°å€"></a>2ã€æ˜ å°„ç©ºé—´åœ°å€</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;syspes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sysm.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> *<span class="title function_">shmat</span><span class="params">(<span class="type">int</span> shmid, <span class="type">const</span> <span class="type">void</span> *shmaddr, <span class="type">int</span> shmflg)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šæŠŠå†…æ ¸ä¸­çš„å…±äº«å†…å­˜ç©ºé—´æ˜ å°„åˆ°ç”¨æˆ·ç©ºé—´</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›æ˜ å°„åçš„ç©ºé—´åœ°å€ï¼Œå¤±è´¥è¿”å›(void *)-1,è¡¨ç¤º0XFFFF;</span></span><br><span class="line">shmid:å…±äº«å†…å­˜çš„idå·</span><br><span class="line">shamddrï¼šå¯ä»¥æŒ‡å®šè¦æ˜ å°„çš„ç©ºé—´åœ°å€</span><br><span class="line">    <span class="literal">NULL</span>ï¼šè¡¨ç¤ºç³»ç»Ÿå†³å®š</span><br><span class="line">    <span class="number">0</span>X...ï¼šè¡¨ç¤ºè¦æŠŠå†…æ ¸ç©ºé—´æ˜ å°„åˆ°è¿™ä¸ªåœ°å€</span><br><span class="line">fhmflgï¼šå…±äº«å†…å­˜çš„æ“ä½œæƒé™ï¼ˆè¯»å†™ï¼‰</span><br><span class="line">    SHM_RDONLYï¼šè¡¨ç¤ºåªè¯»ï¼ˆä¸ç”¨ï¼‰</span><br><span class="line">    <span class="number">0</span>ï¼šè¡¨ç¤ºå¯è¯»å¯å†™</span><br></pre></td></tr></tbody></table></figure><h4 id="3ã€å–æ¶ˆæ˜ å°„"><a href="#3ã€å–æ¶ˆæ˜ å°„" class="headerlink" title="3ã€å–æ¶ˆæ˜ å°„"></a>3ã€å–æ¶ˆæ˜ å°„</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">&lt;sys/ipc.h&gt;</span><br><span class="line">&lt;sys/types.h&gt;</span><br><span class="line">&lt;sys/shm.h&gt;</span><br><span class="line"><span class="type">int</span> <span class="title function_">shmdt</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *shmaddr)</span>;</span><br><span class="line">shmaddr:æ˜¯æŒ‡å‘å…±äº«å†…å­˜æ®µçš„æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘çš„å†…å­˜åŒºåŸŸå°†è¢«ä»è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åˆ†ç¦»å‡ºæ¥ã€‚</span><br><span class="line">è¿”å›å€¼:ä¸º<span class="number">0</span>è¡¨ç¤ºæˆåŠŸï¼Œ<span class="number">-1</span>è¡¨ç¤ºå¤±è´¥ã€‚åœ¨å‡½æ•°æ‰§è¡Œå¤±è´¥æ—¶ï¼Œå¯ä»¥é€šè¿‡å…¨å±€å˜é‡errnoè·å–å…·ä½“çš„é”™è¯¯ä¿¡æ¯ã€‚</span><br></pre></td></tr></tbody></table></figure><h4 id="4ã€åˆ é™¤å…±äº«å†…å­˜å¯¹è±¡"><a href="#4ã€åˆ é™¤å…±äº«å†…å­˜å¯¹è±¡" class="headerlink" title="4ã€åˆ é™¤å…±äº«å†…å­˜å¯¹è±¡"></a>4ã€åˆ é™¤å…±äº«å†…å­˜å¯¹è±¡</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sysm.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">shmctl</span><span class="params">(<span class="type">int</span> shmid, <span class="type">int</span> cmd, <span class="keyword">struct</span> shmid_ds *buf)</span>;</span><br><span class="line">/mid_dsç»“æ„ä½“</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">shmid_ds</span> {</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ipc_perm</span> <span class="title">shm_perm</span>;</span>    <span class="comment">/* Ownership and permissions */</span></span><br><span class="line">    <span class="type">size_t</span>          shm_segsz;   <span class="comment">/* Size of segment (bytes) */</span></span><br><span class="line">    <span class="type">time_t</span>          shm_atime;   <span class="comment">/* Last attach time */</span></span><br><span class="line">    <span class="type">time_t</span>          shm_dtime;   <span class="comment">/* Last detach time */</span></span><br><span class="line">    <span class="type">time_t</span>          shm_ctime;   <span class="comment">/* Creation time/time of last modification via shmctl() */</span></span><br><span class="line">    <span class="type">pid_t</span>           shm_cpid;    <span class="comment">/* PID of creator */</span></span><br><span class="line">    <span class="type">pid_t</span>           shm_lpid;    <span class="comment">/* PID of last shmat(2)mdt(2) */</span></span><br><span class="line">    <span class="type">shmatt_t</span>        shm_nattch;  <span class="comment">/* No. of current attaches */</span></span><br><span class="line">    ...</span><br><span class="line">};</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šæ•´ä½“æ§åˆ¶å…±äº«å†…å­˜å¯¹è±¡</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1</span></span><br><span class="line">shimidï¼šå…±äº«å†…å­˜å¯¹è±¡IDå·</span><br><span class="line">cmd:è¦æ‰§è¡Œçš„æ“ä½œ</span><br><span class="line">    IPC_STAT è·å–å¯¹è±¡å±æ€§</span><br><span class="line">    IPC_SET è®¾ç½®å¯¹è±¡å±æ€§</span><br><span class="line">IPC_RMID  åˆ é™¤å¯¹è±¡</span><br><span class="line">bufï¼šç”¨äºè®¾ç½®æˆ–è€…è·å–å¯¹è±¡çš„å±æ€§ï¼Œå¦‚æœæ˜¯åˆ é™¤å¯¹è±¡ï¼Œå†™<span class="literal">NULL</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p>æ³¨ï¼šåˆ é™¤å¯¹è±¡ä¸æ˜¯ç›´æ¥åˆ é™¤ï¼Œè€Œæ˜¯æ ‡è®°ä¸ºåˆ é™¤å¯¹è±¡</p></blockquote><h4 id="å…±äº«å†…å­˜çš„åˆ é™¤æœºåˆ¶"><a href="#å…±äº«å†…å­˜çš„åˆ é™¤æœºåˆ¶" class="headerlink" title="å…±äº«å†…å­˜çš„åˆ é™¤æœºåˆ¶"></a>å…±äº«å†…å­˜çš„åˆ é™¤æœºåˆ¶</h4><figure class="highlight tex"><table><tbody><tr><td class="code"><pre><span class="line">åœ¨Cè¯­è¨€ä¸­ï¼Œåˆ é™¤å…±äº«å†…å­˜éœ€è¦ç»è¿‡ä»¥ä¸‹æ­¥éª¤ï¼š</span><br><span class="line"></span><br><span class="line">1. è·å–å…±äº«å†…å­˜çš„æ ‡è¯†ç¬¦ï¼ˆä¹Ÿç§°ä¸ºé”®å€¼ï¼‰ã€‚</span><br><span class="line">2. ä½¿ç”¨æ ‡è¯†ç¬¦è·å–å…±äº«å†…å­˜çš„IDï¼ˆä¹Ÿç§°ä¸ºshmidï¼‰ã€‚</span><br><span class="line">3. ä½¿ç”¨shmidè·å–æŒ‡å‘å…±äº«å†…å­˜çš„æŒ‡é’ˆã€‚</span><br><span class="line">4. æ ‡è®°å…±äº«å†…å­˜ä¸ºåˆ é™¤çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨shmctlå‡½æ•°IPC<span class="built_in">_</span>RMIDå‘½ä»¤ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ²¡æœ‰å…¶ä»–è¿›ç¨‹æˆ–çº¿ç¨‹æ­£åœ¨ä½¿ç”¨è¯¥å…±äº«å†…å­˜ï¼Œç³»ç»Ÿä¼šç«‹å³åˆ é™¤è¯¥å…±äº«å†…å­˜ã€‚å¦åˆ™ï¼Œè¯¥å…±äº«å†…å­˜å°†ä¸€ç›´ä¿æŒåœ¨åˆ é™¤çŠ¶æ€ï¼Œç›´åˆ°æ‰€æœ‰ä½¿ç”¨å®ƒçš„è¿›ç¨‹æˆ–çº¿ç¨‹éƒ½æ ‡è®°ä¸ºåˆ é™¤çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹åœ¨ä½¿ç”¨è¯¥å…±äº«å†…å­˜æ—¶å´©æºƒäº†ï¼Œé‚£ä¹ˆè¯¥å…±äº«å†…å­˜å¯èƒ½ä¼šä¸€ç›´ä¿æŒåœ¨åˆ é™¤çŠ¶æ€ï¼Œç›´åˆ°ç³»ç»Ÿé‡å¯ã€‚å› æ­¤ï¼Œåœ¨ç¼–å†™ä½¿ç”¨å…±äº«å†…å­˜çš„ç¨‹åºæ—¶ï¼Œåº”è¯¥è€ƒè™‘åˆ°è¿™ç§æƒ…å†µï¼Œå¹¶å®ç°é€‚å½“çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚</span><br></pre></td></tr></tbody></table></figure><figure class="highlight tex"><table><tbody><tr><td class="code"><pre><span class="line">ç¬¬ä¸€ä¸ªæ ‡è®°äº†å…±äº«å†…å­˜çš„åˆ é™¤çŠ¶æ€ å…¶ä»–çº¿ç¨‹éƒ½è°ƒç”¨ exitå‡½æ•°å…±äº«å†…å­˜èƒ½è¢«åˆ é™¤å—?</span><br><span class="line">   </span><br><span class="line">å¦‚æœä¸€ä¸ªçº¿ç¨‹æ ‡è®°äº†å…±äº«å†…å­˜çš„åˆ é™¤çŠ¶æ€ï¼Œä½†æ˜¯å…¶ä»–çº¿ç¨‹è°ƒç”¨äº†exit()å‡½æ•°é€€å‡ºäº†è¿›ç¨‹ï¼Œé‚£ä¹ˆè¿™äº›çº¿ç¨‹æ‰€ä½¿ç”¨çš„å…±äº«å†…å­˜å°†ä¸ä¼šè¢«æ˜¾å¼åœ°é‡Šæ”¾ã€‚å› ä¸ºexit()å‡½æ•°ä¼šç»ˆæ­¢æ•´ä¸ªè¿›ç¨‹ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨é‡Šæ”¾è¯¥è¿›ç¨‹æ‰€å ç”¨çš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬å…±äº«å†…å­˜ã€‚</span><br><span class="line"></span><br><span class="line">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…±äº«å†…å­˜å°†è¢«æ“ä½œç³»ç»Ÿè‡ªåŠ¨é‡Šæ”¾ï¼Œé€šå¸¸æ˜¯åœ¨è¿›ç¨‹é€€å‡ºåç«‹å³é‡Šæ”¾ã€‚ä½†æ˜¯ï¼Œå…·ä½“çš„é‡Šæ”¾æ—¶é—´æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ¥å†³å®šçš„ï¼Œå› æ­¤ä¸èƒ½ä¿è¯åœ¨è¿›ç¨‹é€€å‡ºåç«‹å³é‡Šæ”¾å…±äº«å†…å­˜ã€‚å› æ­¤ï¼Œåœ¨ç¼–å†™ä½¿ç”¨å…±äº«å†…å­˜çš„ç¨‹åºæ—¶ï¼Œæœ€å¥½åœ¨ç¨‹åºä¸­æ˜¾å¼åœ°é‡Šæ”¾å…±äº«å†…å­˜ï¼Œè€Œä¸è¦ä¾èµ–äºæ“ä½œç³»ç»Ÿè‡ªåŠ¨é‡Šæ”¾å…±äº«å†…å­˜ã€‚</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">key_t</span> key=ftok(<span class="string">"."</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"key=%d\n"</span>,key);</span><br><span class="line">    <span class="type">int</span> shmid =shmget(key,<span class="number">1024</span>,IPC_CREAT|<span class="number">0777</span>|IPC_EXCL);</span><br><span class="line">    <span class="keyword">if</span>(shmid==<span class="number">-1</span>){</span><br><span class="line">        <span class="keyword">if</span>(errno!=EEXIST){</span><br><span class="line">            perror(<span class="string">"shmget"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            shmid =shmget(key,<span class="number">1024</span>,<span class="number">0777</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"shmid=%d\n"</span>,shmid);</span><br><span class="line">    <span class="type">char</span> * p = shmat(shmid,<span class="literal">NULL</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    fgets(p,<span class="number">1024</span>,<span class="built_in">stdin</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, p);</span><br><span class="line">    shmdt(p);</span><br><span class="line">    shmctl(shmid,IPC_RMID,<span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—"></a>æ¶ˆæ¯é˜Ÿåˆ—</h3><p>æ¶ˆæ¯é˜Ÿåˆ—æ˜¯IPCå¯¹è±¡çš„ä¸€ç§ã€‚æ¶ˆæ¯é˜Ÿåˆ—ç”±æ¶ˆæ¯é˜Ÿåˆ—IDæ¥å”¯ä¸€æ ‡è¯†ã€‚æ¶ˆæ¯é˜Ÿåˆ—å°±æ˜¯ä¸€ä¸ªæ¶ˆæ¯çš„åˆ—è¡¨ã€‚ ç”¨æˆ·å¯ä»¥åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ¶ˆæ¯ã€è¯»å–æ¶ˆæ¯ç­‰ã€‚æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥æŒ‰ç…§ç±»å‹æ¥å‘é€/æ¥æ”¶æ¶ˆæ¯ã€‚</p><p>ç»“æ„ä½“</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">msgbuf</span>{</span></span><br><span class="line">    <span class="type">__syscall_slong_t</span> mtype;    <span class="comment">/* type of received/sent message */</span></span><br><span class="line">    <span class="type">char</span> mtext[<span class="number">1</span>];      <span class="comment">/* text of the message */</span></span><br><span class="line">};</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">msqid_ds</span>{</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">ipc_perm</span> <span class="title">msg_perm</span>;</span> <span class="comment">/* structure describing operation permission */</span></span><br><span class="line">  <span class="type">__time_t</span> msg_stime;       <span class="comment">/* time of last msgsnd command */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> __msg_stime_high;</span><br><span class="line">  <span class="type">__time_t</span> msg_rtime;       <span class="comment">/* time of last msgsnd command */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> __msg_rtime_high;</span><br><span class="line">  <span class="type">__time_t</span> msg_ctime;       <span class="comment">/* time of last change */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> __msg_ctime_high;</span><br><span class="line">  <span class="type">__time_t</span> msg_stime;       <span class="comment">/* time of last msgsnd command */</span></span><br><span class="line">  <span class="type">__time_t</span> msg_rtime;       <span class="comment">/* time of last msgsnd command */</span></span><br><span class="line">  <span class="type">__time_t</span> msg_ctime;       <span class="comment">/* time of last change */</span></span><br><span class="line">  <span class="type">__syscall_ulong_t</span> __msg_cbytes; <span class="comment">/* current number of bytes on queue */</span></span><br><span class="line">  <span class="type">msgqnum_t</span> msg_qnum;       <span class="comment">/* number of messages currently on queue */</span></span><br><span class="line">  <span class="type">msglen_t</span> msg_qbytes;      <span class="comment">/* max number of bytes allowed on queue */</span></span><br><span class="line">  <span class="type">__pid_t</span> msg_lspid;        <span class="comment">/* pid of last msgsnd() */</span></span><br><span class="line">  <span class="type">__pid_t</span> msg_lrpid;        <span class="comment">/* pid of last msgrcv() */</span></span><br><span class="line">  <span class="type">__syscall_ulong_t</span> __glibc_reserved4;</span><br><span class="line">  <span class="type">__syscall_ulong_t</span> __glibc_reserved5;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><h4 id="åˆ›å»º-x2F-æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—"><a href="#åˆ›å»º-x2F-æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="åˆ›å»º/æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—"></a>åˆ›å»º/æ‰“å¼€æ¶ˆæ¯é˜Ÿåˆ—</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">msgget</span><span class="params">(<span class="type">key_t</span> key, <span class="type">int</span> msgflg)</span>;</span><br><span class="line">keyï¼šç”¨äºæ ‡è¯†æ¶ˆæ¯é˜Ÿåˆ—çš„é”®ã€‚</span><br><span class="line">msgflgï¼šæ ‡å¿—å‚æ•°ï¼Œç”¨äºæŒ‡å®šåˆ›å»ºæ–°æ¶ˆæ¯é˜Ÿåˆ—æ—¶çš„è¡Œä¸ºï¼Œæˆ–è€…ç”¨äºè®¿é—®ç°æœ‰æ¶ˆæ¯é˜Ÿåˆ—æ—¶çš„è®¿é—®æƒé™ã€‚</span><br><span class="line">    IPC_CREAT:å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒã€‚</span><br><span class="line">    IPC_EXCL:å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—å·²å­˜åœ¨ï¼Œåˆ™è¿”å›é”™è¯¯ã€‚</span><br><span class="line"><span class="number">0666</span>ï¼šæŒ‡å®šæ¶ˆæ¯é˜Ÿåˆ—çš„è®¿é—®æƒé™ã€‚</span><br><span class="line">IPC_NOWAITï¼šå½“æ¶ˆæ¯é˜Ÿåˆ—å·²æ»¡æˆ–æ²¡æœ‰å¯è¯»æ¶ˆæ¯æ—¶ï¼Œä¸è¦å°†è¿›ç¨‹æŒ‚èµ·ç­‰å¾…å¯ç”¨ç©ºé—´æˆ–æ¶ˆæ¯ï¼Œè€Œæ˜¯ç«‹å³è¿”å›é”™è¯¯ã€‚</span><br><span class="line">MSG_EXCEPTï¼šåœ¨è¯»å–æ¶ˆæ¯æ—¶ï¼Œåªæ¥æ”¶ç±»å‹ä¸ç­‰äºæŒ‡å®šç±»å‹çš„æ¶ˆæ¯ã€‚æ­¤æ ‡å¿—å¿…é¡»ä¸ IPC_NOWAIT æ ‡å¿—ç»“åˆä½¿ç”¨ã€‚</span><br><span class="line">MSG_NOERRORï¼šåœ¨è¯»å–æ¶ˆæ¯æ—¶ï¼Œå¦‚æœè¯»å–çš„æ¶ˆæ¯é•¿åº¦è¶…è¿‡äº†æ¥æ”¶æ–¹çš„ç¼“å†²åŒºé•¿åº¦ï¼Œåˆ™æˆªæ–­è¯¥æ¶ˆæ¯ï¼Œä¸è¿”å›é”™è¯¯ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®æ­¤æ ‡å¿—ï¼Œåˆ™è¯»å–è¿‡é•¿çš„æ¶ˆæ¯å°†è¿”å›é”™è¯¯ã€‚</span><br><span class="line">è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªéè´Ÿæ•´æ•°è¡¨ç¤ºæ¶ˆæ¯é˜Ÿåˆ—çš„æ ‡è¯†ç¬¦(ä¹Ÿç§°ä¸ºæ¶ˆæ¯é˜Ÿåˆ—çš„é”®)ã€‚å¦‚æœå‡½æ•°è¿”å›å€¼ä¸º<span class="number">-1</span>ï¼Œåˆ™è¡¨ç¤ºå‡ºç°äº†é”™è¯¯ï¼Œå…·ä½“é”™è¯¯ä¿¡æ¯å¯ä»¥é€šè¿‡æŸ¥çœ‹errnoå˜é‡æ¥ç¡®å®šã€‚</span><br></pre></td></tr></tbody></table></figure><h4 id="å‘é€æ¶ˆæ¯"><a href="#å‘é€æ¶ˆæ¯" class="headerlink" title="å‘é€æ¶ˆæ¯"></a>å‘é€æ¶ˆæ¯</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">msgsnd</span><span class="params">(<span class="type">int</span> msqid, <span class="type">const</span> <span class="type">void</span> *msgp, <span class="type">size_t</span> msgsz, <span class="type">int</span> msgflg)</span>;</span><br><span class="line">msqidï¼šè¦å‘é€åˆ°çš„æ¶ˆæ¯é˜Ÿåˆ—çš„æ ‡è¯†ç¬¦ã€‚</span><br><span class="line">msgpï¼šæŒ‡å‘åŒ…å«è¦å‘é€çš„æ¶ˆæ¯çš„æŒ‡é’ˆã€‚</span><br><span class="line">msgszï¼šè¦å‘é€çš„æ¶ˆæ¯çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</span><br><span class="line">msgflgï¼šæŒ‡å®šæ¶ˆæ¯å‘é€çš„æ ‡å¿—ã€‚å¸¸è§çš„æ ‡å¿—åŒ…æ‹¬IPC_NOWAITå’ŒMSG_NOERRORç­‰ã€‚</span><br><span class="line">è¿”å›å€¼ï¼šæˆåŠŸï¼Œåˆ™<span class="string">"msgsnd"</span>è¿”å›<span class="number">0</span>ï¼Œå¦åˆ™è¿”å›<span class="number">-1</span>å¹¶è®¾ç½®errnoä»¥æŒ‡ç¤ºé”™è¯¯çš„ç±»å‹ã€‚</span><br></pre></td></tr></tbody></table></figure><h4 id="æ¥å—æ¶ˆæ¯"><a href="#æ¥å—æ¶ˆæ¯" class="headerlink" title="æ¥å—æ¶ˆæ¯"></a>æ¥å—æ¶ˆæ¯</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">msgrcv</span><span class="params">(<span class="type">int</span> msqid, <span class="type">void</span> *msgp, <span class="type">size_t</span> msgsz, <span class="type">long</span> msgtyp, <span class="type">int</span> msgflg)</span>;</span><br><span class="line">msqidï¼šæ¶ˆæ¯é˜Ÿåˆ—çš„æ ‡è¯†ç¬¦ï¼Œè¯¥æ ‡è¯†ç¬¦ç”±msggetå‡½æ•°è¿”å›ã€‚</span><br><span class="line">msgpï¼šæŒ‡å‘æ¶ˆæ¯ç¼“å†²åŒºçš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚</span><br><span class="line">msgszï¼šæ¥æ”¶æ¶ˆæ¯ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚å¦‚æœæ¥æ”¶åˆ°çš„æ¶ˆæ¯å¤§äºmsgszï¼Œåˆ™ä¼šè¢«æˆªæ–­ã€‚</span><br><span class="line">msgtypï¼šæŒ‡å®šè¦æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹ã€‚</span><br><span class="line">    msgtypå¤§äº<span class="number">0</span>ï¼Œåˆ™åªæ¥æ”¶æ¶ˆæ¯ç±»å‹ç­‰äºmsgtypçš„æ¶ˆæ¯ï¼›</span><br><span class="line">    msgtypç­‰äº<span class="number">0</span>ï¼Œåˆ™æ¥æ”¶é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªæ¶ˆæ¯ï¼›</span><br><span class="line">    msgtypå°äº<span class="number">0</span>ï¼Œåˆ™æ¥æ”¶ç±»å‹å°äºæˆ–ç­‰äºmsgtypç»å¯¹å€¼çš„ç¬¬ä¸€ä¸ªæ¶ˆæ¯ã€‚</span><br><span class="line">msgflgï¼šæŒ‡å®šæ¥æ”¶æ¶ˆæ¯çš„é€‰é¡¹ã€‚</span><br><span class="line">    IPC_NOWAITï¼ˆéé˜»å¡æ–¹å¼ï¼‰</span><br><span class="line">    MSG_NOERRORï¼ˆä¸æˆªæ–­æ¶ˆæ¯ï¼‰</span><br><span class="line">    IPC_EXCEPTï¼ˆæ¥æ”¶ç¬¬ä¸€ä¸ªç±»å‹ä¸ä¸ºmsgtypçš„æ¶ˆæ¯ï¼‰MSG_COPYï¼ˆè¿”å›æ¶ˆæ¯å‰¯æœ¬è€Œä¸æ˜¯åŸå§‹æ¶ˆæ¯ï¼‰</span><br><span class="line">    ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒä»¬çš„æŒ‰ä½æˆ–è¿ç®—ã€‚</span><br><span class="line">è¿”å›å€¼ï¼šmsgrcvå‡½æ•°çš„è¿”å›å€¼ä¸ºæ¥æ”¶åˆ°çš„æ¶ˆæ¯çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œå¦‚æœæ¥æ”¶æ¶ˆæ¯æ—¶å‡ºç°é”™è¯¯ï¼Œåˆ™è¿”å›<span class="number">-1</span>ã€‚å¯ä»¥ä½¿ç”¨errnoå˜é‡æ¥æŸ¥çœ‹å‘ç”Ÿçš„é”™è¯¯ç±»å‹ã€‚</span><br></pre></td></tr></tbody></table></figure><h4 id="æ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—"></a>æ§åˆ¶æ¶ˆæ¯é˜Ÿåˆ—</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">msgctl</span><span class="params">(<span class="type">int</span> msqid, <span class="type">int</span> cmd, <span class="keyword">struct</span> msqid_ds *buf)</span>;</span><br><span class="line">msqidï¼šç”±msggetå‡½æ•°åˆ›å»ºæˆ–è·å–çš„æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦</span><br><span class="line">cmdï¼šæ§åˆ¶å‘½ä»¤ï¼Œå‚æ•°å¯å–ä»¥ä¸‹å€¼ï¼š</span><br><span class="line">IPC_STATï¼šè·å–æ¶ˆæ¯é˜Ÿåˆ—çš„å±æ€§ä¿¡æ¯ï¼Œå°†å…¶å­˜å‚¨åœ¨bufæŒ‡å‘çš„msqid_dsç»“æ„ä½“ä¸­ã€‚</span><br><span class="line">IPC_SETï¼šè®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—çš„å±æ€§ä¿¡æ¯ï¼Œå…¶ä¸­bufæŒ‡å‘çš„msqid_dsç»“æ„ä½“ä¸­å­˜å‚¨äº†æ–°çš„å±æ€§å€¼ã€‚</span><br><span class="line">IPC_RMIDï¼šåˆ é™¤æ¶ˆæ¯é˜Ÿåˆ—ã€‚åˆ é™¤æ“ä½œï¼Œbufä¸º<span class="literal">NULL</span>ã€‚</span><br><span class="line">è¿”å›å€¼ï¼šè¿”å›<span class="number">0</span>è¡¨ç¤ºæˆåŠŸï¼Œ<span class="number">-1</span>è¡¨ç¤ºå‡ºé”™ï¼Œå¹¶è®¾ç½®errnoä¸ºç›¸åº”çš„é”™è¯¯ä»£ç ã€‚</span><br><span class="line">bufï¼šmsqid_dsç»“æ„ä½“çš„æŒ‡é’ˆï¼Œç”¨äºè·å–æˆ–ä¿®æ”¹æ¶ˆæ¯é˜Ÿåˆ—çš„å±æ€§ä¿¡æ¯ã€‚</span><br></pre></td></tr></tbody></table></figure><h4 id="ä¾‹å­-1"><a href="#ä¾‹å­-1" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/msg.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">msgbuf</span>{</span></span><br><span class="line">    <span class="type">long</span> mtype;    <span class="comment">/* type of received/sent message */</span></span><br><span class="line">    <span class="type">char</span> mtext[<span class="number">100</span>];      <span class="comment">/* text of the message */</span></span><br><span class="line">}msgbuf;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line"><span class="comment">//åˆ›å»º</span></span><br><span class="line"><span class="type">int</span> key = ftok(<span class="string">"."</span>,<span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> msgid=msgget(key,IPC_CREAT|<span class="number">0666</span>);</span><br><span class="line"><span class="keyword">if</span>(msgid==<span class="number">-1</span>){</span><br><span class="line">perror(<span class="string">"msgget"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}<span class="keyword">else</span> {</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"msgget success\n"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="comment">//å‘é€</span></span><br><span class="line">msgbuf sndbuf={<span class="number">1</span>,<span class="string">"hello world!"</span>};</span><br><span class="line"><span class="type">int</span> retsnd = msgsnd(msgid,&amp;sndbuf,<span class="number">100</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(retsnd==<span class="number">-1</span>){</span><br><span class="line">perror(<span class="string">"msgsnd"</span>);</span><br><span class="line"><span class="keyword">goto</span> error1;</span><br><span class="line">}<span class="keyword">else</span> {</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"msgsnd success\n"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¥æ”¶</span></span><br><span class="line">msgbuf rcvbuf;</span><br><span class="line"><span class="type">int</span> retrcv = msgrcv(msgid,&amp;rcvbuf,<span class="number">100</span>,<span class="number">0</span>,IPC_NOWAIT);</span><br><span class="line"><span class="keyword">if</span> (retrcv == <span class="number">-1</span>){</span><br><span class="line">perror(<span class="string">"msgrcv"</span>);</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"msgrcv success\n"</span>);</span><br><span class="line">}</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%ld\n"</span>,rcvbuf.mtype);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s\n"</span>,rcvbuf.mtext);</span><br><span class="line">error1:</span><br><span class="line"><span class="comment">//å…³é—­</span></span><br><span class="line">msgctl(msgid,IPC_RMID,<span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="ä¿¡å·ç¯é›†"><a href="#ä¿¡å·ç¯é›†" class="headerlink" title="ä¿¡å·ç¯é›†"></a>ä¿¡å·ç¯é›†</h3><p>æ¦‚å¿µ:å¤šç§ä¿¡å·é‡çš„é›†åˆï¼Œæ¯ç§ä¿¡å·é‡ä¸‹å¯ä»¥å¤šä¸ªä¿¡å·é‡</p><p>1ã€åˆ›å»ºã€æ‰“å¼€ä¿¡å·ç¯é›†å¯¹è±¡</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;syspes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sysm.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">semget</span><span class="params">(<span class="type">key_t</span> key, <span class="type">int</span> nsems, <span class="type">int</span> semflg)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šåˆ›å»ºæˆ–è€…æ‰“å¼€ä¸€ä¸ªä¿¡å·ç¯é›†å¯¹è±¡</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›IDå·ï¼Œå¤±è´¥è¿”å›-1</span></span><br><span class="line">keyï¼šè¦æ‰“å¼€æˆ–è€…åˆ›å»ºå¯¹è±¡æ—¶çš„â€œå¯†é’¥â€</span><br><span class="line">nesms</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">key_t</span> key =ftok(<span class="string">"."</span>,<span class="number">11</span>);</span><br><span class="line">    <span class="keyword">if</span>(key&lt;<span class="number">0</span>){</span><br><span class="line">        perror(<span class="string">"ftok"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"key=%d\n"</span>,key);</span><br><span class="line">    <span class="type">int</span> semid=semget(key,<span class="number">3</span>,IPC_CREAT|<span class="number">0666</span>);</span><br><span class="line">    <span class="keyword">if</span>(semid&lt;<span class="number">0</span>){</span><br><span class="line">        perror(<span class="string">"semget"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"sem id =%d"</span>,semid);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>2ã€ä¿¡å·ç¯é›†çš„æ“ä½œ(P/V)</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">semop</span><span class="params">( <span class="type">int</span> semid, <span class="keyword">struct</span> sembuf *opsptrï¼Œ <span class="type">size_t</span> nops)</span>;</span><br><span class="line">åŠŸèƒ½:ç”³è¯·æˆ–è€…é‡Šæ”¾èµ„æº</span><br><span class="line">è¿”å›å€¼:æˆåŠŸè¿”å›<span class="number">0</span>ï¼Œå¤±è´¥è¿”å›<span class="number">-1</span></span><br><span class="line">semid:ä¿¡å·ç¯é›†IDå·</span><br><span class="line">opsptr:è¦å¯¹ä¿¡å·ç¯çš„æ“ä½œ</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sembuf</span> {</span></span><br><span class="line">    <span class="type">short</span> sem_ num;<span class="comment">//è¦æ“ä½œçš„ä¿¡ å·ç¯çš„ç¼–å·</span></span><br><span class="line"><span class="type">short</span> sem_ op;</span><br><span class="line">    <span class="comment">//0 :ç­‰å¾…ï¼Œç›´åˆ°ä¿¡å·ç¯çš„å€¼å˜æˆ0</span></span><br><span class="line">        <span class="comment">//1 :é‡Šæ”¾èµ„æºï¼ŒVæ“ä½œ</span></span><br><span class="line">        <span class="comment">//-1 :åˆ†é…èµ„æºï¼ŒPæ“ä½œ</span></span><br><span class="line"><span class="type">short</span> sem_ _f1g; <span class="comment">// 0ï¼ŒIPC_ NOWAIT, SEM_ _UNDO</span></span><br><span class="line">};</span><br><span class="line">nops:è¦æ“ä½œçš„ä¸ªæ•°-- <span class="number">1</span>|</span><br></pre></td></tr></tbody></table></figure><p>2ã€ä¿¡å·ç¯é›†çš„æ•´ä½“æ§åˆ¶(åˆ é™¤ã€åˆå§‹åŒ–)</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">semctl</span><span class="params">(<span class="type">int</span> semid, <span class="type">int</span> semnum, <span class="type">int</span> cmd...<span class="comment">/*union semun arg*/</span>)</span>;</span><br><span class="line">åŠŸèƒ½:æ•´ä½“æ§åˆ¶ä¿¡å·ç¯é›†</span><br><span class="line">è¿”å›å€¼:æˆåŠŸè¿”å›<span class="number">0</span>ï¼Œå¤±è´¥è¿”å›<span class="number">-1</span></span><br><span class="line">semid:è¦æ“ä½œçš„idå·</span><br><span class="line">semnum: </span><br><span class="line">è¦ä¿®æ”¹çš„ä¿¡å·ç¯ç¼–å·(type) </span><br><span class="line">cmd:è¦æ‰§è¡Œçš„æŒ‡ä»¤</span><br><span class="line">GETVAL:è·å–ä¿¡å·ç¯çš„å€¼</span><br><span class="line">SETVAL:è®¾ç½®ä¿¡å·ç¯çš„å€¼</span><br><span class="line">IPC_ RMID:ä»ç³»ç»Ÿä¸­åˆ é™¤ä¿¡å·ç¯é›†åˆ</span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">semun</span> {</span></span><br><span class="line"><span class="type">int</span> val;<span class="comment">/* Value for SETVAL */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">semid_</span> _<span class="title">ds</span> *<span class="title">buf</span>;</span><span class="comment">/* Buffer for IPC_ STATï¼Œ IPC_ _SET */</span></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">short</span> *<span class="built_in">array</span>; <span class="comment">/* Array for GETALLï¼Œ SETALL */</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">seminfo</span> *__ <span class="title">buf</span>;</span> <span class="comment">/* Buffer for IPC_ INFO</span></span><br><span class="line"><span class="comment">(Linux-specific) */</span></span><br><span class="line">    };</span><br><span class="line">å¦‚æœéœ€è¦è®¾ç½®å€¼ï¼Œé‚£ä¹ˆä¼šæœ‰ç¬¬å››ä¸ªå‚æ•°(å…±ç”¨ä½“)ï¼Œè¿™ä¸ªå…±ç”¨ä½“é‡Œçš„va1æˆå‘˜è¡¨ç¤ºç»™ä¿¡å·ç¯åˆå§‹åŒ–ä¸ªæ•°</span><br><span class="line">æ³¨:å¦‚æœæ˜¯åˆ é™¤ï¼Œä¸éœ€è¦å…±ç”¨ä½“ã€‚åªéœ€è¦åœ¨semnumè¿™ä¸ªå‚æ•°éšä¾¿å†™ä¸€ä¸ªä¿¡å·ç¯é›†çš„ç¼–å·å°±èƒ½æ•´ä½“åˆ å®Œå¯¹è±¡</span><br></pre></td></tr></tbody></table></figure><h2 id="ç»¼åˆ"><a href="#ç»¼åˆ" class="headerlink" title="ç»¼åˆ"></a>ç»¼åˆ</h2><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sem.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> READ0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> WRITE1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> P-1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> V1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">semun</span> {</span></span><br><span class="line">    <span class="type">int</span>              val;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">semid_ds</span> *<span class="title">buf</span>;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span>  *<span class="built_in">array</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">seminfo</span>  *__<span class="title">buf</span>;</span></span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">init_sem</span><span class="params">(<span class="type">int</span> semid, <span class="type">int</span> s[], <span class="type">int</span> n)</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> i, ret;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">semun</span> <span class="title">myun</span>;</span></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++){</span><br><span class="line">        myun.val = s[i];</span><br><span class="line">        ret = semctl(semid, i, SETVAL, myun);</span><br><span class="line">        <span class="keyword">if</span>(ret &lt; <span class="number">0</span>){</span><br><span class="line">            perror(<span class="string">"semctl"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_pv</span><span class="params">(<span class="type">int</span> semid, <span class="type">int</span> num, <span class="type">int</span> op)</span></span><br><span class="line">{</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sembuf</span> <span class="title">buf</span>;</span></span><br><span class="line">    buf.sem_num= num;</span><br><span class="line">    buf.sem_op= op;</span><br><span class="line">    buf.sem_flg= <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ret = semop(semid, &amp;buf, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(ret &lt; <span class="number">0</span>){</span><br><span class="line">        perror(<span class="string">"semop"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">sig_handler</span><span class="params">(<span class="type">int</span> sig)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">if</span>(sig == SIGCHLD){</span><br><span class="line">        waitpid(<span class="number">-1</span>, <span class="literal">NULL</span>, WNOHANG);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">    <span class="type">int</span> s[] = {<span class="number">0</span>, <span class="number">1</span>};</span><br><span class="line">    <span class="type">key_t</span> key = ftok(<span class="string">"."</span>, <span class="string">'a'</span>);</span><br><span class="line">    <span class="keyword">if</span>(key &lt; <span class="number">0</span>){</span><br><span class="line">        perror(<span class="string">"ftok"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*1. create share memory*/</span></span><br><span class="line">    <span class="type">int</span> shmid = shmget(key, <span class="number">512</span>, IPC_CREAT | <span class="number">0666</span>);</span><br><span class="line">    <span class="keyword">if</span>(shmid &lt; <span class="number">0</span>){</span><br><span class="line">        perror(<span class="string">"shmget"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*2. shm mmap*/</span></span><br><span class="line">    <span class="type">char</span> *shmaddr = shmat(shmid, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(shmaddr == (<span class="type">void</span> *)<span class="number">-1</span>){</span><br><span class="line">        perror(<span class="string">"shmat"</span>);</span><br><span class="line">        <span class="keyword">goto</span> _error1;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*3. create sem*/</span></span><br><span class="line">    <span class="type">int</span> semid = semget(key, <span class="number">2</span>, IPC_CREAT | <span class="number">0666</span>);</span><br><span class="line">    <span class="keyword">if</span>(semid &lt; <span class="number">0</span>){</span><br><span class="line">        perror(<span class="string">"semget"</span>);</span><br><span class="line">        <span class="keyword">goto</span> _error1;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*4. init sem*/</span></span><br><span class="line">    <span class="type">int</span> ret = init_sem(semid, s, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span>(ret &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">goto</span> _error2;</span><br><span class="line"></span><br><span class="line">    <span class="type">pid_t</span> pid = fork();</span><br><span class="line">    <span class="keyword">if</span>(pid &lt; <span class="number">0</span>){</span><br><span class="line">        perror(<span class="string">"fork"</span>);</span><br><span class="line">        <span class="keyword">goto</span> _error2;</span><br><span class="line">    }<span class="keyword">else</span> <span class="keyword">if</span>(pid == <span class="number">0</span>){</span><br><span class="line">        <span class="comment">//child -- function : delete space</span></span><br><span class="line">        <span class="type">char</span> *p, *q;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line">            <span class="comment">//P - read</span></span><br><span class="line">            sem_pv(semid, READ, P);</span><br><span class="line">            <span class="keyword">if</span>(strncasecmp(shmaddr, <span class="string">"quit\n"</span>, <span class="number">5</span>) == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">goto</span> _error2;</span><br><span class="line">            p = q = shmaddr;</span><br><span class="line">            <span class="keyword">while</span>(*p != <span class="string">'\0'</span>){</span><br><span class="line">                <span class="keyword">if</span>(*p != <span class="string">' '</span>)</span><br><span class="line">                    *q++ = *p;</span><br><span class="line">                p++;</span><br><span class="line">            }</span><br><span class="line">            *q = <span class="string">'\0'</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"result : %s"</span>, shmaddr);</span><br><span class="line">            <span class="comment">//V - write</span></span><br><span class="line">            sem_pv(semid, WRITE, V);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="comment">//parent -- function: fgets strings</span></span><br><span class="line">        signal(SIGCHLD, sig_handler);</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line">            <span class="comment">//P - write</span></span><br><span class="line">            sem_pv(semid, WRITE, P);</span><br><span class="line">            fgets(shmaddr, <span class="number">256</span>, <span class="built_in">stdin</span>);</span><br><span class="line">            <span class="comment">//V - read</span></span><br><span class="line">            sem_pv(semid, READ, V);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    _error2:</span><br><span class="line">    semctl(semid, <span class="number">0</span>, IPC_RMID);</span><br><span class="line"></span><br><span class="line">    _error1:</span><br><span class="line">    shmctl(shmid, IPC_RMID, <span class="literal">NULL</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> Cè¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IO</title>
      <link href="/2023/03/29/IO/"/>
      <url>/2023/03/29/IO/</url>
      
        <content type="html"><![CDATA[<h1 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h1><h2 id="æ ‡å‡†IO"><a href="#æ ‡å‡†IO" class="headerlink" title="æ ‡å‡†IO"></a>æ ‡å‡†IO</h2><p>æµ-FILEç»“æ„ä½“</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">grep -r "struct _IO_FILE" /user/include/</span><br></pre></td></tr></tbody></table></figure><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span></span></span><br><span class="line"><span class="class">{</span></span><br><span class="line">  <span class="type">int</span> _flags;           <span class="comment">/* High-order word is _IO_MAGIC; rest is flags. */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* The following pointers correspond to the C++ streambuf protocol. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_read_ptr;   <span class="comment">/* Current read pointer */</span></span><br><span class="line">  <span class="type">char</span> *_IO_read_end;   <span class="comment">/* End of get area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_read_base;  <span class="comment">/* Start of putback+get area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_write_base; <span class="comment">/* Start of put area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_write_ptr;  <span class="comment">/* Current put pointer. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_write_end;  <span class="comment">/* End of put area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_buf_base;   <span class="comment">/* Start of reserve area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_buf_end;    <span class="comment">/* End of reserve area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* The following fields are used to support backing up and undo. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_save_base; <span class="comment">/* Pointer to start of non-current get area. */</span></span><br><span class="line">  <span class="type">char</span> *_IO_backup_base;  <span class="comment">/* Pointer to first valid character of backup area */</span></span><br><span class="line">  <span class="type">char</span> *_IO_save_end; <span class="comment">/* Pointer to end of non-current get area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_marker</span> *_<span class="title">markers</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> *_<span class="title">chain</span>;</span></span><br><span class="line">    <span class="type">int</span> _fileno;</span><br><span class="line">    <span class="type">int</span> _flags2;</span><br><span class="line">  <span class="type">__off_t</span> _old_offset; <span class="comment">/* This used to be _offset but it's too small.  */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 1+column number of pbase(); 0 is unknown. */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">short</span> _cur_column;</span><br><span class="line">  <span class="type">signed</span> <span class="type">char</span> _vtable_offset;</span><br><span class="line">  <span class="type">char</span> _shortbuf[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  _IO_lock_t *_lock;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _IO_USE_OLD_IO_FILE</span></span><br><span class="line">};</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h4 id="ç¼“å†²åŒº"><a href="#ç¼“å†²åŒº" class="headerlink" title="ç¼“å†²åŒº"></a>ç¼“å†²åŒº</h4><ol><li>å…¨ç¼“å†²ï¼šå½“ç¼“å†²åŒºæ»¡äº†æˆ–è€…ç‰¹å®šçš„æƒ…å†µä¸‹æ‰ä¼šåˆ·æ–°</li><li>è¡Œç¼“å†²ï¼šå½“ç¼“å†²åŒºä¸­æœ‰äº†æ¢è¡Œ\nå°±ä¼šåˆ·æ–°</li><li>æ— ç¼“å†²ï¼šä»»ä½•ä¸œè¥¿è¿›å…¥ç¼“å†²åŒºé©¬ä¸Šè¢«åˆ·æ–°èµ°</li></ol><ul><li>é»˜è®¤ï¼šç¨‹åºç»“æŸä¼šåˆ·æ–°ç¼“å†²åŒº</li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line"></span><br><span class="line">   <span class="type">char</span> buff[<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line">   <span class="built_in">memset</span>( buff, <span class="string">'\0'</span>, <span class="keyword">sizeof</span>( buff ));</span><br><span class="line"></span><br><span class="line">   <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"å¯ç”¨å…¨ç¼“å†²\n"</span>);</span><br><span class="line">   setvbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>, _IOFBF, <span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line">   <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"è¿™é‡Œæ˜¯ runoob.com\n"</span>);</span><br><span class="line">   <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"è¯¥è¾“å‡ºå°†ä¿å­˜åˆ° buff\n"</span>);</span><br><span class="line">   fflush( <span class="built_in">stdout</span> );</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">   <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"è¿™å°†åœ¨ç¼–ç¨‹æ—¶å‡ºç°\n"</span>);</span><br><span class="line">   <span class="built_in">fprintf</span>(<span class="built_in">stdout</span>, <span class="string">"æœ€åä¼‘çœ äº”ç§’é’Ÿ\n"</span>);</span><br><span class="line"></span><br><span class="line">   sleep(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="setvbuf"><a href="#setvbuf" class="headerlink" title="setvbuf"></a>setvbuf</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">setvbuf</span><span class="params">(FILE *stream, <span class="type">char</span> *buf, <span class="type">int</span> mode, <span class="type">size_t</span> size)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå¯ä»¥æ›´æ”¹ç¼“å†²åŒºç±»å‹ï¼ˆç¼“å†²åŒºå¯ä»¥äººä¸ºæŒ‡å®šï¼‰</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›é0</span></span><br><span class="line"><span class="comment">//streamï¼šæµï¼Œè¡¨ç¤ºè¦æ›´æ”¹ç¼“å†²ç±»å‹çš„æµ</span></span><br><span class="line"><span class="comment">//bufï¼šç¼“å†²åŒºåœ°å€</span></span><br><span class="line"><span class="comment">//modeï¼šè¦æ”¹æˆçš„ç¼“å†²åŒºç±»å‹</span></span><br><span class="line"><span class="comment">//_IONBFï¼šæ— ç¼“å†²</span></span><br><span class="line"><span class="comment">//_IOLBFï¼šè¡Œç¼“å†²</span></span><br><span class="line"><span class="comment">//_IOFBFï¼šå…¨ç¼“å†²</span></span><br><span class="line"><span class="comment">//sizeï¼šè¦æ›´æ”¹bufçš„å¤§å°ï¼ˆå•ä½å­—èŠ‚ï¼‰</span></span><br></pre></td></tr></tbody></table></figure><h4 id="perrorã€errnoã€stderr"><a href="#perrorã€errnoã€stderr" class="headerlink" title="perrorã€errnoã€stderr"></a>perrorã€errnoã€stderr</h4><blockquote><ul><li>errnoï¼šé”™è¯¯å·ï¼Œç”¨äºå†…æ ¸è°ƒç”¨å®Œå‡½æ•°åè®¾ç½®è°ƒç”¨ç»“æœçš„ç¼–å·</li><li>perrorï¼šè¾“å‡ºå¯¹åº”é”™è¯¯å·çš„ä¿¡æ¯</li><li>stderrï¼šæ ‡å‡†å‡ºé”™æµ â€“ æ— ç¼“å†²</li></ul></blockquote><h3 id="æ ‡å‡†æµ"><a href="#æ ‡å‡†æµ" class="headerlink" title="æ ‡å‡†æµ"></a>æ ‡å‡†æµ</h3><blockquote><p>æ ‡å‡†è¾“å…¥æµï¼šstdin â€“ 0</p><p>æ ‡å‡†è¾“å‡ºæµï¼šstdout â€“ 1</p><p>æ ‡å‡†å‡ºé”™æµï¼šstderr â€“ 2</p><p>æ¯æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œéƒ½ä¼šé»˜è®¤æ‰“å¼€è¿™ä¸‰ä¸ªæµ</p></blockquote><h4 id="åˆ·æ–°ç¼“å†²åŒº-â€”-fflush"><a href="#åˆ·æ–°ç¼“å†²åŒº-â€”-fflush" class="headerlink" title="åˆ·æ–°ç¼“å†²åŒº â€” fflush"></a>åˆ·æ–°ç¼“å†²åŒº â€” fflush</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fflush</span><span class="params">(FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå¼ºåˆ¶åˆ·æ–°ä¸€ä¸ªæµï¼ˆLinuxä¸‹ä¸èƒ½åˆ·æ–°stdinï¼‰</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›EOF</span></span><br><span class="line"><span class="comment">//streamï¼šè¦åˆ·æ–°çš„æµ</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æ‰“å¼€æ–‡ä»¶-â€”-fopen"><a href="#æ‰“å¼€æ–‡ä»¶-â€”-fopen" class="headerlink" title="æ‰“å¼€æ–‡ä»¶ â€” fopen()"></a>æ‰“å¼€æ–‡ä»¶ â€” fopen()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">FILE *<span class="title function_">fopen</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname,<span class="type">const</span> <span class="type">char</span> mode)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼š</span></span><br><span class="line"><span class="comment">//è®©å†…æ ¸æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶ä¸”æ ‡è®°å®ƒ</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼š</span></span><br><span class="line"><span class="comment">//æˆåŠŸè¿”å›æµæŒ‡é’ˆï¼Œå¤±è´¥è¿”å›NULL</span></span><br><span class="line"><span class="comment">//pathnameï¼šè¦æ‰“å¼€çš„æ–‡ä»¶åï¼ˆåŒ…å«è·¯å¾„ï¼‰</span></span><br><span class="line"><span class="comment">//modeï¼šæ‰“å¼€æ–‡ä»¶çš„æ–¹å¼ï¼ˆåªè¯»ã€åªå†™...ï¼‰</span></span><br></pre></td></tr></tbody></table></figure><blockquote><p>æ³¨ï¼šå¦‚æœæ“ä½œäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé‚£ä¹ˆæ‰“å¼€æ–‡ä»¶æ—¶çš„æ–¹å¼å¯ä»¥åŠ ä¸Šbï¼Œä½†æ˜¯Linuxä¸‹ä¸åŒºåˆ†äºŒè¿›åˆ¶æµå’Œæ–‡æœ¬æµ</p></blockquote><h4 id="å…³é—­æµ-â€”-fclose"><a href="#å…³é—­æµ-â€”-fclose" class="headerlink" title="å…³é—­æµ â€” fclose()"></a>å…³é—­æµ â€” fclose()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fclose</span><span class="params">(FILE *stream)</span></span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå…³é—­å·²ç»æ‰“å¼€çš„æµ</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›EOF</span></span><br><span class="line"><span class="comment">//streamï¼šè¦å…³é—­çš„æµ</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æŒ‰å­—ç¬¦è¯»-â€”-fgetc"><a href="#æŒ‰å­—ç¬¦è¯»-â€”-fgetc" class="headerlink" title="æŒ‰å­—ç¬¦è¯» â€” fgetc()"></a>æŒ‰å­—ç¬¦è¯» â€” fgetc()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fgetc</span><span class="params">(FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šä»æµé‡Œé¢è¯»å–ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›è¯»åˆ°çš„å­—ç¬¦ï¼Œå¤±è´¥è¿”å›EOF</span></span><br><span class="line"><span class="comment">//streamï¼šè¦è¯»çš„æµ</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æŒ‰å­—ç¬¦å†™-â€”-fputs"><a href="#æŒ‰å­—ç¬¦å†™-â€”-fputs" class="headerlink" title="æŒ‰å­—ç¬¦å†™ â€” fputs()"></a>æŒ‰å­—ç¬¦å†™ â€” fputs()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fputc</span><span class="params">(<span class="type">int</span> c, FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå¾€æµé‡Œé¢å†™ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›å†™å…¥çš„å­—ç¬¦ï¼Œå¤±è´¥è¿”å›EOF</span></span><br><span class="line"><span class="comment">//cï¼šè¦å†™çš„å­—ç¬¦</span></span><br><span class="line"><span class="comment">//streamï¼šè¦å†™å…¥çš„æµ</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æŒ‰è¡Œè¯»-â€”-fgets"><a href="#æŒ‰è¡Œè¯»-â€”-fgets" class="headerlink" title="æŒ‰è¡Œè¯» â€”- fgets()"></a>æŒ‰è¡Œè¯» â€”- fgets()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">fgets</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> size, FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šè¯»å–ä¸€è¡Œçš„å†…å®¹</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›sçš„åœ°å€ï¼Œå¤±è´¥è¿”å›NULL</span></span><br><span class="line"><span class="comment">//sï¼šè¦æŠŠå†…å®¹è¯»åˆ°å“ªé‡Œå»ï¼ˆç¼“å†²åŒºï¼‰</span></span><br><span class="line"><span class="comment">//sizeï¼šé¢„è®¡è¦è¯»çš„å­—èŠ‚æ•°</span></span><br><span class="line"><span class="comment">//streamï¼šä»å“ªä¸ªæµè¯»å–</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨ï¼šfgetsæ˜¯è¡¨ç¤ºé‡åˆ°äº†æ¢è¡Œç¬¦æ‰ç»ˆæ­¢ï¼Œå¦‚æœsizeæ¯”ä¸€è¡Œçš„æ•°æ®å¤§ï¼Œå°±è¯»å®Œæ‰€æœ‰å†…å®¹ã€‚sizeå¦‚æœæ¯”ä¸€è¡Œæ•°æ®å°ï¼Œåªè¯»size-1ä¸ªï¼Œè¿½åŠ ä¸€ä¸ª'\0'ï¼Œè¡¨ç¤ºæ²¡è¯»å®Œã€‚</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æŒ‰è¡Œå†™-â€”-fputs"><a href="#æŒ‰è¡Œå†™-â€”-fputs" class="headerlink" title="æŒ‰è¡Œå†™ â€” fputs()"></a>æŒ‰è¡Œå†™ â€” fputs()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fputs</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *s, FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šå¾€ä¸€ä¸ªæµé‡Œé¢å†™ä¸€è¡Œæ•°æ®</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›éè´Ÿæ•°ï¼Œå¤±è´¥è¿”å›EOF</span></span><br><span class="line"><span class="comment">//sï¼šè¦å†™å…¥çš„å†…å®¹æ‰€åœ¨çš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment">//streamï¼šè¦å†™å…¥çš„æµ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨ï¼šfputså’Œputsä¸ä¸€æ ·ï¼Œputsä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªæ¢è¡Œï¼Œfputsä¸æ·»åŠ </span></span><br></pre></td></tr></tbody></table></figure><h4 id="æŒ‰å¯¹è±¡è¯»-â€”-fread"><a href="#æŒ‰å¯¹è±¡è¯»-â€”-fread" class="headerlink" title="æŒ‰å¯¹è±¡è¯» â€” fread()"></a>æŒ‰å¯¹è±¡è¯» â€” fread()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">fread</span><span class="params">(<span class="type">void</span> *ptr, <span class="type">size_t</span> size, <span class="type">size_t</span> nmemb, FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šä»æµé‡Œé¢è¯»å–å†…å®¹ï¼Œå†…å®¹åˆ†äº†ç»„ï¼ˆå¯¹è±¡ï¼‰</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›å®é™…è¯»åˆ°çš„å¯¹è±¡ä¸ªæ•°ï¼Œå¤±è´¥è¿”å›EOF</span></span><br><span class="line"><span class="comment">//ptrï¼šè¦æŠŠè¯»åˆ°å†…å®¹æ”¾åœ¨å“ªä¸ªç¼“å†²åŒº</span></span><br><span class="line"><span class="comment">//sizeï¼šæ¯ä¸ªå¯¹è±¡çš„å­—èŠ‚å¤§å°</span></span><br><span class="line"><span class="comment">//nmembï¼šé¢„è®¡è¦è¯»å¤šå°‘ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="comment">///streamï¼šè¦è¯»çš„æµ</span></span><br><span class="line"><span class="comment">//æ³¨ï¼šsize * nmembä¸èƒ½è¶…è¿‡ç¼“å†²åŒº(ptr)å¤§å°</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æŒ‰å¯¹è±¡å†™-â€”-fwrite"><a href="#æŒ‰å¯¹è±¡å†™-â€”-fwrite" class="headerlink" title="æŒ‰å¯¹è±¡å†™ â€” fwrite()"></a>æŒ‰å¯¹è±¡å†™ â€” fwrite()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">fwrite</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *ptr, <span class="type">size_t</span> size, <span class="type">size_t</span> nmemb,FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šæŠŠç¼“å†²åŒºçš„å†…å®¹å†™å…¥åˆ°æµé‡Œé¢</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›å®é™…å†™å…¥çš„å¯¹è±¡ä¸ªæ•°ï¼Œå¤±è´¥è¿”å›EOF</span></span><br><span class="line">/ptrï¼šè¦å†™å…¥çš„æ•°æ®æ‰€åœ¨çš„ç¼“å†²åŒº</span><br><span class="line"><span class="comment">//sizeï¼šæ¯ä¸ªå¯¹è±¡çš„å­—èŠ‚å¤§å°</span></span><br><span class="line"><span class="comment">//nmembï¼šé¢„è®¡è¦å†™å…¥çš„å¯¹è±¡ä¸ªæ•°</span></span><br><span class="line"><span class="comment">///streamï¼šè¦å†™å…¥çš„æµ</span></span><br></pre></td></tr></tbody></table></figure><h4 id="é‡å®šå‘-â€”-freopen"><a href="#é‡å®šå‘-â€”-freopen" class="headerlink" title="é‡å®šå‘ â€” freopen()"></a>é‡å®šå‘ â€” freopen()</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">FILE *<span class="title function_">freopen</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">const</span> <span class="type">char</span> *mode, FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶ä¸”ä¼šäº§ç”Ÿä¸€ä¸ªæµï¼Œstreamæ‰€è¡¨ç¤ºçš„æµä¼šè¢«æ›¿ä»£</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›æµæŒ‡é’ˆï¼Œå¤±è´¥è¿”å›NULL</span></span><br><span class="line"><span class="comment">//pathnameï¼šè¦æ‰“å¼€çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//modeï¼šæ‰“å¼€æ–‡ä»¶çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">//streamï¼šè¦é‡å®šå‘çš„æµ</span></span><br></pre></td></tr></tbody></table></figure><h4 id="å®šä½æµ"><a href="#å®šä½æµ" class="headerlink" title="å®šä½æµ"></a>å®šä½æµ</h4><h5 id="fseek"><a href="#fseek" class="headerlink" title="fseek"></a>fseek</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fseek</span><span class="params">(FILE *stream, <span class="type">long</span> offset, <span class="type">int</span> whence)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šfseek()ç”¨æ¥ç§»åŠ¨æ–‡ä»¶æµçš„è¯»å†™ä½ç½®ã€‚å‚æ•°streamä¸ºå·²æ‰“å¼€çš„æ–‡ä»¶æŒ‡é’ˆ, å‚æ•°offsetä¸ºæ ¹æ®å‚æ•°whenceæ¥ç§»åŠ¨è¯»å†™ä½ç½®çš„ä½ç§»æ•°ã€‚</span></span><br><span class="line"><span class="comment">//å‚æ•°ï¼š</span></span><br><span class="line">whenceä¸ºä¸‹åˆ—å…¶ä¸­ä¸€ç§:</span><br><span class="line">   SEEK_SETï¼šæ–‡ä»¶å¼€å¤´</span><br><span class="line">              The offset is <span class="built_in">set</span> to offset bytes.</span><br><span class="line">       SEEK_CURï¼šå½“å‰ä½ç½®</span><br><span class="line">              The offset is <span class="built_in">set</span> to its current location plus offset bytes.</span><br><span class="line">       SEEK_ENDï¼šæ–‡ä»¶æœ«å°¾</span><br><span class="line">              The offset is <span class="built_in">set</span> to the size of the file plus offset bytes.</span><br><span class="line">SEEK_ENDå°†è¯»å†™ä½ç½®æŒ‡å‘æ–‡ä»¶å°¾åå†å¢åŠ offsetä¸ªä½ç§»é‡ã€‚</span><br><span class="line">å½“whenceå€¼ä¸ºSEEK_CUR æˆ–SEEK_ENDæ—¶, å‚æ•°offsetå…è®¸è´Ÿå€¼çš„å‡ºç°ã€‚</span><br><span class="line"><span class="comment">//è¿”å›å€¼</span></span><br><span class="line">        å½“è°ƒç”¨æˆåŠŸæ—¶åˆ™è¿”å›<span class="number">0</span>, è‹¥æœ‰é”™è¯¯åˆ™è¿”å›<span class="number">-1</span>, errnoä¼šå­˜æ”¾é”™è¯¯ä»£ç ã€‚</span><br></pre></td></tr></tbody></table></figure><h5 id="ftell"><a href="#ftell" class="headerlink" title="ftell"></a>ftell</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">ftell</span><span class="params">(FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šæ£€ç´¢å½“å‰å…‰æ ‡ä½ç½®</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæˆåŠŸè¿”å›ä½ç½®å€¼ï¼Œå¤±è´¥è¿”å›-1</span></span><br></pre></td></tr></tbody></table></figure><h5 id="rewind"><a href="#rewind" class="headerlink" title="rewind"></a>rewind</h5><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">rewind</span><span class="params">(FILE *stream)</span>;</span><br><span class="line"><span class="comment">//åŠŸèƒ½ï¼šè¿”å›æ–‡ä»¶çš„å¼€å¤´</span></span><br><span class="line"><span class="comment">//å’Œ(void) fseek(stream, 0L, SEEK_SET)åŠŸèƒ½ä¸€æ ·</span></span><br></pre></td></tr></tbody></table></figure><h2 id="æ–‡ä»¶IO"><a href="#æ–‡ä»¶IO" class="headerlink" title="æ–‡ä»¶IO"></a>æ–‡ä»¶IO</h2><blockquote><ul><li>ä¸å¸¦ç¼“å†²</li></ul><ol><li>ä¸å¸¦ç¼“å†²æŒ‡çš„æ˜¯æ¯ä¸ªreadå’Œwriteéƒ½è°ƒç”¨å†…æ ¸ä¸­çš„ç›¸åº”ç³»ç»Ÿè°ƒç”¨</li><li>ä¸å¸¦ç¼“å†²çš„I/Oå‡½æ•°ä¸æ˜¯ANSI Cçš„ç»„æˆéƒ¨åˆ†ï¼Œä½†æ˜¯æ˜¯POSIXå’ŒXPG3çš„ç»„æˆéƒ¨åˆ†</li><li>é€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ¥è®¿é—®æ–‡ä»¶</li></ol></blockquote><h3 id="æ–‡ä»¶æè¿°ç¬¦"><a href="#æ–‡ä»¶æè¿°ç¬¦" class="headerlink" title="æ–‡ä»¶æè¿°ç¬¦"></a>æ–‡ä»¶æè¿°ç¬¦</h3><blockquote><ol><li>æ˜¯éè´Ÿæ•´æ•°ï¼ˆå…±1024ä¸ªï¼š0-1023ï¼‰ä½†æ˜¯0ã€1ã€2è¢«ç³»ç»Ÿå ç”¨ï¼Œç”¨æˆ·çš„ç¬¬ä¸€ä¸ªä»1å¼€å§‹</li><li>å¯¹äºå†…æ ¸è€Œè¨€ï¼Œæ‰€æœ‰æ‰“å¼€æ–‡ä»¶éƒ½ç”±æ–‡ä»¶æè¿°ç¬¦å¼•ç”¨ã€‚å½“æ‰“å¼€ä¸€ä¸ªç°å­˜æ–‡ä»¶æˆ–åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œå†…æ ¸å‘è¿›ç¨‹è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚ 1.</li><li>æ–‡ä»¶ioï¼šç¬¦åˆå¸¸é‡: å¹»æ•°0ã€1ã€2åº”è¢«ä»£æ¢æˆç¬¦å·å¸¸æ•°STDIN_FILENOã€STDOUT_FILENOã€STDERR_FILENOã€‚è¿™äº›å¸¸æ•°éƒ½å®šä¹‰åœ¨å¤´æ–‡ä»¶&lt;unistd.h&gt;ä¸­ã€‚<ol><li>æ ‡å‡†ioæ˜¯æµï¼š 0 ï¼šstdin 1ï¼š stdout 2ï¼š stderr</li></ol></li></ol></blockquote><h3 id="open"><a href="#open" class="headerlink" title="open"></a>open</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//åŠŸèƒ½ï¼š open, creat - open and possibly create a file or device</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤´æ–‡ä»¶ï¼š</span></span><br><span class="line">       <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line">       <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line">       <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹ï¼š</span></span><br><span class="line">       <span class="type">int</span> <span class="title function_">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags)</span>; <span class="comment">//</span></span><br><span class="line">       <span class="type">int</span> <span class="title function_">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags, <span class="type">mode_t</span> mode)</span>;</span><br><span class="line"></span><br><span class="line">       <span class="type">int</span> <span class="title function_">creat</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">mode_t</span> mode)</span>;</span><br><span class="line"><span class="comment">//å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *pathnameï¼šè¢«æ‰“å¼€çš„æ–‡ä»¶åï¼ˆå¯åŒ…æ‹¬è·¯å¾„åï¼‰</span><br><span class="line">     <span class="type">int</span> flagsï¼šï¼ˆè¯»å†™ä¸‰ä¸ªå‚æ•°äº’æ–¥ï¼Œåªå…è®¸é€‰æ‹©ä¸€ä¸ªï¼‰</span><br><span class="line">            O_RDONLYï¼šåªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚ï¼šread only</span><br><span class="line">            O_WRONLY:åªå†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚ ï¼šwrite only</span><br><span class="line">            O_RDWR: å¯è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚ï¼šread write</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ä»¥ä¸‹å‚æ•°å’Œè¯»å†™å‚æ•°å¯ä»¥ç”¨ '|' è¿æ¥ä½¿ç”¨</span></span><br><span class="line">            O_CREATï¼šå¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå¹¶ç”¨ç¬¬ä¸‰çš„å‚æ•°ä¸ºå…¶è®¾ç½®æƒé™ã€‚</span><br><span class="line">            O_EXCLï¼šå¦‚æœä½¿ç”¨O_CREATæ—¶æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™å¯è¿”å›é”™è¯¯æ¶ˆæ¯ã€‚è¿™ä¸€å‚æ•°å¯æµ‹è¯•æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</span><br><span class="line">            O_NOCTTYï¼šä½¿ç”¨æœ¬å‚æ•°æ—¶ï¼Œå¦‚æ–‡ä»¶ä¸ºç»ˆç«¯ï¼Œé‚£ä¹ˆç»ˆç«¯ä¸å¯ä»¥ä½œä¸ºè°ƒç”¨open()ç³»ç»Ÿè°ƒç”¨çš„é‚£ä¸ªè¿›ç¨‹çš„æ§åˆ¶ç»ˆç«¯</span><br><span class="line">             O_APPENDï¼šä»¥æ·»åŠ æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œæ‰€ä»¥å¯¹æ–‡ä»¶çš„å†™æ“ä½œéƒ½åœ¨æ–‡ä»¶çš„æœ«å°¾è¿›è¡Œã€‚</span><br><span class="line">            O_TRUNCï¼šå¦‚æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆæ‰“å¼€æ–‡ä»¶æ—¶å…ˆåˆ é™¤æ–‡ä»¶ä¸­åŸæœ‰æ•°æ®ã€‚ï¼ˆæˆªæ–­å¼æ‰“å¼€ï¼šå¦‚æœæ–‡ä»¶æœ‰å†…å®¹ï¼Œå…ˆæ¸…ç©ºæ–‡ä»¶å†…å®¹ï¼Œå†æ‰“å¼€ï¼‰</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mode_t modeï¼šæ–‡ä»¶æƒé™ï¼ˆåªæœ‰ç”¨åˆ°O_CREAT åˆ›å»ºæ–‡ä»¶çš„æ—¶å€™æ‰æœ‰ç”¨ï¼‰</span></span><br><span class="line">            <span class="number">0777</span></span><br><span class="line">            <span class="number">0664</span></span><br><span class="line">    <span class="comment">//è¿”å›å€¼ï¼š</span></span><br><span class="line">            æˆåŠŸï¼šè¿”å›å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">            å¤±è´¥ï¼š<span class="number">-1</span></span><br></pre></td></tr></tbody></table></figure><h3 id="close"><a href="#close" class="headerlink" title="close"></a>close</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//åŠŸèƒ½ï¼šclose - close a file descriptor</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤´æ–‡ä»¶ï¼š</span></span><br><span class="line">       <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹ï¼š</span></span><br><span class="line">       <span class="type">int</span> <span class="title function_">close</span><span class="params">(<span class="type">int</span> fd)</span>;</span><br><span class="line"><span class="comment">//å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line">     <span class="type">int</span> fd:å·²ç»æ‰“å¼€çš„è¦å…³é—­çš„æ–‡ä»¶  </span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼š </span></span><br><span class="line">        æˆåŠŸï¼š<span class="number">0</span></span><br><span class="line">        å¤±è´¥ï¼š<span class="number">-1</span> å¹¶è®¾ç½®é”™è¯¯ç ï¼ˆerrnoï¼‰</span><br></pre></td></tr></tbody></table></figure><h3 id="read"><a href="#read" class="headerlink" title="read"></a>read</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//åŠŸèƒ½ï¼š</span></span><br><span class="line">read - read from a file descriptor</span><br><span class="line"><span class="comment">//å¤´æ–‡ä»¶ï¼š</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹ï¼š</span></span><br><span class="line">       <span class="type">ssize_t</span> <span class="title function_">read</span><span class="params">(<span class="type">int</span> fd, <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br><span class="line"><span class="comment">//å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="type">int</span> fd:å·²ç»æ‰“å¼€çš„å¯è¯»æ–‡ä»¶</span><br><span class="line">   <span class="type">void</span> *bufï¼šç”¨äºä¿å­˜è¯»å–åˆ°çš„æ•°æ®</span><br><span class="line">    <span class="type">size_t</span> countï¼šæ¯æ¬¡è¯»å–çš„å­—èŠ‚æ•° </span><br><span class="line"> <span class="comment">//è¿”å›å€¼ï¼š</span></span><br><span class="line">        <span class="number">-1</span>ï¼šå¤±è´¥</span><br><span class="line">        <span class="number">0</span>ï¼šè¯»å–åˆ°æ–‡ä»¶æœ«å°¾æˆ–æ–‡ä»¶ä¸ºç©ºï¼ˆåœ¨ç½‘ç»œé€šä¿¡é‡Œé¢è¡¨ç¤ºå®¢æˆ·ç«¯é€€å‡ºï¼‰</span><br><span class="line">        å¤§äº<span class="number">0</span>ï¼šæˆåŠŸè¯»å–åˆ°æ•°æ®</span><br></pre></td></tr></tbody></table></figure><h3 id="write"><a href="#write" class="headerlink" title="write"></a>write</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//åŠŸèƒ½ï¼š</span></span><br><span class="line">write - write to a file descriptor</span><br><span class="line"><span class="comment">//å¤´æ–‡ä»¶ï¼š</span></span><br><span class="line">       <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹ï¼š</span></span><br><span class="line">       <span class="type">ssize_t</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br><span class="line"><span class="comment">//å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="type">int</span> fd:å·²ç»æ‰“å¼€çš„å¯å†™æ–‡ä»¶</span><br><span class="line">   <span class="type">const</span> <span class="type">void</span> *bufï¼šç”¨äºä¿å­˜è¯»å–åˆ°çš„æ•°æ®</span><br><span class="line">    <span class="type">size_t</span> countï¼šæ¯æ¬¡è¯»å–çš„å­—èŠ‚æ•° </span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼š</span></span><br><span class="line">        <span class="number">-1</span>ï¼šå¤±è´¥</span><br><span class="line">       </span><br><span class="line">        å¤§äº<span class="number">0</span>ï¼šæˆåŠŸå†™å…¥çš„æ•°æ®</span><br></pre></td></tr></tbody></table></figure><h3 id="lseek"><a href="#lseek" class="headerlink" title="lseek"></a>lseek</h3><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//åŠŸèƒ½ï¼šlseek - reposition read/write file offset</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤´æ–‡ä»¶ï¼š</span></span><br><span class="line">       <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line">       <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹ï¼š</span></span><br><span class="line">       <span class="type">off_t</span> <span class="title function_">lseek</span><span class="params">(<span class="type">int</span> fd, <span class="type">off_t</span> offset, <span class="type">int</span> whence)</span>;</span><br><span class="line"><span class="comment">//å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="type">int</span> fdï¼š æ“ä½œçš„æ–‡ä»¶</span><br><span class="line">    <span class="type">off_t</span> offset:åç§»é‡       ï¼ˆ+n  å‘ååç§»   -n  å‘å‰åç§»   <span class="number">0</span>  ä¸åç§»ï¼‰</span><br><span class="line">    <span class="type">int</span> whenceï¼šå‚è€ƒçš„åŸºå‡†ä½ç½® </span><br><span class="line">       SEEK_SETï¼šæ–‡ä»¶å¼€å¤´</span><br><span class="line">              The offset is <span class="built_in">set</span> to offset bytes.</span><br><span class="line">       SEEK_CURï¼šå½“å‰ä½ç½®</span><br><span class="line">              The offset is <span class="built_in">set</span> to its current location plus offset bytes.</span><br><span class="line">       SEEK_ENDï¼šæ–‡ä»¶æœ«å°¾</span><br><span class="line">              The offset is <span class="built_in">set</span> to the size of the file plus offset bytes.</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼š</span></span><br><span class="line">        æ–‡ä»¶çš„å½“å‰å…‰æ ‡ä½ç½®ï¼ˆæŒ‰å­—èŠ‚æ•°è®¡ç®—ï¼‰</span><br></pre></td></tr></tbody></table></figure><p>æ ‡å‡†IOå’Œæ–‡ä»¶IOçš„åŒºåˆ«ï¼š</p><blockquote><ul><li>æ ‡å‡†IOæ˜¯cåº“å‡½æ•°ï¼Œæ–‡ä»¶IOæ˜¯ç³»ç»Ÿè°ƒç”¨æ¥å£</li><li>æ ‡å‡†IOè‡ªå¸¦ç¼“å†²åŒºï¼Œæ–‡ä»¶IOæ²¡æœ‰ç¼“å†²</li><li>æ ‡å‡†IOçš„å®ç°è¿˜æ˜¯è¦ä¾èµ–æ–‡ä»¶IO</li></ul></blockquote><table><thead><tr><th align="left"></th><th align="left">æ–‡ä»¶io</th><th align="left">æ ‡å‡†io</th></tr></thead><tbody><tr><td align="left">ç¼“å†²</td><td align="left">æ— </td><td align="left">æœ‰</td></tr><tr><td align="left">é«˜ä½çº§</td><td align="left">linuxç³»ç»Ÿioã€ä½çº§io</td><td align="left">é«˜çº§io</td></tr><tr><td align="left">æ“ä½œå¯¹è±¡</td><td align="left">æ–‡ä»¶æè¿°ç¬¦</td><td align="left">æµ</td></tr><tr><td align="left">èƒ½å¦æ‰“å¼€è®¾å¤‡æ–‡ä»¶</td><td align="left">å¯ä»¥</td><td align="left">ä¸å¯ä»¥</td></tr><tr><td align="left">API</td><td align="left">open close read write sleek</td><td align="left">fopen fclose fread fwrite fseek</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> IO </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cè¯­è¨€ </tag>
            
            <tag> IO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„</title>
      <link href="/2023/03/21/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
      <url>/2023/03/21/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> é˜Ÿåˆ— </tag>
            
            <tag> äºŒå‰æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shell</title>
      <link href="/2023/03/20/shell/"/>
      <url>/2023/03/20/shell/</url>
      
        <content type="html"><![CDATA[<h1 id="star-shellè„šæœ¬"><a href="#star-shellè„šæœ¬" class="headerlink" title=":star:shellè„šæœ¬"></a><span class="github-emoji"><span>â­</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>shellè„šæœ¬</h1><h2 id="æœ¬è´¨ï¼šshellå‘½ä»¤çš„æœ‰åºé›†åˆ"><a href="#æœ¬è´¨ï¼šshellå‘½ä»¤çš„æœ‰åºé›†åˆ" class="headerlink" title="æœ¬è´¨ï¼šshellå‘½ä»¤çš„æœ‰åºé›†åˆ"></a>æœ¬è´¨ï¼šshellå‘½ä»¤çš„æœ‰åºé›†åˆ</h2><ol><li><p>bashè§£é‡Šå™¨</p><ul><li>ä½œç”¨ï¼šæŒ‡å‘.shè„šæœ¬</li></ul></li><li><p>ç¼–å†™shellè„šæœ¬</p><ol><li>åˆ›å»ºä¸€ä¸ª.shçš„æ–‡ä»¶</li><li>å†™shellå‘½ä»¤</li><li>æ‰§è¡Œ<ul><li>é€šè¿‡bashè¿™ä¸ªè§£é‡Šå™¨æ¥æ‰§è¡Œ</li><li>é€šè¿‡./æ¥æ‰§è¡Œï¼Œä½†æ˜¯éœ€è¦æœ‰æ‰§è¡Œæƒé™ï¼Œä½¿ç”¨chmodæ¥ç»™æ–‡ä»¶ææƒç¤ºä¾‹</li></ul></li></ol><p>ç¤ºä¾‹</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash    //ç¬¬ä¸€è¡Œä¸€èˆ¬éƒ½è¿™æ ·å†™,è¡¨ç¤ºè§£é‡Šå™¨çš„è·¯å¾„</span></span><br><span class="line"><span class="built_in">cp</span> ../1.c 1.c</span><br><span class="line"><span class="built_in">cp</span> ../2.c 2.c</span><br><span class="line"> 1.c Hello world</span><br></pre></td></tr></tbody></table></figure></li></ol><p>shellä¸­0è¡¨ç¤ºçœŸï¼Œ1è¡¨ç¤ºå‡</p><h2 id="shellçš„ç‰¹æ®Šå­—ç¬¦"><a href="#shellçš„ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="shellçš„ç‰¹æ®Šå­—ç¬¦"></a>shellçš„ç‰¹æ®Šå­—ç¬¦</h2><ol><li><p><code>|</code></p><ul><li>ä½œç”¨ï¼šç®¡é“</li><li>ç¤ºä¾‹<ul><li>forune | lolcat</li></ul></li></ul></li><li><p>`  `<br>ä½œç”¨ï¼šå‘½ä»¤ç½®æ¢ï¼š<br>ç¤ºä¾‹ï¼š</p> <figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> `<span class="built_in">ls</span>`    <span class="comment">#echo åœ¨ç»ˆç«¯æ˜¾ç¤º)</span></span><br></pre></td></tr></tbody></table></figure></li></ol><p>   <img src="https://typora-1304577690.cos.ap-chengdu.myqcloud.com/image-20230314144510596.png"></p><ol start="3"><li><p>&gt;&gt;<br>è¾“å‡ºé‡å®šå‘</p><p>â€‹&gt; è¦†ç›–è¾“å…¥<br>â€‹&gt;&gt; æœ€ä½³è¾“å…¥<br>â€‹ç¤ºä¾‹ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> Hello world  1.c</span><br></pre></td></tr></tbody></table></figure></li><li><p><strong>é€šé…ç¬¦</strong></p><ul><li>*ï¼šåŒ¹é…æ‰€æœ‰å­—ç¬¦</li><li>{èµ·å§‹..ç»“æŸ}   åˆ›å»ºè¿ç»­çš„æ–‡ä»¶</li><li>[ ]<ul><li>rm [13579].c åˆ é™¤äº†1.c 2.c 3.c 4.c 5.c</li><li>rm [1-5].c    åˆ é™¤äº†1-5.c</li></ul></li><li>ï¼Ÿï¼šåŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²</li><li>[^]ï¼šåˆ é™¤é™¤äº†æŒ‡å®šçš„æ–‡ä»¶ï¼Œåªèƒ½é€šé…ä¸€ä¸ª</li></ul></li></ol><h2 id="shellå˜é‡"><a href="#shellå˜é‡" class="headerlink" title="shellå˜é‡"></a><strong>shellå˜é‡</strong></h2><ol><li><p>è‡ªå®šä¹‰å˜é‡</p><ul><li><p>æ²¡æœ‰æ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¸ºå­—ç¬¦ä¸²ç±»å‹</p></li><li><p>èµ‹å€¼ä¸èƒ½éš”å¼€</p></li><li><p>å˜é‡å=å€¼</p></li><li><p>æ²¡æœ‰åˆ†å·ï¼Œæ¢è¡Œç›¸å½“äºåˆ†å·</p></li><li><p>å˜é‡çš„è°ƒç”¨éœ€è¦åŠ $</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a=2</span><br><span class="line">echo $a</span><br></pre></td></tr></tbody></table></figure></li></ul></li><li><p>ä½ç½®å˜é‡</p><ul><li>å‘½ä»¤è¡Œå‚æ•°çš„å˜é‡ï¼Œä»ç»ˆç«¯ä¼ é€’å‚æ•°ç»™shellè„šæœ¬</li><li>ä»$0å¼€å§‹åˆ°$9å¦‚æœè¦æ‰“å°9ä»¥åçš„å˜é‡éœ€è¦åŠ { }ï¼Œä¾‹å¦‚${12}</li></ul></li><li><p>ç¯å¢ƒå˜é‡</p><ul><li>è®¡ç®—æœºå®šä¹‰å¥½çš„å˜é‡</li><li>envå¯ä»¥æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡</li><li>è°ƒç”¨éœ€è¦åŠ $</li></ul></li><li><p>é¢„å®šä¹‰å˜é‡</p><ul><li><p>è®¡ç®—æœºç»™å‡ºä¸€äº›ç‰¹æ®Šå˜é‡èµ‹äºˆç‰¹æ®Šæ„ä¹‰</p></li><li><p><strong>æ ¼å¼</strong></p><table><thead><tr><th align="left"></th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">$#</td><td align="left">ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•°</td></tr><tr><td align="left">$*</td><td align="left">ä»¥ä¸€ä¸ªå•å­—ç¬¦ä¸²æ˜¾ç¤ºæ‰€æœ‰å‘è„šæœ¬ä¼ é€’çš„å‚æ•°ã€‚ å¦‚â€$*â€ç”¨ã€Œâ€ã€æ‹¬èµ·æ¥çš„æƒ…å†µã€ä»¥â€$1 $2 â€¦ $nâ€çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</td></tr><tr><td align="left">$$</td><td align="left">è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹IDå·</td></tr><tr><td align="left">$!</td><td align="left">åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„IDå·</td></tr><tr><td align="left">$@</td><td align="left">ä¸$*ç›¸åŒï¼Œä½†æ˜¯ä½¿ç”¨æ—¶åŠ å¼•å·ï¼Œå¹¶åœ¨å¼•å·ä¸­è¿”å›æ¯ä¸ªå‚æ•°ã€‚ å¦‚â€$@â€ç”¨ã€Œâ€ã€æ‹¬èµ·æ¥çš„æƒ…å†µã€ä»¥â€$1â€ â€œ$2â€ â€¦ â€œ$nâ€ çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</td></tr><tr><td align="left">$-</td><td align="left">æ˜¾ç¤ºShellä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼Œä¸setå‘½ä»¤åŠŸèƒ½ç›¸åŒã€‚</td></tr><tr><td align="left">$?</td><td align="left">æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–ä»»ä½•å€¼è¡¨æ˜æœ‰é”™è¯¯ã€‚</td></tr></tbody></table></li></ul></li></ol><h2 id="å˜é‡çš„å››åˆ™è¿ç®—"><a href="#å˜é‡çš„å››åˆ™è¿ç®—" class="headerlink" title="å˜é‡çš„å››åˆ™è¿ç®—"></a>å˜é‡çš„å››åˆ™è¿ç®—</h2><ol><li><p>$( () )</p><ul><li>ä¸èƒ½è¿›è¡Œæµ®ç‚¹è¿ç®—</li><li>è°ƒç”¨çš„æ—¶å€™è¦åŠ é’±$</li><li>å¯ä»¥è¿›è¡Œå¹‚æ•°è¿ç®—</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a=$((3**3))</span><br><span class="line">echo $a </span><br><span class="line">ç»“æœä¸º27</span><br></pre></td></tr></tbody></table></figure></li><li><p>$[ ]</p><ul><li>ä¸èƒ½è¿›è¡Œæµ®ç‚¹è¿ç®—</li><li>è°ƒç”¨çš„æ—¶å€™è¦åŠ é’±$</li><li>å¯ä»¥è¿›è¡Œå¹‚æ•°è¿ç®—</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a=$[ 3+3]</span><br><span class="line">echo $a </span><br><span class="line">ç»“æœä¸º6</span><br></pre></td></tr></tbody></table></figure></li><li><p>expr</p><ul><li>éœ€è¦å‘½ä»¤ç½®æ¢ç¬¦ç½®æ¢å‡ºæ¥ç»“æœ</li><li>ç®—æ•°ä¹‹é—´éœ€è¦ç©ºå¼€</li><li>å½“è¿›è¡Œä¹˜æ³•çš„æ—¶å€™éœ€è¦ç”¨\åŒºåˆ†,å…¶ä»–éƒ½ä¸éœ€è¦</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a='expr 1 \* 2'</span><br><span class="line">a='expr 1\*2'//æŠ¥é”™ éœ€è¦ç©ºå¼€</span><br><span class="line">echo $a </span><br><span class="line">ç»“æœä¸º2</span><br></pre></td></tr></tbody></table></figure></li><li><p>ç»ƒä¹ </p><ul><li>äº¤æ¢a,bçš„å€¼</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">a=$[ 3 * 3 * 3]</span><br><span class="line">b=$((5*7))</span><br><span class="line">c=$a</span><br><span class="line">a=$b</span><br><span class="line">b=$c</span><br><span class="line">echo  a=$a b=$b  1.txt</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li></ol><h2 id="Shellè¯­å¥"><a href="#Shellè¯­å¥" class="headerlink" title="Shellè¯­å¥"></a>Shellè¯­å¥</h2><ul><li><h3 id="å­—ç¬¦ä¸²æ¯”è¾ƒ"><a href="#å­—ç¬¦ä¸²æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦ä¸²æ¯”è¾ƒ"></a>å­—ç¬¦ä¸²æ¯”è¾ƒ</h3><ul><li>test å­—ç¬¦ä¸²1 = å­—ç¬¦ä¸²2 â€”- æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰</li><li>test å­—ç¬¦ä¸²1 != å­—ç¬¦ä¸²2 â€”- æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ç›¸ç­‰</li><li>test -z å­—ç¬¦ä¸² â€”- åˆ¤æ–­å­—ç¬¦ä¸²ä¸ºä¸ä¸ºç©º</li><li>test -n å­—ç¬¦ä¸² â€”- åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºä¸ç©º</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a="hello"</span><br><span class="line">b="hello"</span><br><span class="line">test $a != $b</span><br><span class="line">test -z $a</span><br><span class="line">test -n $a</span><br><span class="line">echo $?  //ï¼Ÿè¡¨ç¤ºä¸Šä¸€ä¸ªç»“æœ</span><br></pre></td></tr></tbody></table></figure></li><li><h3 id="æ•´æ•°æ¯”è¾ƒ"><a href="#æ•´æ•°æ¯”è¾ƒ" class="headerlink" title="æ•´æ•°æ¯”è¾ƒ"></a>æ•´æ•°æ¯”è¾ƒ</h3><ul><li>-eq â€”- ç­‰äº</li><li>-ne â€”- ä¸ç­‰äº</li><li>-gt â€”- å¤§äº</li><li>-lt â€”- å°äº</li><li>-ge â€”- å¤§äºç­‰äº</li><li>-le â€”- å°äºç­‰äº</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">test 23 -eq 32</span><br><span class="line">echo $?  #ï¼Ÿè¡¨ç¤ºä¸Šä¸€ä¸ªç»“æœ</span><br><span class="line">ç»“æœ 1    #shellä¸­1è¡¨ç¤ºå‡ï¼Œ0è¡¨ç¤ºçœŸ</span><br></pre></td></tr></tbody></table></figure></li><li><h3 id="æ–‡ä»¶æ¯”è¾ƒ"><a href="#æ–‡ä»¶æ¯”è¾ƒ" class="headerlink" title="æ–‡ä»¶æ¯”è¾ƒ"></a>æ–‡ä»¶æ¯”è¾ƒ</h3><ul><li>-e æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li><li>-f æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºæ™®é€šæ–‡ä»¶</li><li>-L æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºé“¾æ¥æ–‡ä»¶</li><li>-S æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºå¥—æ¥å­—æ–‡ä»¶</li><li>-b æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºå—æ–‡ä»¶</li><li>-c æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºå­—ç¬¦æ–‡ä»¶</li><li>-d æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºç›®å½•æ–‡ä»¶</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">test -d $1 #$1è¡¨ç¤ºä»å‘½ä»¤è¡Œå»è·å–å‚æ•°</span><br><span class="line">echo $?  #ï¼Ÿè¡¨ç¤ºä¸Šä¸€ä¸ªç»“æœ</span><br></pre></td></tr></tbody></table></figure><ul><li><p>-p æ–‡ä»¶ â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºç®¡é“æ–‡ä»¶</p></li><li><p>æ–‡ä»¶1 -nt æ–‡ä»¶2 â€”- åˆ¤æ–­æ–‡ä»¶1æ˜¯å¦æ¯”æ–‡ä»¶2æ–°ï¼ˆæ—¶é—´æˆ³ï¼‰</p></li><li><p>æ–‡ä»¶1 -ot æ–‡ä»¶2 â€”- åˆ¤æ–­æ–‡ä»¶1æ˜¯å¦æ¯”æ–‡ä»¶2æ—§ï¼ˆæ—¶é—´æˆ³ï¼‰</p></li><li><p>-o â€”- æˆ– or</p></li><li><p>-a â€”- ä¸ andæ–‡ä»¶æƒé™</p></li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">test -d $1 -o -f $2 #$1 $2è¡¨ç¤ºä»å‘½ä»¤è¡Œå»è·å–å‚æ•°</span><br><span class="line">echo $?  #ï¼Ÿè¡¨ç¤ºä¸Šä¸€ä¸ªç»“æœ</span><br></pre></td></tr></tbody></table></figure><ul><li>-r â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æœ‰å¯è¯»å†™æƒé™</li><li>-w â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æœ‰å¯å†™æƒé™</li><li>-x â€”- åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æœ‰å¯æ‰§è¡Œæƒé™</li></ul></li><li><h3 id="read-â€”â€“-æŠŠç»ˆç«¯ä¸Šçš„è¾“å…¥ä¼ ç»™å‚æ•°"><a href="#read-â€”â€“-æŠŠç»ˆç«¯ä¸Šçš„è¾“å…¥ä¼ ç»™å‚æ•°" class="headerlink" title="read â€”â€“ æŠŠç»ˆç«¯ä¸Šçš„è¾“å…¥ä¼ ç»™å‚æ•°"></a>read â€”â€“ æŠŠç»ˆç«¯ä¸Šçš„è¾“å…¥ä¼ ç»™å‚æ•°</h3><ul><li>ç”¨æ³• ï¼šread å˜é‡1 å˜é‡2 â€¦</li><li>å‚æ•°ï¼š<ul><li>read -p â€œæç¤ºâ€ å˜é‡å â€”- ç»™å‡ºæç¤º</li><li>read -t æ—¶é—´(ç§’) å˜é‡å â€”- è¶…è¿‡æ—¶é—´è‡ªåŠ¨åœæ­¢</li><li>read -n æ•°å­— å˜é‡å â€”- æ˜¾ç¤ºè¾“å…¥çš„ä¸ªæ•°ï¼Œè¶…å‡ºä¸ªæ•°ä¹Ÿä¼šè‡ªåŠ¨ç»“æŸ</li><li>read -s â€”- éšè—è¾“å…¥ï¼Œä¸æ˜¾ç¤º</li></ul></li></ul></li></ul><h3 id="æ§åˆ¶è¯­å¥"><a href="#æ§åˆ¶è¯­å¥" class="headerlink" title="æ§åˆ¶è¯­å¥"></a>æ§åˆ¶è¯­å¥</h3><h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><ul><li>ç¬¬ä¸€ç§</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">if []</span><br><span class="line">then</span><br><span class="line">    shell è¯­å¥;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ³¨æ„ <span class="keyword">if</span> å’Œ[]ä¸­éœ€è¦åŠ ç©ºæ ¼</span></span><br></pre></td></tr></tbody></table></figure><ul><li>ç¬¬äºŒç§</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">if testè¯­å¥</span><br><span class="line">then</span><br><span class="line">    shell è¯­å¥;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ³¨æ„ <span class="keyword">if</span> å’Œ[]ä¸­éœ€è¦åŠ ç©ºæ ¼</span></span><br></pre></td></tr></tbody></table></figure><h4 id="if-elif-else"><a href="#if-elif-else" class="headerlink" title="if -elif -else"></a>if -elif -else</h4><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">read a</span><br><span class="line">if test -e $a</span><br><span class="line">then</span><br><span class="line">    if test -w $a</span><br><span class="line">    then </span><br><span class="line">        echo "hello World"  $a</span><br><span class="line">    else</span><br><span class="line">        chmod u+w $a</span><br><span class="line">        echo "hello World"  $a</span><br><span class="line">    fi</span><br><span class="line">else</span><br><span class="line">    touch $a</span><br><span class="line">    chmod u+w $a </span><br><span class="line">    echo "hello World"  $a</span><br><span class="line">fi</span><br></pre></td></tr></tbody></table></figure><h4 id="case"><a href="#case" class="headerlink" title="case"></a>case</h4><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"> case è¡¨è¾¾å¼ in</span><br><span class="line">     å€¼1)</span><br><span class="line">         è¯­å¥1</span><br><span class="line">     ;;</span><br><span class="line">     å€¼2)</span><br><span class="line">         è¯­å¥2</span><br><span class="line">     ;;</span><br><span class="line">     .</span><br><span class="line">     .</span><br><span class="line">     .</span><br><span class="line">     *)</span><br><span class="line">         è¯­å¥n</span><br><span class="line"> esac</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  #</span><span class="language-bash">åŒæ—¶å¯ä»¥åœ¨å€¼ä¸­ä½¿ç”¨|ã€[]æ¥åŒ¹é…å¤šç§å€¼</span></span><br><span class="line">read day       </span><br><span class="line"> case $day in</span><br><span class="line">     1|5|7)</span><br><span class="line">         echo "å•æ•°æ—¥"</span><br><span class="line">     ;;</span><br><span class="line">     [2-4])</span><br><span class="line">        echo "ä¸­é—´ä¸¤å¤©"</span><br><span class="line">     ;;</span><br><span class="line">     *)</span><br><span class="line">        echo "åŒæ•°æ—¥"</span><br><span class="line"> esac</span><br></pre></td></tr></tbody></table></figure><h4 id="while"><a href="#while" class="headerlink" title="while"></a>while</h4><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> è¡¨è¾¾å¼</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    shellè¯­å¥</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">((a--)) ---è¡¨ç¤ºè‡ªå‡</span><br><span class="line"><span class="comment">#ç¤ºä¾‹</span></span><br><span class="line"><span class="comment">#!/bin/bash   </span></span><br><span class="line">  a=5</span><br><span class="line">  <span class="keyword">while</span> <span class="built_in">test</span> <span class="variable">$a</span> -gt 0</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">      ((a--))</span><br><span class="line">      <span class="built_in">echo</span> <span class="variable">$a</span></span><br><span class="line">  <span class="keyword">done</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">while true</span><br><span class="line">do</span><br><span class="line">    shellè¯­å¥</span><br><span class="line">done</span><br></pre></td></tr></tbody></table></figure><h4 id="for"><a href="#for" class="headerlink" title="for"></a>for</h4><ul><li><p>æ–¹å¼ä¸€</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>((è¡¨è¾¾å¼<span class="number">1</span>ï¼›è¡¨è¾¾å¼<span class="number">2</span>ï¼›è¡¨è¾¾å¼<span class="number">3</span>))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    shellè¯­å¥</span><br><span class="line"></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#ç¤ºä¾‹</span></span><br><span class="line"><span class="comment">#!/bin/bash </span></span><br><span class="line">i=5</span><br><span class="line"><span class="keyword">for</span>((i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>æ–¹å¼äºŒ</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">for å˜é‡ in å•è¯è¡¨</span><br><span class="line">do</span><br><span class="line">    shellè¯­å¥</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç¤ºä¾‹</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">i=5</span><br><span class="line">for i in he li oi asda adsa ada ad</span><br><span class="line">do</span><br><span class="line">    echo $i</span><br><span class="line">done</span><br></pre></td></tr></tbody></table></figure></li><li><p>æ–¹å¼ä¸‰â€”-è¿ç»­çš„</p><ul><li>for å˜é‡ in {èµ·å§‹..ç»“æŸ}</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">i=5</span><br><span class="line">for i in {a..z}</span><br><span class="line">do</span><br><span class="line">    echo $i</span><br><span class="line">done</span><br><span class="line">   </span><br></pre></td></tr></tbody></table></figure><ul><li>for å˜é‡ in</li></ul><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">i=5</span><br><span class="line">for i in `ls`</span><br><span class="line">do</span><br><span class="line">   echo $i</span><br><span class="line">done</span><br><span class="line">   </span><br></pre></td></tr></tbody></table></figure></li></ul><h2 id="shellæ•°ç»„"><a href="#shellæ•°ç»„" class="headerlink" title="shellæ•°ç»„"></a>shellæ•°ç»„</h2><ul><li><p>shellè„šæœ¬ä¸­åªæœ‰ä¸€ç»´æ•°ç»„</p></li><li><p>æ²¡æœ‰æ•°æ®ç±»å‹</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#å£°æ˜ ï¼šæ•°ç»„å=(å…ƒç´ 1 å…ƒç´ 2 å…ƒç´ 3...)</span></span><br><span class="line">arr=(hello world nihao shijie)</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">${arr[0]}</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>éå†æ•°ç»„</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">arr=(hello world nihao shijie)</span><br><span class="line">echo ${arr[*]}</span><br><span class="line">echo ${arr[@]}</span><br></pre></td></tr></tbody></table></figure></li><li><p>æ±‚æ•°ç»„çš„é•¿åº¦</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line">arr=(hello world nihao shijie)</span><br><span class="line">echo ${#arr[*]}</span><br><span class="line">ç»“æœæ˜¯4</span><br></pre></td></tr></tbody></table></figure></li><li><p>ç»ƒä¹ â€”-  äº¤æ¢æ•°ç»„</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">arr=(hello world chengdu sichuan asss)</span><br><span class="line">right=$[${#arr[*]} - 1]</span><br><span class="line">left=0</span><br><span class="line">temp=0</span><br><span class="line">while (test ${left} -le ${right})</span><br><span class="line">do</span><br><span class="line">    temp=${arr[left]}</span><br><span class="line">    arr[left]=${arr[right]}</span><br><span class="line">    arr[right]=$temp</span><br><span class="line">    ((left++))</span><br><span class="line">    ((right--))</span><br><span class="line">done</span><br><span class="line">echo ${arr[*]}</span><br></pre></td></tr></tbody></table></figure><p>ç»ƒä¹ ï¼šæ±‚1åˆ°100çš„å’Œ</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_"> #</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">sum=0</span><br><span class="line">i=5</span><br><span class="line">for((i=0;i&lt;101;i++))</span><br><span class="line">do</span><br><span class="line">     sum=$(($sum+$i))</span><br><span class="line">done</span><br><span class="line">echo "sum=$sum"</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span> </span><br><span class="line">sum=0</span><br><span class="line">i=5</span><br><span class="line">for((i=0;i&lt;101;i++))</span><br><span class="line">do</span><br><span class="line">    sum=`expr $sum + $i`</span><br><span class="line">done</span><br><span class="line">echo "sum=$sum"</span><br></pre></td></tr></tbody></table></figure></li></ul><h2 id="shell-å‡½æ•°"><a href="#shell-å‡½æ•°" class="headerlink" title="shell å‡½æ•°"></a>shell å‡½æ•°</h2><ul><li><p>æ²¡æœ‰æ•°æ®ç±»å‹</p></li><li><p>æ²¡æœ‰å†™å½¢å‚ï¼Œä½†æ˜¯å¯ä»¥ä¼ å‚</p></li><li><p>åªæœ‰è°ƒç”¨å‡½æ•°åï¼Œé‡Œé¢çš„ä¸œè¥¿æ‰ä¼šç”Ÿæ•ˆ</p></li><li><p>å®šä¹‰ï¼š</p><figure class="highlight shell"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç¬¬ä¸€ç§</span></span><br><span class="line">funtion å‡½æ•°å()</span><br><span class="line">{</span><br><span class="line">    return è¿”å›å€¼</span><br><span class="line">}</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç¬¬äºŒç§</span></span><br><span class="line">å‡½æ•°å(){</span><br><span class="line">    return è¿”å›å€¼</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>è°ƒç”¨ï¼šç›´æ¥å‡½æ•°å</p></li><li><p>è·å–è¿”å›å€¼ ï¼š $?</p></li><li><p>å‡½æ•°çš„ä¼ å‚</p><ul><li>å‡½æ•°å å®å‚1 å®å‚2â€¦</li><li>å‡½æ•°ä½“ä¸­ç”¨$1, $2, $3â€¦${15}æ¥æ¥æ”¶</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>makefile</title>
      <link href="/2023/03/20/makefile/"/>
      <url>/2023/03/20/makefile/</url>
      
        <content type="html"><![CDATA[<h3 id="makefile"><a href="#makefile" class="headerlink" title="makefile"></a>makefile</h3><blockquote><ul><li><p>makefileæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æ”¾çš„æ˜¯ç¼–è¯‘çš„è§„åˆ™ï¼Œå¯ä»¥ç®¡ç†å¤šä¸ªæ–‡ä»¶</p></li><li><p>makeæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨æ¥è§£ææˆ‘ä»¬çš„makefile</p></li><li><p>makeä¼šæ ¹æ®æ–‡ä»¶çš„æ—¶é—´æˆ³è¿›è¡Œç¼–è¯‘ï¼Œå¦‚æœæ–‡ä»¶çš„æ—¶é—´æˆ³æ²¡æœ‰æ”¹å˜ï¼Œåˆ™ä¸ä¼šç¼–è¯‘æ–‡ä»¶</p></li><li><p>makefileçš„é€»è¾‘</p><ul><li><p>ç›®æ ‡æ–‡ä»¶:ä¾èµ–æ–‡ä»¶</p><p> (tab) ç¼–è¯‘è¯­å¥</p><p>ç›®æ ‡æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶ï¼Œè¦ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶ï¼Œä¼šå»æ‰¾ç”Ÿæˆå®ƒéœ€è¦çš„æ–‡ä»¶ï¼Œå°±å«åšä¾èµ–æ–‡ä»¶ï¼Œå¦‚æœä¾èµ–æ–‡ä»¶åˆéœ€è¦å…¶ä»–çš„æ–‡ä»¶æ¥ç”Ÿæˆï¼Œç»§ç»­æ‰¾å®ƒçš„ä¾èµ–æ–‡ä»¶ï¼Œç›´åˆ°ä¸éœ€è¦ä¸ºæ­¢</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">app:<span class="built_in">list</span>.o main.o</span><br><span class="line">    gcc  <span class="built_in">list</span>.o main.o -o app</span><br><span class="line"><span class="built_in">list</span>.o:<span class="built_in">list</span>.c</span><br><span class="line">    gcc -c <span class="built_in">list</span>.c -o <span class="built_in">list</span>.o</span><br><span class="line">main.o:main.c</span><br><span class="line">    gcc -c main.c -o main.o</span><br><span class="line">clean:</span><br><span class="line">    rm main.o <span class="built_in">list</span>.o app </span><br></pre></td></tr></tbody></table></figure><p>C</p></li><li><p>make clean åˆ é™¤ç”Ÿæˆçš„æ–‡ä»¶ï¼ˆæ‰§è¡Œcleanåé¢çš„è¯­å¥ï¼‰</p></li><li><p>æ‰§è¡Œï¼šmakeï¼Œé»˜è®¤è§£æå½“å‰ç›®å½•ä¸‹çš„makefileæˆ–è€…Makefile</p></li><li><p>é€‰é¡¹</p><ul><li><p>-f â€”- ç¼–è¯‘æŒ‡å®šçš„makefileæ–‡ä»¶</p></li><li><p>-I(å¤§å†™çš„i) â€”- è°ƒç”¨å¤–éƒ¨å¤´æ–‡ä»¶ åŠ å¤´æ–‡ä»¶çš„è·¯å¾„</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="number">1</span> app:<span class="built_in">list</span>.o main.o</span><br><span class="line">    gcc  <span class="built_in">list</span>.o main.o -I ./include -o app</span><br><span class="line"><span class="built_in">list</span>.o:<span class="built_in">list</span>.c</span><br><span class="line">    gcc -c <span class="built_in">list</span>.c -I ./include -o <span class="built_in">list</span>.o</span><br><span class="line">main.o:main.c</span><br><span class="line">    gcc -c main.c -I ./include -o main.o</span><br><span class="line">clean:</span><br><span class="line">    rm main.o <span class="built_in">list</span>.o app </span><br></pre></td></tr></tbody></table></figure><p>C</p></li></ul></li></ul></li></ul></blockquote><h3 id="makefileçš„å˜é‡"><a href="#makefileçš„å˜é‡" class="headerlink" title="makefileçš„å˜é‡"></a>makefileçš„å˜é‡</h3><blockquote><p>å˜é‡çš„èµ‹å€¼ï¼š</p><ul><li>=ï¼šç»™å½“å‰å˜é‡èµ‹å€¼ï¼Œä½†æ˜¯å¦‚æœåé¢æœ‰æ–°çš„èµ‹å€¼ï¼ŒæŠŠæ–°çš„èµ‹å€¼ç»™å˜é‡</li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">a=<span class="number">12</span></span><br><span class="line">b=$(a)</span><br><span class="line">a=<span class="number">34</span></span><br><span class="line">all:</span><br><span class="line">   @echo $(b)</span><br><span class="line">è¾“å‡º:b=<span class="number">34</span></span><br></pre></td></tr></tbody></table></figure><p>C</p><ul><li>:=â€”ç«‹å³èµ‹å€¼,å’Œå¹³æ—¶çš„èµ‹å€¼ä¸€æ ·ï¼Œåé¢æ–°çš„èµ‹å€¼ä¸ä¼šæ”¹å˜å½“å‰å€¼</li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">a=<span class="number">12</span></span><br><span class="line">b:=$(a)</span><br><span class="line">a=<span class="number">34</span></span><br><span class="line">all:</span><br><span class="line">    @echo $(b)</span><br><span class="line">è¾“å‡º:b=<span class="number">12</span></span><br></pre></td></tr></tbody></table></figure><p>C</p><ul><li>ï¼Ÿ=â€”è¯¢é—®èµ‹å€¼,è¯¢é—®å‰é¢æœ‰æ²¡æœ‰èµ‹å€¼ï¼Œå¦‚æœæœ‰ï¼Œæ­¤æ¬¡èµ‹å€¼æ— æ•ˆ</li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">a=<span class="number">12</span></span><br><span class="line">b:=$(a)</span><br><span class="line">a?=<span class="number">34</span></span><br><span class="line">all:</span><br><span class="line">    @echo $(b)</span><br><span class="line">    echo $(a)</span><br><span class="line">a=<span class="number">12</span></span><br></pre></td></tr></tbody></table></figure><p>C</p><ul><li>+=ï¼šè¿½åŠ èµ‹å€¼</li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">a=<span class="number">12</span></span><br><span class="line">b:=$(a)</span><br><span class="line">a+=hello</span><br><span class="line">all:</span><br><span class="line">    @echo $(b)</span><br><span class="line">    echo $(a)</span><br><span class="line">a=<span class="number">12</span> hello</span><br></pre></td></tr></tbody></table></figure><p>C</p><ul><li>å¯ä»¥åœ¨è¯­å¥å‰åŠ @éšè—æ˜¾ç¤ºè¯­å¥</li><li>åˆ©ç”¨å˜é‡å†™makefileï¼š</li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">TARGET=app</span><br><span class="line">OBJS=<span class="built_in">list</span>.o main.o</span><br><span class="line">CC=gcc</span><br><span class="line">OBJS2=<span class="built_in">list</span>.c</span><br><span class="line">OBJS3=main.c</span><br><span class="line">PATH=-I ./include</span><br><span class="line">$(TARGET):$(OBJS)</span><br><span class="line">    $(CC)  $(OBJS) $(PATH) -o $(TARGET)</span><br><span class="line"><span class="built_in">list</span>.o:$(OBJS2)</span><br><span class="line">    $(CC) -c $(OBJS2) $(PATH) -o <span class="built_in">list</span>.o</span><br><span class="line">main.o:$(OBJS3)</span><br><span class="line">    $(CC) -c $(OBJS3) $(PATH) -o main.o</span><br><span class="line">clean:</span><br><span class="line">    rm $(OBJS) $(TARGET)                             </span><br></pre></td></tr></tbody></table></figure><p>C</p><ul><li>ç‰¹æ®Šçš„å˜é‡ï¼š<ul><li>$@â€”ç›®æ ‡æ–‡ä»¶</li><li>$^â€”æ‰€æœ‰ä¾èµ–æ–‡ä»¶</li><li>$&lt;:ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶</li><li>é€šé…ç¬¦ï¼š%</li></ul></li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">TARGET=app</span><br><span class="line">OBJS=<span class="built_in">list</span>.o main.o</span><br><span class="line">CC=gcc</span><br><span class="line">OBJS2=<span class="built_in">list</span>.c</span><br><span class="line">OBJS3=main.c</span><br><span class="line">path=-I ./include</span><br><span class="line">$(TARGET):$(OBJS)</span><br><span class="line">    $(CC)  $^ $(path) -o $@</span><br><span class="line">%.o:%.c</span><br><span class="line">    $(CC) -c $^ $(path) -o $@</span><br><span class="line">clean:</span><br><span class="line">    rm $(TARGET) $(OBJS)</span><br></pre></td></tr></tbody></table></figure></blockquote>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cè¯­è¨€ </tag>
            
            <tag> makefile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GDBè°ƒè¯•</title>
      <link href="/2023/03/20/GDB%E8%B0%83%E8%AF%95/"/>
      <url>/2023/03/20/GDB%E8%B0%83%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h3 id="gdbè°ƒå¼å·¥å…·"><a href="#gdbè°ƒå¼å·¥å…·" class="headerlink" title="gdbè°ƒå¼å·¥å…·"></a>gdbè°ƒå¼å·¥å…·</h3><ul><li>å¸®æˆ‘ä»¬æ‰¾å‡ºä»£ç çš„é—®é¢˜</li></ul><h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><ol><li>gcc -g ç¼–è¯‘çš„æ–‡ä»¶å ,å›ç”Ÿäº§ä¸€ä¸ªa.outçš„æ‰§è¡Œæ–‡ä»¶ è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥è°ƒå¼</li><li>gdb a.out</li></ol><h4 id="é€‰é¡¹"><a href="#é€‰é¡¹" class="headerlink" title="é€‰é¡¹"></a>é€‰é¡¹</h4><ol><li>r â€”- è¿è¡Œç¨‹åº</li><li>l â€”- æŸ¥çœ‹ç¨‹åºä»£ç </li><li>b â€”- è®¾ç½®æ–­ç‚¹ï¼Œè®©ç¨‹åºè·‘åˆ°è®¾ç½®é‚£ä¸€è¡Œ</li><li>c â€”- ç»§ç»­è¿è¡Œç¨‹åºï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œå¦‚æœæ²¡æœ‰ç›´æ¥è¿è¡Œå®Œ</li><li>p å˜é‡å â€”- æŸ¥çœ‹å˜é‡å€¼</li><li>n â€”- ä¸€è¡Œä¸€è¡Œçš„è¿è¡Œï¼ˆnextï¼‰ï¼Œä½†æ˜¯ä¸è¿›å…¥å‡½æ•°</li><li>s â€”- æŒ‰è¡Œæ‰§è¡Œï¼Œä½†ä¼šè¿›å…¥å‡½æ•°</li><li>delete â€”- åˆ é™¤æ‰€æœ‰æ–­ç‚¹</li><li>q â€”- é€€å‡º</li></ol><table><thead><tr><th align="left">å‘½ä»¤</th><th align="left">ç®€ä»‹</th><th align="left">gdbåŠŸèƒ½</th><th align="left">ä½¿ç”¨æ–¹æ³•åŠå¤‡æ³¨</th></tr></thead><tbody><tr><td align="left">run</td><td align="left">r</td><td align="left">è¿è¡Œ</td><td align="left">è°ƒè¯•å¼€å§‹</td></tr><tr><td align="left">break</td><td align="left">b</td><td align="left">è®¾ç½®æ–­ç‚¹</td><td align="left">bæ–­ç‚¹å¤„</td></tr><tr><td align="left">info</td><td align="left">i</td><td align="left">æŸ¥çœ‹ä¿¡æ¯</td><td align="left">æŸ¥çœ‹æ–­ç‚¹i bï¼Œç­‰åé¢è¯¦ç»†åˆ—ä¸¾</td></tr><tr><td align="left">delete</td><td align="left">d</td><td align="left">åˆ é™¤æ–­ç‚¹</td><td align="left">deleteæ–­ç‚¹ç¼–å·</td></tr><tr><td align="left">disable</td><td align="left">disable</td><td align="left">ç¦ç”¨æ–­ç‚¹</td><td align="left">disableæ–­ç‚¹ç¼–å·</td></tr><tr><td align="left">backtrace</td><td align="left">bt,where</td><td align="left">æŸ¥çœ‹æ ˆå¸§</td><td align="left">bt Næ˜¾ç¤ºå¼€å¤´Nä¸ªæ ˆå¸§ï¼Œ bt -Næœ€åNä¸ªæ ˆå¸§</td></tr><tr><td align="left">print</td><td align="left">p</td><td align="left">æ‰“å°å˜é‡</td><td align="left">p argcæ‰“å°å˜é‡ï¼Œåé¢è¯¦ç»†ä»‹ç»</td></tr><tr><td align="left">x</td><td align="left">x</td><td align="left">æ˜¾ç¤ºå†…å­˜</td><td align="left">x 0x1234567ï¼Œåé¢è¯¦ç»†ä»‹ç»</td></tr><tr><td align="left">set</td><td align="left">set</td><td align="left">æ”¹å˜å˜é‡å€¼</td><td align="left">set variable &lt;å˜é‡&gt; = &lt;è¡¨è¾¾å¼&gt;ï¼›æ¯”å¦‚ set var test=3</td></tr><tr><td align="left">next</td><td align="left">n</td><td align="left">æ‰§è¡Œä¸‹ä¸€è¡Œ</td><td align="left">n;æ‰§è¡Œåˆ°ä¸‹ä¸€è¡Œï¼Œä¸ç®¡ä¸‹ä¸€è¡Œå¤šå¤æ‚</td></tr><tr><td align="left">step</td><td align="left">s</td><td align="left">æ‰§è¡Œä¸‹ä¸€è¡Œ</td><td align="left">s;è‹¥ä¸‹ä¸€è¡Œä¸ºå‡½æ•°ï¼Œåˆ™è¿›å…¥å‡½æ•°å†…éƒ¨</td></tr><tr><td align="left">continue</td><td align="left">c,cont</td><td align="left">ç»§ç»­</td><td align="left">cä¸ºç»§ç»­çš„æ¬¡æ•°ï¼Œå¯çœç•¥ï¼Œè¡¨ç¤ºç»§ç»­ä¸€æ¬¡</td></tr><tr><td align="left">finish</td><td align="left">finish</td><td align="left"></td><td align="left">æ‰§è¡Œå®Œæˆå½“å‰å‡½æ•°</td></tr><tr><td align="left">until</td><td align="left">until</td><td align="left"></td><td align="left">æ‰§è¡Œå®Œæˆä»£ç å—</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cè¯­è¨€ </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cé«˜çº§</title>
      <link href="/2023/03/16/C%E9%AB%98%E7%BA%A7/"/>
      <url>/2023/03/16/C%E9%AB%98%E7%BA%A7/</url>
      
        <content type="html"><![CDATA[<h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><ul><li>å®Œæˆç‰¹ç‚¹çš„ç¨‹åºæ¨¡å—</li><li>å‡½æ•°çš„åˆ†ç±»<ul><li>åº“å‡½æ•°ï¼šç»™ç”¨æˆ·ç›´æ¥è°ƒç”¨çš„å‡½æ•°ï¼ˆè°ƒç”¨æ—¶éœ€è¦åŠ å¯¹åº”çš„å¤´æ–‡ä»¶ï¼‰</li><li>è‡ªå®šä¹‰å‡½æ•°ï¼šç”¨æˆ·ä¸­é—´å†™çš„å‡½æ•°</li></ul></li></ul><h3 id="å‡½æ•°æŒ‡é’ˆæ•°ç»„"><a href="#å‡½æ•°æŒ‡é’ˆæ•°ç»„" class="headerlink" title="å‡½æ•°æŒ‡é’ˆæ•°ç»„"></a>å‡½æ•°æŒ‡é’ˆæ•°ç»„</h3><p>æœ¬è´¨æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåªæ˜¯è¿™ä¸ªæ•°ç»„é‡Œé¢æ”¾çš„æ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ</p><p>ä¸€èˆ¬å½¢å¼ï¼šå­˜å‚¨ç±»å‹ æ•°æ®ç±»å‹ ï¼ˆ*æ•°ç»„åã€ä¸‹æ ‡ã€‘ï¼‰ï¼ˆæ•°æ®ç±»å‹ å½¢å‚1ï¼Œæ•°æ®ç±»å‹ å½¢å‚2.ã€‚ã€‚ã€‚ï¼‰</p><p>ä¾‹å¦‚ï¼šint (*p[3])(int ï¼Œint)ï¼›</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">jian</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a-b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">cheng</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a*b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">chu</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line">{</span><br><span class="line">    <span class="keyword">return</span> a/b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">{ </span><br><span class="line">    <span class="type">int</span> (*p[<span class="number">4</span>])(<span class="type">int</span> a,<span class="type">int</span> b)={add,jian,cheng,chu};</span><br><span class="line">    <span class="type">int</span> i,j;</span><br><span class="line">    <span class="type">char</span> c;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%c%d"</span>,&amp;i,&amp;c,&amp;j);</span><br><span class="line">    <span class="keyword">switch</span>(c)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'+'</span>:<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,p[<span class="number">0</span>](i,j));<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'-'</span>:<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,p[<span class="number">1</span>](i,j));<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'*'</span>:<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,p[<span class="number">2</span>](i,j));<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'/'</span>:<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,p[<span class="number">3</span>](i,j));<span class="keyword">break</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">} </span><br></pre></td></tr></tbody></table></figure><h3 id="æ•°çš„å¤šæ–‡ä»¶å°è£…"><a href="#æ•°çš„å¤šæ–‡ä»¶å°è£…" class="headerlink" title="æ•°çš„å¤šæ–‡ä»¶å°è£…"></a>æ•°çš„å¤šæ–‡ä»¶å°è£…</h3><ol><li><p>å¤´æ–‡ä»¶â€“å¯ä»¥æ”¾åº“å¤´æ–‡ä»¶å’Œæ‰€æœ‰åŠŸèƒ½å‡½æ•°çš„å£°æ˜</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _JISUAN_H ---- é˜²æ­¢å¤´æ–‡ä»¶é‡å¤åŒ…å«</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _JISUAN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span> ---- åº“å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>; ---- å‡½æ•°çš„å£°æ˜</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></tbody></table></figure></li><li><p>åŠŸèƒ½æ–‡ä»¶â€” è‡ªå®šä¹‰çš„å¤´æ–‡ä»¶å’Œæ‰€æœ‰åŠŸèƒ½å‡½æ•°ä»£ç </p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"jisuan.h"</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line"> {</span><br><span class="line">     <span class="keyword">return</span> a+b;</span><br><span class="line"> }</span><br><span class="line"> <span class="type">int</span> <span class="title function_">jian</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line"> {</span><br><span class="line">     <span class="keyword">return</span> a-b;</span><br><span class="line"> }</span><br><span class="line"> <span class="type">int</span> <span class="title function_">cheng</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line"> {</span><br><span class="line">     <span class="keyword">return</span> a*b;</span><br><span class="line"> }</span><br><span class="line"> <span class="type">int</span> <span class="title function_">chu</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span><br><span class="line"> {</span><br><span class="line">     <span class="keyword">return</span> a/b;</span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure></li><li><p>ä¸»å‡½æ•°æ–‡ä»¶â€”è‡ªå®šä¹‰å¤´æ–‡ä»¶å’Œå‡½æ•°çš„è°ƒç”¨</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"> <span class="meta">#<span class="keyword">include</span> <span class="string">"jisuan.h"</span></span></span><br><span class="line"> <span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line"> {</span><br><span class="line">     <span class="type">int</span> x=<span class="number">12</span>,y=<span class="number">34</span>;</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">"sum=%d\n"</span>,add(x,y)); </span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> }</span><br><span class="line">ç¼–è¯‘ï¼šè‡³å°‘ç¼–è¯‘ä¸¤ä¸ª.cæ–‡ä»¶ï¼Œå¤´æ–‡ä»¶é»˜è®¤åœ¨å½“å‰ç›®å½•ä¸‹å»æ‰¾</span><br><span class="line">    è°ƒç”¨å¤–éƒ¨å¤´æ–‡ä»¶ï¼š-I</span><br></pre></td></tr></tbody></table></figure></li></ol><h3 id="é€’å½’å‡½æ•°"><a href="#é€’å½’å‡½æ•°" class="headerlink" title="é€’å½’å‡½æ•°"></a>é€’å½’å‡½æ•°</h3><ul><li>ç›´æ¥æˆ–é—´æ¥çš„è°ƒç”¨å‡½æ•°æœ¬èº«çš„å‡½æ•°</li><li>ä¸¤ä¸ªæ¡ä»¶ï¼šè°ƒç”¨è‡ªå·±ï¼Œè¦æœ‰ç»“æŸè¡¨ç¤º</li><li>æ¯æ¬¡è°ƒç”¨è‡ªå·±éƒ½ä¼šç»™å‡½æ•°å¼€è¾Ÿç©ºé—´ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨çš„å˜é‡éƒ½ä¼šè¢«ä¿ç•™åœ¨å½“å‰å‡½æ•°å†…ï¼Œ</li><li>å¾ªç¯èƒ½åšçš„é€’å½’èƒ½åšï¼Œä½†é€’å½’èƒ½åšçš„å¾ªç¯ä¸èƒ½åš</li></ul><h3 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h3><ul><li><p>æŠŠå‡½æ•°ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œç”¨å‡½æ•°æŒ‡é’ˆæ¥æ¥å—çš„å‡½æ•°</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>{</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">sub</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>{</span><br><span class="line">    <span class="keyword">return</span> a-b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">mul</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>{</span><br><span class="line">    <span class="keyword">return</span> a * b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span>{</span><br><span class="line">    <span class="keyword">return</span> a / b;</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">calc</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span>(*p)(<span class="type">int</span> a,<span class="type">int</span> b))</span>{</span><br><span class="line">    <span class="keyword">return</span> p(a,b);</span><br><span class="line">}</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line"><span class="type">int</span> a=<span class="number">21</span>,b=<span class="number">7</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"result = %d"</span>,calc(a,b,sub));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul><h3 id="åŠ¨æ€å¼€è¾Ÿç©ºé—´å‡½æ•°"><a href="#åŠ¨æ€å¼€è¾Ÿç©ºé—´å‡½æ•°" class="headerlink" title="åŠ¨æ€å¼€è¾Ÿç©ºé—´å‡½æ•°"></a>åŠ¨æ€å¼€è¾Ÿç©ºé—´å‡½æ•°</h3><h4 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h4><ul><li><p>åœ¨å †åŒºä¸­å¼€è¾Ÿç©ºé—´ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¼€è¾Ÿï¼Œä¹Ÿéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨é‡Šæ”¾</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹</span></span><br><span class="line"><span class="type">void</span> *<span class="title function_">malloc</span><span class="params">(<span class="type">size_t</span> size)</span>;</span><br><span class="line"><span class="comment">//å‚æ•°  size:éœ€è¦å¼€è¾Ÿç©ºé—´çš„å¤§å°</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šå¼€è¾ŸæˆåŠŸè¿”å›å¼€è¾Ÿçš„åœ°å€ï¼Œå¤±è´¥è¿”å›ç©º</span></span><br><span class="line"><span class="comment">//é‡Šæ”¾ç©ºé—´åœ°å€ï¼š</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">free</span><span class="params">(<span class="type">void</span> *ptr)</span>;</span><br><span class="line"><span class="comment">//å‚æ•°ï¼šptr:è¦é‡Šæ”¾çš„é¦–åœ°å€,æ˜¯å¼€è¾Ÿçš„æŒ‡é’ˆå¹¶ä¸æ˜¯æŒ‡é’ˆæœ¬èº«æ‰€åœ¨çš„æ ˆç©ºé—´</span></span><br><span class="line"><span class="comment">//æœ€åä¸ºäº†é¿å…é‡æŒ‡é’ˆï¼Œæ‰€ä»¥éœ€è¦æŠŠNULLèµ‹å€¼ç»™æŒ‡é’ˆ</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>ç»ƒä¹ </p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">int</span> *p=(<span class="type">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span> (<span class="type">int</span>)*<span class="number">10</span>);</span><br><span class="line">    <span class="type">int</span> *pp=p;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) {</span><br><span class="line">        *p=rand();</span><br><span class="line">        p++;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) {</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>,*pp);</span><br><span class="line">        pp++;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    p=<span class="literal">NULL</span>;</span><br><span class="line">    pp=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul><h3 id="å…³é”®å­—"><a href="#å…³é”®å­—" class="headerlink" title="å…³é”®å­—"></a>å…³é”®å­—</h3><h4 id="const-â€”-å˜é‡å¸¸é‡åŒ–"><a href="#const-â€”-å˜é‡å¸¸é‡åŒ–" class="headerlink" title="const â€” å˜é‡å¸¸é‡åŒ–"></a>const â€” å˜é‡å¸¸é‡åŒ–</h4><blockquote><ul><li>constä¿®é¥°æŒ‡é’ˆ</li><li>int const *p =&amp;a â€”pçš„å†…å®¹ä¸èƒ½æ”¹</li><li>int *const p =&amp;a â€”pçš„åœ°å€ä¸èƒ½æ”¹</li></ul></blockquote><h4 id="define-â€”å®å®šä¹‰"><a href="#define-â€”å®å®šä¹‰" class="headerlink" title="define â€”å®å®šä¹‰"></a>define â€”å®å®šä¹‰</h4><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> A char *</span></span><br><span class="line"><span class="keyword">typedef</span>  <span class="type">char</span> * B;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">{</span><br><span class="line">    A a,b;</span><br><span class="line">    B c,d;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"a=%ld\n"</span>,<span class="keyword">sizeof</span>(a));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"b=%ld\n"</span>,<span class="keyword">sizeof</span>(b));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"c=%ld\n"</span>,<span class="keyword">sizeof</span>(c));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"d=%ld\n"</span>,<span class="keyword">sizeof</span>(d));     </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="https://typora-1304577690.cos.ap-chengdu.myqcloud.com/image-20230317090936491.png" alt="image-20230317090936491"></p><p>ä¸Šé¢ç»“æœä¸ºä¸Šå›¾ ï¼Œæ‰€å¯ä»¥çœ‹åˆ°b=1ï¼Œè¡¨ç¤ºæŠŠA a,b;ä¸­çš„Aæ›¿æ¢æˆäº†char *, æ•…ä¸ºchar *a,b;ç±»å‹ä¸ºchar è€Œä¸æ˜¯char *</p><h4 id="typedef-â€”-é‡å‘½å"><a href="#typedef-â€”-é‡å‘½å" class="headerlink" title="typedef â€”- é‡å‘½å"></a>typedef â€”- é‡å‘½å</h4><figure class="highlight cpp"><table><tbody><tr><td class="code"><pre><span class="line">å·²çŸ¥æ•°æ®ç±»å‹çš„é‡å‘½å</span><br><span class="line"> <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> <span class="keyword">typedef</span> <span class="type">int</span> A;</span><br><span class="line"> <span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"> </span>{</span><br><span class="line">     A a=<span class="number">12</span>;</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">"a=%d\n"</span>,a);    </span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> }  </span><br></pre></td></tr></tbody></table></figure><h5 id="define-å’ŒtypedefäºŒè€…åŒºåˆ«"><a href="#define-å’ŒtypedefäºŒè€…åŒºåˆ«" class="headerlink" title="define å’ŒtypedefäºŒè€…åŒºåˆ«"></a>define å’ŒtypedefäºŒè€…åŒºåˆ«</h5><p><img src="https://typora-1304577690.cos.ap-chengdu.myqcloud.com/image-20230316145602504.png" alt="image-20230316145602504"></p><ul><li><p>ç»ƒä¹  â€” åˆ©ç”¨å®å®šä¹‰æ±‚å‡ºä¸¤ä¸ªæ•°ä¹‹é—´çš„æœ€å¤§å€¼</p><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(x,y) x&gt;y?x:y</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">int</span> a=<span class="number">5</span>,b=<span class="number">7</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,MAX(a,b));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul><h3 id="static-â€”é™æ€åŒºåŸŸå­˜å‚¨"><a href="#static-â€”é™æ€åŒºåŸŸå­˜å‚¨" class="headerlink" title="static â€”é™æ€åŒºåŸŸå­˜å‚¨"></a>static â€”é™æ€åŒºåŸŸå­˜å‚¨</h3><h4 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><ul><li>ä¿®é¥°å…¨å±€å˜é‡ï¼Œé™åˆ¶ä½œç”¨åŸŸ</li><li>ä¿®é¥°å±€éƒ¨å˜é‡ï¼Œå»¶é•¿ç”Ÿå‘½å‘¨æœŸï¼ˆåªä¼šè¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼‰</li><li>ä¿®é¥°å‡½æ•°ï¼Œé™åˆ¶ä½œç”¨åŸŸ</li></ul><h4 id="extern-â€”-è°ƒç”¨å¤–éƒ¨æ–‡ä»¶å˜é‡"><a href="#extern-â€”-è°ƒç”¨å¤–éƒ¨æ–‡ä»¶å˜é‡" class="headerlink" title="extern â€” è°ƒç”¨å¤–éƒ¨æ–‡ä»¶å˜é‡"></a>extern â€” è°ƒç”¨å¤–éƒ¨æ–‡ä»¶å˜é‡</h4><ul><li>åªèƒ½è°ƒç”¨å…¨å±€å˜é‡</li><li>ç¼–è¯‘çš„æ—¶å€™è¦å’Œè°ƒç”¨çš„æ–‡ä»¶ä¸€èµ·ç¼–è¯‘</li></ul><figure class="highlight c"><table><tbody><tr><td class="code"><pre><span class="line">#extern2.c</span><br><span class="line"><span class="type">int</span> a=<span class="number">88</span>;</span><br><span class="line"></span><br><span class="line">#extern1.c</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> a;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> *argv[])</span>{</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line">#ç¼–è¯‘æ—¶è¦åŒæ—¶éƒ½è¦ç¼–è¯‘</span><br><span class="line">gcc exten1.c extern2.c</span><br><span class="line">./a.out</span><br><span class="line">#è¾“å‡ºç»“æœä¸º</span><br><span class="line"><span class="number">88</span></span><br></pre></td></tr></tbody></table></figure><h3 id="struct-â€”-ç»“æ„ä½“"><a href="#struct-â€”-ç»“æ„ä½“" class="headerlink" title="struct â€” ç»“æ„ä½“"></a>struct â€” ç»“æ„ä½“</h3><ul><li><p>æœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªæ•°æ®ç±»å‹ï¼Œåªæ˜¯é‡Œé¢å¯ä»¥æ”¾å¾ˆå¤šæˆå‘˜ï¼Œè¿™äº›æˆå‘˜æ•°æ®ç±»å‹å¯ä»¥åŒ»é™¢ä¹Ÿå¯ä»¥ä¸ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥æ˜¯å·²çŸ¥çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯æ„é€ ç±»å‹</p></li><li><pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> ç»“æ„ä½“å<span class="token punctuation">{</span>    æ•°æ®ç±»å‹ æˆå‘˜<span class="token number">1</span><span class="token punctuation">;</span>    æ•°æ®ç±»å‹ æˆå‘˜<span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">-</span>åˆ†å·ä¸èƒ½çœ</code></pre></li><li><p>å…¨å±€åˆå§‹åŒ–ï¼šåœ¨å¤´æ–‡ä»¶ä¸‹ï¼Œä¸»å‡½æ•°ä¸Šï¼Œå°±æ˜¯åœ¨æ„é€ å®Œè¿™ä¸ªç»“æ„ä½“åç«‹é©¬åˆå§‹åŒ–</p></li><li><p>å±€éƒ¨åˆå§‹åŒ–ï¼šåœ¨å‡½æ•°ä½“ä¸­å®šä¹‰ä¸€ä¸ªç»“æ„ä½“å˜é‡</p><p><img src="https://typora-1304577690.cos.ap-chengdu.myqcloud.com/image-20230316154934228.png" alt="image-20230316154934228"></p></li><li><p>ç»“æ„ä½“èµ‹å€¼</p><ol><li>ç»“æ„ä½“èµ‹ç»“æ„ä½“</li><li>æˆå‘˜å•ç‹¬èµ‹å€¼<ul><li>æ³¨æ„ç»™å­—ç¬¦æ•°ç»„èµ‹å€¼ç”¨strcpy()èµ‹å€¼</li></ul></li></ol></li><li><p><span class="github-emoji"><span>â­</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>ç»“æ„ä½“å¤§å°(ç¬”è¯•ä¼šè€ƒ)</p><ul><li>å¦‚æœæ˜¯64ä½ç³»ç»Ÿç³»ç»Ÿé»˜è®¤å®‰è£…8byteå¯¹é½ï¼Œä½†æ˜¯å¦‚æœæœ€å¤§çš„æ•°æ®ç±»å‹å°äº8byteï¼Œå°±æŒ‰ç…§æœ€å¤§æˆå‘˜çš„æ•°æ®ç±»å‹çš„é•¿åº¦å»è®¡ç®—ï¼ˆå°±æ˜¯æœ€å¤§æˆå‘˜å˜é‡çš„å€æ•°ï¼‰</li><li>å¦‚æœæ˜¯64ä½ç³»ç»Ÿç³»ç»Ÿé»˜è®¤å®‰è£…4byteå¯¹é½ï¼Œä½†æ˜¯å¦‚æœæœ€å¤§çš„æ•°æ®ç±»å‹å°äº4byteï¼Œå°±æŒ‰ç…§æœ€å¤§æˆå‘˜çš„æ•°æ®ç±»å‹çš„é•¿åº¦å»è®¡ç®—ï¼ˆå°±æ˜¯æœ€å¤§æˆå‘˜å˜é‡çš„å€æ•°ï¼‰</li><li>å¶æ•°åœ°å€å­˜å‚¨</li><li>å¦‚æœå¯¹é½è‡ªå·±èƒ½å¤Ÿæ”¾ä¸‹åé¢çš„æˆå‘˜ï¼Œå°±ä¼šåœ¨å½“å‰å­—èŠ‚æ”¾ï¼Œå¦åˆ™å°±ç©ºå‡ºæ¥é‡æ–°å¼€è¾Ÿ</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> åµŒå…¥å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shellçš„åŸºæœ¬è¿ç®—ç¬¦</title>
      <link href="/2023/03/15/shell%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%BF%90%E7%AE%97%E7%AC%A6/"/>
      <url>/2023/03/15/shell%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%BF%90%E7%AE%97%E7%AC%A6/</url>
      
        <content type="html"><![CDATA[<h1 id="Shell-åŸºæœ¬è¿ç®—ç¬¦"><a href="#Shell-åŸºæœ¬è¿ç®—ç¬¦" class="headerlink" title="Shell åŸºæœ¬è¿ç®—ç¬¦"></a>Shell åŸºæœ¬è¿ç®—ç¬¦</h1><p>Shell å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œæ”¯æŒå¤šç§è¿ç®—ç¬¦ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>ç®—æ•°è¿ç®—ç¬¦</li><li>å…³ç³»è¿ç®—ç¬¦</li><li>å¸ƒå°”è¿ç®—ç¬¦</li><li>å­—ç¬¦ä¸²è¿ç®—ç¬¦</li><li>æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦</li></ul><p>åŸç”Ÿbashä¸æ”¯æŒç®€å•çš„æ•°å­¦è¿ç®—ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–å‘½ä»¤æ¥å®ç°ï¼Œä¾‹å¦‚ <code>awk</code> å’Œ <code>expr</code>ï¼Œ<code>expr</code> æœ€å¸¸ç”¨ã€‚</p><p><code>expr</code> æ˜¯ä¸€æ¬¾è¡¨è¾¾å¼è®¡ç®—å·¥å…·ï¼Œä½¿ç”¨å®ƒèƒ½å®Œæˆè¡¨è¾¾å¼çš„æ±‚å€¼æ“ä½œã€‚</p><p>ä¾‹å¦‚ï¼Œä¸¤ä¸ªæ•°ç›¸åŠ (<strong>æ³¨æ„ä½¿ç”¨çš„æ˜¯åå¼•å· *<em>`*</em> è€Œä¸æ˜¯å•å¼•å· *<em>â€˜*</em></strong>)ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">val=`<span class="built_in">expr</span> 2 + 2`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"ä¸¤æ•°ä¹‹å’Œä¸º : <span class="variable">$val</span>"</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰§è¡Œè„šæœ¬ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>ä¸¤æ•°ä¹‹å’Œä¸º : 4</p></blockquote><p>ä¸¤ç‚¹æ³¨æ„ï¼š</p><ul><li>è¡¨è¾¾å¼å’Œè¿ç®—ç¬¦ä¹‹é—´è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚ 2+2 æ˜¯ä¸å¯¹çš„ï¼Œå¿…é¡»å†™æˆ 2 + 2ï¼Œè¿™ä¸æˆ‘ä»¬ç†Ÿæ‚‰çš„å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸ä¸€æ ·ã€‚</li><li>å®Œæ•´çš„è¡¨è¾¾å¼è¦è¢« <strong>`</strong> åŒ…å«ï¼Œæ³¨æ„è¿™ä¸ªå­—ç¬¦ä¸æ˜¯å¸¸ç”¨çš„å•å¼•å· <strong>'</strong>ï¼Œåœ¨ Esc é”®ä¸‹è¾¹ã€‚</li></ul><h2 id="ç®—æœ¯è¿ç®—ç¬¦"><a href="#ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="ç®—æœ¯è¿ç®—ç¬¦"></a>ç®—æœ¯è¿ç®—ç¬¦</h2><p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„ç®—æœ¯è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º 10ï¼Œå˜é‡ b ä¸º 20ï¼š</p><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">è¯´æ˜</th><th align="left">ä¸¾ä¾‹</th></tr></thead><tbody><tr><td align="left">+</td><td align="left">åŠ æ³•</td><td align="left">`expr $a + $b` ç»“æœä¸º 30ã€‚</td></tr><tr><td align="left">-</td><td align="left">å‡æ³•</td><td align="left">`expr $a - $b` ç»“æœä¸º -10ã€‚</td></tr><tr><td align="left">*</td><td align="left">ä¹˜æ³•</td><td align="left">`expr $a * $b` ç»“æœä¸º  200ã€‚</td></tr><tr><td align="left">/</td><td align="left">é™¤æ³•</td><td align="left">`expr $b / $a` ç»“æœä¸º 2ã€‚</td></tr><tr><td align="left">%</td><td align="left">å–ä½™</td><td align="left">`expr $b % $a` ç»“æœä¸º 0ã€‚</td></tr><tr><td align="left">=</td><td align="left">èµ‹å€¼</td><td align="left">a=$b æŠŠå˜é‡ b çš„å€¼èµ‹ç»™ aã€‚</td></tr><tr><td align="left">==</td><td align="left">ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œç›¸åŒåˆ™è¿”å› trueã€‚</td><td align="left">[ $a == $b ] è¿”å› falseã€‚</td></tr><tr><td align="left">!=</td><td align="left">ä¸ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œä¸ç›¸åŒåˆ™è¿”å› trueã€‚</td><td align="left">[ $a != $b ] è¿”å› trueã€‚</td></tr></tbody></table><p><strong>æ³¨æ„ï¼š</strong>æ¡ä»¶è¡¨è¾¾å¼è¦æ”¾åœ¨æ–¹æ‹¬å·ä¹‹é—´ï¼Œå¹¶ä¸”è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚: <strong><code>[$a==$b]</code></strong> æ˜¯é”™è¯¯çš„ï¼Œå¿…é¡»å†™æˆ<code>[ $a == $b ]</code>ã€‚</p><h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>ç®—æœ¯è¿ç®—ç¬¦å®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line">*<span class="comment">#!/bin/bash*</span></span><br><span class="line"></span><br><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line"></span><br><span class="line">val=`<span class="built_in">expr</span> <span class="variable">$a</span> + <span class="variable">$b</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"a + b : <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`<span class="built_in">expr</span> <span class="variable">$a</span> - <span class="variable">$b</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"a - b : <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`<span class="built_in">expr</span> <span class="variable">$a</span> \* <span class="variable">$b</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"a * b : <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`<span class="built_in">expr</span> <span class="variable">$b</span> / <span class="variable">$a</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"b / a : <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line">val=`<span class="built_in">expr</span> <span class="variable">$b</span> % <span class="variable">$a</span>`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"b % a : <span class="variable">$val</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> == <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"a ç­‰äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> != <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"a ä¸ç­‰äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰§è¡Œè„šæœ¬ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>a + b : 30<br>a - b : -10<br>a * b : 200<br>b / a : 2<br>b % a : 0<br>a ä¸ç­‰äº b</p></blockquote><blockquote><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>ä¹˜å·(*)å‰è¾¹å¿…é¡»åŠ åæ–œæ (\)æ‰èƒ½å®ç°ä¹˜æ³•è¿ç®—ï¼›</li><li>ifâ€¦thenâ€¦fi æ˜¯æ¡ä»¶è¯­å¥ï¼Œåç»­å°†ä¼šè®²è§£ã€‚</li><li>åœ¨ MAC ä¸­ shell çš„ expr è¯­æ³•æ˜¯ï¼š<code>$((è¡¨è¾¾å¼))</code>ï¼Œæ­¤å¤„è¡¨è¾¾å¼ä¸­çš„ â€œ*â€œ ä¸éœ€è¦è½¬ä¹‰ç¬¦å· â€œ\â€œ ã€‚</li></ul></blockquote><h2 id="å…³ç³»è¿ç®—ç¬¦"><a href="#å…³ç³»è¿ç®—ç¬¦" class="headerlink" title="å…³ç³»è¿ç®—ç¬¦"></a>å…³ç³»è¿ç®—ç¬¦</h2><p>å…³ç³»è¿ç®—ç¬¦åªæ”¯æŒæ•°å­—ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²ï¼Œé™¤éå­—ç¬¦ä¸²çš„å€¼æ˜¯æ•°å­—ã€‚</p><p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å…³ç³»è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º 10ï¼Œå˜é‡ b ä¸º 20ï¼š</p><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">è¯´æ˜</th><th align="left">ä¸¾ä¾‹</th></tr></thead><tbody><tr><td align="left">-eq</td><td align="left">æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚</td><td align="left">[ $a -eq $b ] è¿”å› falseã€‚</td></tr><tr><td align="left">-ne</td><td align="left">æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚</td><td align="left">[ $a -ne $b ] è¿”å› trueã€‚</td></tr><tr><td align="left">-gt</td><td align="left">æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ $a -gt $b ] è¿”å› falseã€‚</td></tr><tr><td align="left">-lt</td><td align="left">æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ $a -lt $b ] è¿”å› trueã€‚</td></tr><tr><td align="left">-ge</td><td align="left">æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ $a -ge $b ] è¿”å› falseã€‚</td></tr><tr><td align="left">-le</td><td align="left">æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ $a -le $b ] è¿”å› trueã€‚</td></tr></tbody></table><h3 id="å®ä¾‹-1"><a href="#å®ä¾‹-1" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>å…³ç³»è¿ç®—ç¬¦å®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -eq <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -eq <span class="variable">$b</span> : a ç­‰äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -eq <span class="variable">$b</span>: a ä¸ç­‰äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -ne <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -ne <span class="variable">$b</span>: a ä¸ç­‰äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -ne <span class="variable">$b</span> : a ç­‰äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -gt <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -gt <span class="variable">$b</span>: a å¤§äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -gt <span class="variable">$b</span>: a ä¸å¤§äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -lt <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -lt <span class="variable">$b</span>: a å°äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -lt <span class="variable">$b</span>: a ä¸å°äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -ge <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -ge <span class="variable">$b</span>: a å¤§äºæˆ–ç­‰äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -ge <span class="variable">$b</span>: a å°äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -le <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -le <span class="variable">$b</span>: a å°äºæˆ–ç­‰äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> -le <span class="variable">$b</span>: a å¤§äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰§è¡Œè„šæœ¬ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>10 -eq 20: a ä¸ç­‰äº b<br>10 -ne 20: a ä¸ç­‰äº b<br>10 -gt 20: a ä¸å¤§äº b<br>10 -lt 20: a å°äº b<br>10 -ge 20: a å°äº b<br>10 -le 20: a å°äºæˆ–ç­‰äº b</p></blockquote><h2 id="å¸ƒå°”è¿ç®—ç¬¦"><a href="#å¸ƒå°”è¿ç®—ç¬¦" class="headerlink" title="å¸ƒå°”è¿ç®—ç¬¦"></a>å¸ƒå°”è¿ç®—ç¬¦</h2><p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å¸ƒå°”è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º 10ï¼Œå˜é‡ b ä¸º 20ï¼š</p><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">è¯´æ˜</th><th align="left">ä¸¾ä¾‹</th></tr></thead><tbody><tr><td align="left">!</td><td align="left">éè¿ç®—ï¼Œè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› falseï¼Œå¦åˆ™è¿”å› trueã€‚</td><td align="left">[ ! false ] è¿”å› trueã€‚</td></tr><tr><td align="left">-o</td><td align="left">æˆ–è¿ç®—ï¼Œæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› trueã€‚</td><td align="left">[ $a -lt 20 -o $b -gt 100 ] è¿”å› trueã€‚</td></tr><tr><td align="left">-a</td><td align="left">ä¸è¿ç®—ï¼Œä¸¤ä¸ªè¡¨è¾¾å¼éƒ½ä¸º true æ‰è¿”å› trueã€‚</td><td align="left">[ $a -lt 20 -a $b -gt 100 ] è¿”å› falseã€‚</td></tr></tbody></table><h3 id="å®ä¾‹-2"><a href="#å®ä¾‹-2" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>å¸ƒå°”è¿ç®—ç¬¦å®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> != <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> != <span class="variable">$b</span> : a ä¸ç­‰äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> == <span class="variable">$b</span>: a ç­‰äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -lt 100 -a <span class="variable">$b</span> -gt 15 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> å°äº 100 ä¸” <span class="variable">$b</span> å¤§äº 15 : è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> å°äº 100 ä¸” <span class="variable">$b</span> å¤§äº 15 : è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -lt 100 -o <span class="variable">$b</span> -gt 100 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> å°äº 100 æˆ– <span class="variable">$b</span> å¤§äº 100 : è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> å°äº 100 æˆ– <span class="variable">$b</span> å¤§äº 100 : è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -lt 5 -o <span class="variable">$b</span> -gt 100 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> å°äº 5 æˆ– <span class="variable">$b</span> å¤§äº 100 : è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> å°äº 5 æˆ– <span class="variable">$b</span> å¤§äº 100 : è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰§è¡Œè„šæœ¬ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>10 != 20 : a ä¸ç­‰äº b<br>10 å°äº 100 ä¸” 20 å¤§äº 15 : è¿”å› true<br>10 å°äº 100 æˆ– 20 å¤§äº 100 : è¿”å› true<br>10 å°äº 5 æˆ– 20 å¤§äº 100 : è¿”å› false</p></blockquote><h2 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h2><p>ä»¥ä¸‹ä»‹ç» Shell çš„é€»è¾‘è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º 10ï¼Œå˜é‡ b ä¸º 20:</p><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">è¯´æ˜</th><th align="left">ä¸¾ä¾‹</th></tr></thead><tbody><tr><td align="left">&amp;&amp;</td><td align="left">é€»è¾‘çš„ AND</td><td align="left">[[ $a -lt 100 &amp;&amp; $b -gt 100 ]] è¿”å› false</td></tr><tr><td align="left">||</td><td align="left">é€»è¾‘çš„ OR</td><td align="left">[[ $a -lt 100 || $b -gt 100 ]] è¿”å› true</td></tr></tbody></table><h3 id="å®ä¾‹-3"><a href="#å®ä¾‹-3" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>é€»è¾‘è¿ç®—ç¬¦å®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a=10</span><br><span class="line">b=20</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$a</span> -lt 100 &amp;&amp; <span class="variable">$b</span> -gt 100 ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$a</span> -lt 100 || <span class="variable">$b</span> -gt 100 ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"è¿”å› true"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"è¿”å› false"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰§è¡Œè„šæœ¬ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>è¿”å› false<br>è¿”å› true</p></blockquote><h2 id="å­—ç¬¦ä¸²è¿ç®—ç¬¦"><a href="#å­—ç¬¦ä¸²è¿ç®—ç¬¦" class="headerlink" title="å­—ç¬¦ä¸²è¿ç®—ç¬¦"></a>å­—ç¬¦ä¸²è¿ç®—ç¬¦</h2><p>ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å­—ç¬¦ä¸²è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º â€œabcâ€ï¼Œå˜é‡ b ä¸º â€œefgâ€ï¼š</p><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">è¯´æ˜</th><th align="left">ä¸¾ä¾‹</th></tr></thead><tbody><tr><td align="left">=</td><td align="left">æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚</td><td align="left">[ $a = $b ] è¿”å› falseã€‚</td></tr><tr><td align="left">!=</td><td align="left">æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚</td><td align="left">[ $a != $b ] è¿”å› trueã€‚</td></tr><tr><td align="left">-z</td><td align="left">æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º0ï¼Œä¸º0è¿”å› trueã€‚</td><td align="left">[ -z $a ] è¿”å› falseã€‚</td></tr><tr><td align="left">-n</td><td align="left">æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸ä¸º 0ï¼Œä¸ä¸º 0 è¿”å› trueã€‚</td><td align="left">[ -n â€œ$aâ€ ] è¿”å› trueã€‚</td></tr><tr><td align="left">$</td><td align="left">æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¸ä¸ºç©ºï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚</td><td align="left">[ $a ] è¿”å› trueã€‚</td></tr></tbody></table><h3 id="å®ä¾‹-4"><a href="#å®ä¾‹-4" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>å­—ç¬¦ä¸²è¿ç®—ç¬¦å®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">a=<span class="string">"abc"</span></span><br><span class="line">b=<span class="string">"efg"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> = <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> = <span class="variable">$b</span> : a ç­‰äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> = <span class="variable">$b</span>: a ä¸ç­‰äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> != <span class="variable">$b</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> != <span class="variable">$b</span> : a ä¸ç­‰äº b"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> != <span class="variable">$b</span>: a ç­‰äº b"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$a</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-z <span class="variable">$a</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸º 0"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-z <span class="variable">$a</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -n <span class="string">"<span class="variable">$a</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-n <span class="variable">$a</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"-n <span class="variable">$a</span> : å­—ç¬¦ä¸²é•¿åº¦ä¸º 0"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> : å­—ç¬¦ä¸²ä¸ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"<span class="variable">$a</span> : å­—ç¬¦ä¸²ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰§è¡Œè„šæœ¬ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>abc = efg: a ä¸ç­‰äº b<br>abc != efg : a ä¸ç­‰äº b<br>-z abc : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0<br>-n abc : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0<br>abc : å­—ç¬¦ä¸²ä¸ä¸ºç©º</p></blockquote><h2 id="æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦"><a href="#æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦" class="headerlink" title="æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦"></a>æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦</h2><p>æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦ç”¨äºæ£€æµ‹ Unix æ–‡ä»¶çš„å„ç§å±æ€§ã€‚</p><p>å±æ€§æ£€æµ‹æè¿°å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="left">æ“ä½œç¬¦</th><th align="left">è¯´æ˜</th><th align="left">ä¸¾ä¾‹</th></tr></thead><tbody><tr><td align="left">-b file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å—è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -b $file ] è¿”å› falseã€‚</td></tr><tr><td align="left">-c file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -c $file ] è¿”å› falseã€‚</td></tr><tr><td align="left">-d file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯ç›®å½•ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -d $file ] è¿”å› falseã€‚</td></tr><tr><td align="left">-f file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆæ—¢ä¸æ˜¯ç›®å½•ï¼Œä¹Ÿä¸æ˜¯è®¾å¤‡æ–‡ä»¶ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -f $file ] è¿”å› trueã€‚</td></tr><tr><td align="left">-g file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SGID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -g $file ] è¿”å› falseã€‚</td></tr><tr><td align="left">-k file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº†ç²˜ç€ä½(Sticky Bit)ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -k $file ] è¿”å› falseã€‚</td></tr><tr><td align="left">-p file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æœ‰åç®¡é“ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -p $file ] è¿”å› falseã€‚</td></tr><tr><td align="left">-u file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SUID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -u $file ] è¿”å› falseã€‚</td></tr><tr><td align="left">-r file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -r $file ] è¿”å› trueã€‚</td></tr><tr><td align="left">-w file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯å†™ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -w $file ] è¿”å› trueã€‚</td></tr><tr><td align="left">-x file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -x $file ] è¿”å› trueã€‚</td></tr><tr><td align="left">-s file</td><td align="left">æ£€æµ‹æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼ˆæ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº0ï¼‰ï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚</td><td align="left">[ -s $file ] è¿”å› trueã€‚</td></tr><tr><td align="left">-e file</td><td align="left">æ£€æµ‹æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚</td><td align="left">[ -e $file ] è¿”å› true</td></tr></tbody></table><p>å…¶ä»–æ£€æŸ¥ç¬¦ï¼š</p><ul><li><strong>-S</strong>: åˆ¤æ–­æŸæ–‡ä»¶æ˜¯å¦ socketã€‚</li><li><strong>-L</strong>: æ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚</li></ul><h3 id="å®ä¾‹-5"><a href="#å®ä¾‹-5" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>å˜é‡ file è¡¨ç¤ºæ–‡ä»¶ <strong>/var/www/runoob/test.sh</strong>ï¼Œå®ƒçš„å¤§å°ä¸º 100 å­—èŠ‚ï¼Œå…·æœ‰ <strong>rwx</strong> æƒé™ã€‚ä¸‹é¢çš„ä»£ç ï¼Œå°†æ£€æµ‹è¯¥æ–‡ä»¶çš„å„ç§å±æ€§ï¼š</p><figure class="highlight sh"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file=<span class="string">"/var/www/runoob/test.sh"</span></span><br><span class="line"><span class="keyword">if</span> [ -r <span class="variable">$file</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶å¯è¯»"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸å¯è¯»"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -w <span class="variable">$file</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶å¯å†™"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸å¯å†™"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -x <span class="variable">$file</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶å¯æ‰§è¡Œ"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸å¯æ‰§è¡Œ"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -f <span class="variable">$file</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸ºç‰¹æ®Šæ–‡ä»¶"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -d <span class="variable">$file</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶æ˜¯ä¸ªç›®å½•"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸æ˜¯ä¸ªç›®å½•"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -s <span class="variable">$file</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸ºç©º"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="variable">$file</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶å­˜åœ¨"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"æ–‡ä»¶ä¸å­˜åœ¨"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></tbody></table></figure><p>æ‰§è¡Œè„šæœ¬ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>æ–‡ä»¶å¯è¯»<br>æ–‡ä»¶å¯å†™<br>æ–‡ä»¶å¯æ‰§è¡Œ<br>æ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶<br>æ–‡ä»¶ä¸æ˜¯ä¸ªç›®å½•<br>æ–‡ä»¶ä¸ä¸ºç©º<br>æ–‡ä»¶å­˜åœ¨</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> shell </tag>
            
            <tag> sh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxåŸºç¡€</title>
      <link href="/2023/03/13/linux%E5%9F%BA%E7%A1%80/"/>
      <url>/2023/03/13/linux%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<blockquote><h6 id="åº•è¡Œæ¨¡å¼"><a href="#åº•è¡Œæ¨¡å¼" class="headerlink" title="åº•è¡Œæ¨¡å¼"></a>åº•è¡Œæ¨¡å¼</h6><ul><li><strong><font style="color : #95ba ">s/å­—ç¬¦ä¸²1/å­—ç¬¦ä¸²2</font></strong><ul><li>åªæ›¿æ¢è¿™è¡Œä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²1</li></ul></li><li><strong><font style="color : #95ba ">%s/å­—ç¬¦ä¸²1/å­—ç¬¦ä¸²2</font></strong><ul><li>æ›¿æ¢æ–‡ä»¶æ¯è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²1</li></ul></li><li><strong><font style="color : #95ba ">%s/å­—ç¬¦ä¸²1/å­—ç¬¦ä¸²2/g</font></strong><ul><li>æ›¿æ¢æ–‡ä»¶ä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²1</li></ul></li><li><strong><font style="color : #95ba ">set mouse=a </font></strong><ul><li>è®©å…‰æ ‡è·Ÿç€é¼ æ ‡ç§»åŠ¨</li></ul></li><li><strong><font style="color : #95ba ">set mouse-=a</font></strong><ul><li>è®©è´¯æ ‡ä¸è¦è·Ÿç€é¼ æ ‡ç§»åŠ¨</li></ul></li></ul><h6 id="vsp"><a href="#vsp" class="headerlink" title="vsp"></a>vsp</h6><ul><li>vsp +æ–‡ä»¶å<ul><li>åœ¨çª—å£çš„ä¸­å†æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸¤è¾¹åŒæ—¶æ‰“å¼€</li></ul></li><li>ctrl+w<ul><li>åˆ‡æ¢çª—å£</li></ul></li></ul><h5 id="ç¼©è¿›ï¼š"><a href="#ç¼©è¿›ï¼š" class="headerlink" title="ç¼©è¿›ï¼š"></a>ç¼©è¿›ï¼š</h5><ul><li>å‘½ä»¤è¡Œæ¨¡å¼ï¼šgg=G</li><li>å¯è§†åŒ–æ¨¡å¼ï¼švï¼Œä¸Šä¸‹é”®é€‰ä¸­è¦å¯¹é½çš„ä»£ç ï¼ŒæŒ‰ =</li></ul><p>åº•è¡Œæ¨¡å¼ï¼šset number ä¸æ˜¾ç¤ºè¡Œå·ï¼Œset number n æ˜¾ç¤ºè¡Œå·</p></blockquote><h4 id="gccç¼–è¯‘å™¨"><a href="#gccç¼–è¯‘å™¨" class="headerlink" title="gccç¼–è¯‘å™¨"></a>gccç¼–è¯‘å™¨</h4><blockquote><ol><li><strong><font style="color : #95ba ">é¢„å¤„ç†</font></strong> -E <ol><li>å¤„ç†å¤´æ–‡ä»¶å’Œå®å®šä¹‰<ul><li>gcc -E 1.c -o 1.i</li></ul></li></ol></li><li><strong><font style="color : #95ba ">ç¼–è¯‘</font></strong> -S<ol><li>æ£€æŸ¥ä»£ç çš„é”™è¯¯<ul><li>gcc -S 1.i -o 1.s</li></ul></li></ol></li><li><strong><font style="color : #95ba ">æ±‡ç¼–</font></strong> -c<ol><li>å°†æ–‡ä»¶ç¼–ç¨‹è®¡ç®—æœºèƒ½å¤Ÿè¯†åˆ«çš„äºŒè¿›åˆ¶æ–‡ä»¶<ul><li>gcc -c 1.s -o 1.o</li></ul></li></ol></li><li><strong><font style="color : #95ba ">é“¾æ¥</font></strong><ol><li>ç”Ÿäº§æ‰§è¡Œæ–‡ä»¶<ul><li>gcc 1.o -o 1.out</li></ul></li></ol></li><li><strong><font style="color : #95ba ">é€‰é¡¹</font></strong><ul><li>-o<ul><li>ä¿®æ”¹æ‰§è¡Œæ–‡ä»¶å</li></ul></li><li>-Wall<ul><li>æ˜¾ç¤ºæ‰€æœ‰è­¦å‘Š</li></ul></li><li>-w<ul><li>éšè—æ‰€æœ‰è­¦å‘Š</li></ul></li></ul></li></ol></blockquote><h4 id="æ–‡ä»¶ç®¡ç†"><a href="#æ–‡ä»¶ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç®¡ç†"></a>æ–‡ä»¶ç®¡ç†</h4><blockquote><ol><li><p><strong><font style="color : #95ba ">chmod â€”ä¿®æ”¹æ–‡ä»¶æƒé™</font></strong></p><ul><li>u  â€“ç”¨æˆ·è‡ªå·±</li><li>g  â€“ ç”¨æˆ·ç»„</li><li>o  â€“å…¶ä»–ç”¨æˆ·</li></ul><ol><li>chmod u+x æ–‡ä»¶å   â€”ç»™å½“å‰ç”¨æˆ·å¢åŠ æ‰§è¡Œæƒé™</li><li>chmod +x æ–‡ä»¶å   â€”ç»™æ‰€æœ‰ç”¨æˆ·å¢åŠ æ‰§è¡Œæƒé™</li><li>chmod -x æ–‡ä»¶å    â€”ç»™æ‰€æœ‰ç”¨æˆ·å‡å»æ‰§è¡Œæƒé™</li></ol></li><li><p><strong><font style="color : #95ba ">ç¡¬é“¾æ¥</font></strong></p><ol><li><p>ç”¨æ³•</p><ul><li>ln æ–‡ä»¶å è¿æ¥æ–‡ä»¶å<ul><li>å¦‚æœæŠŠæœ¬ä½“æ–‡ä»¶åˆ æ‰ï¼Œä¾æ—§å¯ä»¥å•ç‹¬è¯•ç”¨ï¼Œç±»å‹å’ŒåŸæ–‡ä»¶ä¸€æ¨¡ä¸€æ ·ï¼Œç§»åŠ¨æºæ–‡ä»¶ä¹Ÿä¾æ—§å¯ä»¥</li></ul></li></ul></li><li><p>é€‰é¡¹ -s  â€”æ”¹æˆè½¯è¿æ¥</p><ul><li>ln -s æ–‡ä»¶å è½¯è¿æ¥æ–‡ä»¶å<ul><li>å¦‚æœæœ¬ä½“æ–‡ä»¶åˆ é™¤æˆ–è€…ç§»åŠ¨ï¼Œè½¯è¿æ¥å¤±æ•ˆï¼›å¤§å¤§ç¼©å°äº†æ–‡ä»¶çš„å¤§å°</li></ul></li></ul></li></ol></li></ol></blockquote><h4 id="æ–‡ä»¶çš„å‹ç¼©å’Œè§£å‹"><a href="#æ–‡ä»¶çš„å‹ç¼©å’Œè§£å‹" class="headerlink" title="æ–‡ä»¶çš„å‹ç¼©å’Œè§£å‹"></a>æ–‡ä»¶çš„å‹ç¼©å’Œè§£å‹</h4><blockquote><ol><li><p><strong><font style="color : #95ba ">gzipå’Œgunzip</font></strong></p><ul><li>æºæ–‡ä»¶è¢«æ›¿æ¢æˆä¹‹åçš„æ–‡ä»¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.gzçš„å‹ç¼©æ–‡ä»¶ï¼Œç”¨vièƒ½çœ‹åˆ°æºæ–‡ä»¶å†…å®¹ï¼Œç”¨catåœ¨ç»ˆç«¯æŸ¥çœ‹ä¹±ç </li></ul></li><li><p><strong><font style="color : #95ba ">bzip2å’Œbunzip2</font></strong></p><ul><li>ç›¸æ¯”äºgzipï¼Œå‹ç¼©æ€§èƒ½è¾ƒå¼±ï¼Œä½†æ˜¯æ—¶é—´å¿«</li></ul></li><li><p><strong><font style="color : #95ba ">xzå’Œunxz</font></strong></p><ul><li>åŒç¬¬äºŒä¸ª</li></ul></li></ol></blockquote><h4 id="tar-å½’æ¡£å’Œé‡Šæ”¾"><a href="#tar-å½’æ¡£å’Œé‡Šæ”¾" class="headerlink" title="tar-å½’æ¡£å’Œé‡Šæ”¾"></a>tar-å½’æ¡£å’Œé‡Šæ”¾</h4><blockquote><p><strong><font style="color : #95ba ">tar</font></strong></p><ul><li>é€‰é¡¹<ul><li>-c   åˆ›å»ºå½’æ¡£æ–‡ä»¶</li><li>-v   æ˜¾ç¤ºå½’æ¡£æˆ–è€…é‡Šæ”¾è¿‡ç¨‹</li><li>-x   é‡Šæ”¾å½’æ¡£æ–‡ä»¶</li><li>-f   ç”¨æˆ·æŒ‡å®šå½’æ¡£æ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤åç§°   .tar</li><li>-j   ä»¥bzip2æ–¹å¼å‹ç¼©</li><li>-z   ä»¥gzipæ–¹å¼å‹ç¼©</li></ul></li><li>ä½¿ç”¨<ul><li>tar -czvf å‹ç¼©æˆ–å½’æ¡£ä¹‹åçš„æ–‡ä»¶å ç›®æ ‡æ–‡ä»¶å</li><li>tar -xvf  è¦é‡Šæ”¾ä¹‹åçš„æ–‡ä»¶å ç›®æ ‡æ–‡ä»¶å</li></ul></li></ul></blockquote><h4 id="diffï¼ˆæ²¡å•¥ç”¨ï¼‰"><a href="#diffï¼ˆæ²¡å•¥ç”¨ï¼‰" class="headerlink" title="diffï¼ˆæ²¡å•¥ç”¨ï¼‰"></a>diffï¼ˆæ²¡å•¥ç”¨ï¼‰</h4><blockquote><p>ä½œç”¨ï¼šåˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ç›¸åŒï¼Œç›¸åŒæ²¡æœ‰è¾“å‡ºç»“æ„ã€‚</p></blockquote><h4 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h4><blockquote><ul><li><p>ä½œç”¨ï¼šæŸ¥è¯¢çš„å­—ç¬¦ä¸²ï¼ŒæŸ¥è¯¢æ–‡ä»¶åâ€”æŸ¥è¯¢ç‰¹å®šæ–‡ä»¶çš„å†…å®¹</p></li><li><p>é€‰é¡¹</p><ul><li>grep -r æŸ¥è¯¢çš„å­—ç¬¦ä¸²  è·¯å¾„ â€” æŸ¥è¯¢ä¸€ä¸ªè·¯å¾„ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹</li></ul></li></ul></blockquote><h4 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h4><blockquote><ul><li>ä½œç”¨ï¼šæŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</li><li>é€‰é¡¹ï¼š<ul><li>-lï¼šæŸ¥çœ‹è¡Œæ•°</li><li>-wï¼šæŸ¥çœ‹å•è¯ä¸ªæ•°</li><li>-cï¼šæŸ¥çœ‹å­—ç¬¦ä¸ªæ•°</li></ul></li></ul><p><img src="https://typora-1304577690.cos.ap-chengdu.myqcloud.com/image-20230314101405099.png" alt="image-20230314101405099"></p></blockquote><h4 id="ä¸‹è½½å·¥å…·"><a href="#ä¸‹è½½å·¥å…·" class="headerlink" title="ä¸‹è½½å·¥å…·"></a>ä¸‹è½½å·¥å…·</h4><blockquote><ol><li><strong><font style="color : #95ba ">dpkgå·¥å…·</font></strong><ul><li>ç¦»çº¿ä¸‹è½½</li><li>ä¸‹è½½<ul><li>sudo dpkg -i å®‰è£…åŒ…</li></ul></li><li>å¸è½½<ul><li>sudo dpkg -r è½¯ä»¶å</li></ul></li></ul></li><li><strong><font style="color : #95ba ">aptå·¥å…·</font></strong><ul><li>åœ¨çº¿ä¸‹è½½<ul><li>apt install cmatrix â€”- ä»£ç é›¨</li><li>apt install lolcat â€”- å½©è‰²æ–‡å­—</li><li>apt install fortunes-zh â€” æ–‡ç« </li></ul></li></ul></li></ol></blockquote><h4 id="ç”¨æˆ·ç®¡ç†"><a href="#ç”¨æˆ·ç®¡ç†" class="headerlink" title="ç”¨æˆ·ç®¡ç†"></a>ç”¨æˆ·ç®¡ç†</h4><blockquote><ol><li><strong><font style="color : #95ba ">åˆ‡æ¢ç”¨æˆ·</font></strong><ul><li>su ç”¨æˆ·å</li></ul></li><li><strong><font style="color : #95ba ">æŸ¥çœ‹ç”¨æˆ·</font></strong><ul><li>vi /etc/passwd</li></ul></li><li><strong><font style="color : #95ba ">æŸ¥çœ‹ç”¨æˆ·ç»„</font></strong><ul><li>vi /etc/group</li></ul></li><li><strong><font style="color : #95ba ">æ·»åŠ ç”¨æˆ·</font></strong><ul><li>adduser ç”¨æˆ·å</li></ul></li><li><strong><font style="color : #95ba ">åˆ é™¤ç”¨æˆ·</font></strong><ul><li>deluser ç”¨æˆ·å</li><li>ä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬è¿›å…¥passwdå’Œgroupä¸¤ä¸ªæ–‡ä»¶å»åˆ é™¤</li></ul></li></ol></blockquote><h4 id="è¿›ç¨‹ç®¡ç†"><a href="#è¿›ç¨‹ç®¡ç†" class="headerlink" title="è¿›ç¨‹ç®¡ç†"></a>è¿›ç¨‹ç®¡ç†</h4><blockquote><ol><li><strong><font style="color : #95ba ">ps</font></strong><ul><li>ä½œç”¨ï¼šå‰å°è¿›ç¨‹</li><li>é€‰é¡¹<ul><li>ps -aux æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹</li></ul></li></ul></li><li><strong><font style="color : #95ba ">pstree</font></strong><ul><li>ä½œç”¨ï¼šæ ‘å½¢å±•ç¤º</li></ul></li><li><strong><font style="color : #95ba ">kill -9 &lt;è¿›ç¨‹å·&gt;</font></strong><ul><li>ä½œç”¨ï¼šç»“æŸè¿›ç¨‹</li></ul></li><li><strong><font style="color : #95ba ">top</font></strong><ul><li>ä½œç”¨ï¼šæŸ¥çœ‹è¿›ç¨‹ï¼ˆä»å ç”¨cpuæœ€å¤§çš„å¼€å§‹å±•ç¤º)ï¼Œç±»ä¼¼äºä»»åŠ¡ç®¡ç†å™¨</li></ul></li></ol></blockquote><h4 id="shutdown"><a href="#shutdown" class="headerlink" title="shutdown"></a>shutdown</h4><blockquote><ul><li>shutdown <ul><li>ä½œç”¨ï¼šå…³æœº</li><li>shutdown -r now é‡å¯</li></ul></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°å­—ç”µè·¯</title>
      <link href="/2023/03/08/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/"/>
      <url>/2023/03/08/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> åµŒå…¥å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°å­—ç”µè·¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringMVC</title>
      <link href="/2021/09/21/SpringMVC/"/>
      <url>/2021/09/21/SpringMVC/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h1><p>ssmï¼šmybatis + Spring + SpringMVC <strong>MVCä¸‰å±‚æ¶æ„</strong></p><p>JavaSEï¼šè®¤çœŸå­¦ä¹ ï¼Œ è€å¸ˆå¸¦ï¼Œå…¥é—¨å¿«</p><p>JavaWebï¼šè®¤çœŸå­¦ä¹ ï¼Œè€å¸ˆå¸¦ï¼Œå…¥é—¨å¿«</p><p>SSMæ¡†æ¶ï¼šç ”ç©¶å®˜æ–¹æ–‡æ¡£,é”»ç‚¼è‡ªå­¦èƒ½åŠ›ï¼Œé”»ç‚¼ç¬”è®°èƒ½åŠ›ï¼Œé”»ç‚¼é¡¹ç›®èƒ½åŠ›</p><p>SpringMVC + Vue +SpringBoot + SpringCloud + Linux</p><p>SSM = javaWebåšé¡¹ç›®</p><p>Springï¼šIOCå’ŒAOP</p><p>SpringMVCï¼šSpringMVCçš„æ‰§è¡Œæµç¨‹ï¼</p><p>SpringMVC ï¼šSSMæ¡†æ¶æ•´åˆï¼</p><p>MVCï¼šæ¨¡å‹ï¼ˆdaoï¼Œserviceï¼‰ è§†å›¾ ï¼ˆjspï¼‰æ§åˆ¶å™¨ï¼ˆServletï¼‰</p><p>dao</p><p>service</p><p>servletï¼šè½¬å‘ï¼Œé‡å®šå‘</p><p>jsp/html</p><p>JSP ï¼šæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªServlet</p><p>å‡è®¾ï¼šä½ çš„é¡¹ç›®çš„æ¶æ„ï¼Œæ˜¯è®¾è®¡å¥½çš„ï¼Œè¿˜æ˜¯æ¼”è¿›çš„ï¼Ÿ</p><p>ä¸€å®šæ˜¯æ¼”è¿›çš„</p><h2 id="å›é¡¾servlet"><a href="#å›é¡¾servlet" class="headerlink" title="å›é¡¾servlet"></a>å›é¡¾servlet</h2><p><strong>å¯¼å…¥ä¾èµ–</strong></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å¯¼å…¥ä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>æœ‰ä¸€ä¸ªjsp-apiæ²¡æœ‰</p><p><strong>å»ºç«‹servlet</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException {</span><br><span class="line">        resp.setContentType(<span class="string">"text/html;charset=utf-8"</span>);<span class="comment">//è§£å†³ä¸­æ–‡ä¹±ç </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.è·å–å‰ç«¯å‚æ•°</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> req.getParameter(<span class="string">"method"</span> );</span><br><span class="line">        <span class="keyword">if</span> (method.equals(<span class="string">"add"</span>)) {</span><br><span class="line">            req.getSession().setAttribute(<span class="string">"msg"</span>, <span class="string">"æ‰§è¡Œäº†addæ–¹æ³•"</span>);</span><br><span class="line">            <span class="keyword">if</span> (method.equals(<span class="string">"delete"</span>)) {</span><br><span class="line">                req.getSession().setAttribute(<span class="string">"msg"</span>, <span class="string">"æ‰§è¡Œäº†deleteæ–¹æ³•"</span>);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.è°ƒç”¨ä¸šåŠ¡å±‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.è§†å›¾è½¬å‘æˆ–è€…é‡å®šå‘</span></span><br><span class="line">        req.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/test.jsp"</span>).forward(req,resp);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException {</span><br><span class="line">        doGet(req, resp);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>web.xmlä¸­æ³¨å†Œservlet</strong></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.miaobuyi.servlet.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p><strong>åœ¨å‰ç«¯ä¸­å‘èµ·è¯·æ±‚</strong></p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">  Created by IntelliJ IDEA.</span><br><span class="line">  User: æ¨å®‡</span><br><span class="line">  Date: <span class="number">2021</span>/<span class="number">9</span>/<span class="number">13</span></span><br><span class="line">  Time: <span class="number">9</span>:<span class="number">55</span></span><br><span class="line">  To change <span class="built_in">this</span> template use File | Settings | File Templates.</span><br><span class="line">--%&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"/hello"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span> name=<span class="string">"method"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p><strong>MVCæ¡†æ¶è¦åšå“ªäº›äº‹æƒ…</strong></p><ol><li>å°†ur|æ˜ å°„åˆ°javaç±»æˆ–javaç±»çš„æ–¹æ³•</li><li>å°è£…ç”¨æˆ·æäº¤çš„æ•°æ®</li><li>å¤„ç†è¯·æ±‚â€“è°ƒç”¨ç›¸å…³çš„ä¸šåŠ¡å¤„ç†â€“å°è£…å“åº”æ•°æ®</li><li>å°†å“åº”çš„æ•°æ®è¿›è¡Œæ¸²æŸ“. jsp/ htmlç­‰è¡¨ç¤ºå±‚æ•°æ®</li></ol><p><strong>SrpingMVCçš„ç‰¹ç‚¹</strong>ï¼š</p><ol><li>è½»é‡çº§ï¼Œç®€å•æ˜“å­¦</li><li>é«˜æ•ˆï¼ŒåŸºäºè¯·æ±‚å“åº”çš„MVCæ¡†æ¶</li><li>ä¸Springå…¼å®¹æ€§å¥½ï¼Œæ— ç¼é›†åˆ</li><li>çº¦å®šä¼˜äºé…ç½®</li><li>åŠŸèƒ½å¼ºå¤§ï¼šRESTfulï¼Œæ•°æ®éªŒè¯ï¼Œæ ¼å¼åŒ–ï¼Œæœ¬åœ°åŒ–ï¼Œä¸»é¢˜ç­‰</li><li>ç®€ä»‹çµæ´»</li></ol><h2 id="ä¸€ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº"><a href="#ä¸€ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº" class="headerlink" title="ä¸€ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº"></a>ä¸€ã€ç¬¬ä¸€ä¸ªMVCç¨‹åº</h2><h3 id="é…ç½®ç‰ˆ"><a href="#é…ç½®ç‰ˆ" class="headerlink" title="é…ç½®ç‰ˆ"></a>é…ç½®ç‰ˆ</h3><p>1ã€æ–°å»ºä¸€ä¸ªMoudle ï¼Œ springmvc-02-hello ï¼Œ æ·»åŠ webçš„æ”¯æŒï¼</p><p>2ã€ç¡®å®šå¯¼å…¥äº†SpringMVC çš„ä¾èµ–ï¼</p><p>3ã€é…ç½®web.xml  ï¼Œ æ³¨å†ŒDispatcherServlet</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--1.æ³¨å†ŒDispatcherServlet--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--å…³è”ä¸€ä¸ªspringmvcçš„é…ç½®æ–‡ä»¶:ã€servlet-nameã€‘-servlet.xml--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--å¯åŠ¨çº§åˆ«-1--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--/ åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆä¸åŒ…æ‹¬.jspï¼‰--&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--/* åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆåŒ…æ‹¬.jspï¼‰--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>4ã€ç¼–å†™SpringMVC çš„ é…ç½®æ–‡ä»¶ï¼åç§°ï¼šspringmvc-servlet.xml  : [servletname]-servlet.xml</p><p>è¯´æ˜ï¼Œè¿™é‡Œçš„åç§°è¦æ±‚æ˜¯æŒ‰ç…§å®˜æ–¹æ¥çš„</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>5ã€æ·»åŠ  å¤„ç†å™¨æ˜ å°„å™¨</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>6ã€æ·»åŠ  å¤„ç†å™¨é€‚é…å™¨</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>7ã€æ·»åŠ  è§†å›¾è§£æå™¨</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!--è§†å›¾è§£æå™¨:DispatcherServletç»™ä»–çš„ModelAndView--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span> <span class="attr">id</span>=<span class="string">"InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--å‰ç¼€--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--åç¼€--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>8ã€ç¼–å†™æˆ‘ä»¬è¦æ“ä½œä¸šåŠ¡Controller ï¼Œè¦ä¹ˆå®ç°Controlleræ¥å£ï¼Œè¦ä¹ˆå¢åŠ æ³¨è§£ï¼›éœ€è¦è¿”å›ä¸€ä¸ªModelAndViewï¼Œè£…æ•°æ®ï¼Œå°è§†å›¾ï¼›</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬å…ˆå¯¼å…¥Controlleræ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> <span class="keyword">implements</span> <span class="title class_">Controller</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> ModelAndView <span class="title function_">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="comment">//ModelAndView æ¨¡å‹å’Œè§†å›¾</span></span><br><span class="line">       <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//å°è£…å¯¹è±¡ï¼Œæ”¾åœ¨ModelAndViewä¸­ã€‚Model</span></span><br><span class="line">       mv.addObject(<span class="string">"msg"</span>,<span class="string">"HelloSpringMVC!"</span>);</span><br><span class="line">       <span class="comment">//å°è£…è¦è·³è½¬çš„è§†å›¾ï¼Œæ”¾åœ¨ModelAndViewä¸­</span></span><br><span class="line">       mv.setViewName(<span class="string">"hello"</span>); <span class="comment">//: /WEB-INF/jsp/hello.jsp</span></span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>9ã€å°†è‡ªå·±çš„ç±»äº¤ç»™SpringIOCå®¹å™¨ï¼Œæ³¨å†Œbean</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--Handler--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"/hello"</span> <span class="attr">class</span>=<span class="string">"com.kuang.controller.HelloController"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>10ã€å†™è¦è·³è½¬çš„jspé¡µé¢ï¼Œæ˜¾ç¤ºModelandViewå­˜æ”¾çš„æ•°æ®ï¼Œä»¥åŠæˆ‘ä»¬çš„æ­£å¸¸é¡µé¢ï¼›</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">${msg}</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>11ã€é…ç½®Tomcat å¯åŠ¨æµ‹è¯•ï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7IicxBZbkh0D4dJJiaXSzGEXyMkHnqOKmXfLlOAOV7vFBtsDVX1libCnlXwtCN3BGIxWkic8QVe9wD2nA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p><strong>å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼šè®¿é—®å‡ºç°404ï¼Œæ’æŸ¥æ­¥éª¤ï¼š</strong></p><ol><li>æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼Œçœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯ç¼ºå°‘äº†ä»€ä¹ˆjaråŒ…ã€‚</li><li>å¦‚æœjaråŒ…å­˜åœ¨ï¼Œæ˜¾ç¤ºæ— æ³•è¾“å‡ºï¼Œå°±åœ¨IDEAçš„é¡¹ç›®å‘å¸ƒä¸­ï¼Œæ·»åŠ libä¾èµ–ï¼</li><li>é‡å¯Tomcat å³å¯è§£å†³ï¼</li></ol><p>å°ç»“ï¼šçœ‹è¿™ä¸ªä¼°è®¡å¤§éƒ¨åˆ†åŒå­¦éƒ½èƒ½ç†è§£å…¶ä¸­çš„åŸç†äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å®é™…å¼€å‘æ‰ä¸ä¼šè¿™ä¹ˆå†™ï¼Œä¸ç„¶å°±ç–¯äº†ï¼Œè¿˜å­¦è¿™ä¸ªç©æ„å¹²å˜›ï¼æˆ‘ä»¬æ¥çœ‹ä¸ªæ³¨è§£ç‰ˆå®ç°ï¼Œè¿™æ‰æ˜¯SpringMVCçš„ç²¾é«“ï¼Œåˆ°åº•æœ‰å¤šä¹ˆç®€å•ï¼Œçœ‹è¿™ä¸ªå›¾å°±çŸ¥é“äº†ã€‚</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7IicxBZbkh0D4dJJiaXSzGEXyoSJbC4E1L3euOFzcEzSF0fn4gzjNbpwyXLQCrbLYarJ46HxwC8qz5w/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><h3 id="æ³¨è§£ç‰ˆ"><a href="#æ³¨è§£ç‰ˆ" class="headerlink" title="æ³¨è§£ç‰ˆ"></a>æ³¨è§£ç‰ˆ</h3><p>1ã€æ–°å»ºä¸€ä¸ªMoudleï¼Œspringmvc-03-hello-annotation ã€‚æ·»åŠ webæ”¯æŒï¼</p><p>2ã€ç”±äºMavenå¯èƒ½å­˜åœ¨èµ„æºè¿‡æ»¤çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°†é…ç½®å®Œå–„</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>3ã€åœ¨pom.xmlæ–‡ä»¶å¼•å…¥ç›¸å…³çš„ä¾èµ–ï¼šä¸»è¦æœ‰Springæ¡†æ¶æ ¸å¿ƒåº“ã€Spring MVCã€servlet , JSTLç­‰ã€‚æˆ‘ä»¬åœ¨çˆ¶ä¾èµ–ä¸­å·²ç»å¼•å…¥äº†ï¼</p><p>4ã€é…ç½®web.xml</p><p>æ³¨æ„ç‚¹ï¼š</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--1.æ³¨å†Œservlet--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›è¡Œå…³è”--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å¯åŠ¨é¡ºåºï¼Œæ•°å­—è¶Šå°ï¼Œå¯åŠ¨è¶Šæ—© --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«springmvcæ‹¦æˆª --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p><strong>/ å’Œ /* çš„åŒºåˆ«ï¼š</strong>&lt; url-pattern &gt; / &lt;/ url-pattern &gt; ä¸ä¼šåŒ¹é…åˆ°.jspï¼Œ åªé’ˆå¯¹æˆ‘ä»¬ç¼–å†™çš„è¯·æ±‚ï¼›å³ï¼š.jsp ä¸ä¼šè¿›å…¥springçš„ DispatcherServletç±» ã€‚&lt; url-pattern &gt; /* &lt;/ url-pattern &gt; ä¼šåŒ¹é… *.jspï¼Œä¼šå‡ºç°è¿”å› jspè§†å›¾ æ—¶å†æ¬¡è¿›å…¥springçš„DispatcherServlet ç±»ï¼Œå¯¼è‡´æ‰¾ä¸åˆ°å¯¹åº”çš„controlleræ‰€ä»¥æŠ¥404é”™ã€‚</p><ol><li><ul><li>æ³¨æ„web.xmlç‰ˆæœ¬é—®é¢˜ï¼Œè¦æœ€æ–°ç‰ˆï¼</li><li>æ³¨å†ŒDispatcherServlet</li><li>å…³è”SpringMVCçš„é…ç½®æ–‡ä»¶</li><li>å¯åŠ¨çº§åˆ«ä¸º1</li><li>æ˜ å°„è·¯å¾„ä¸º / ã€ä¸è¦ç”¨/*ï¼Œä¼š404ã€‘</li></ul></li></ol><p>5ã€æ·»åŠ Spring MVCé…ç½®æ–‡ä»¶</p><p>åœ¨resourceç›®å½•ä¸‹æ·»åŠ springmvc-servlet.xmlé…ç½®æ–‡ä»¶ï¼Œé…ç½®çš„å½¢å¼ä¸Springå®¹å™¨é…ç½®åŸºæœ¬ç±»ä¼¼ï¼Œä¸ºäº†æ”¯æŒåŸºäºæ³¨è§£çš„IOCï¼Œè®¾ç½®äº†è‡ªåŠ¨æ‰«æåŒ…çš„åŠŸèƒ½ï¼Œå…·ä½“é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š</p><ol><li><pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>mvc</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/mvc<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans.xsd       http://www.springframework.org/schema/context       https://www.springframework.org/schema/context/spring-context.xsd       http://www.springframework.org/schema/mvc       https://www.springframework.org/schema/mvc/spring-mvc.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- è‡ªåŠ¨æ‰«æåŒ…ï¼Œè®©æŒ‡å®šåŒ…ä¸‹çš„æ³¨è§£ç”Ÿæ•ˆ,ç”±IOCå®¹å™¨ç»Ÿä¸€ç®¡ç† --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.kuang.controller<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token comment" spellcheck="true">&lt;!-- è®©Spring MVCä¸å¤„ç†é™æ€èµ„æº --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>default-servlet-handler</span> <span class="token punctuation">/></span></span>   <span class="token comment" spellcheck="true">&lt;!--   æ”¯æŒmvcæ³¨è§£é©±åŠ¨       åœ¨springä¸­ä¸€èˆ¬é‡‡ç”¨@RequestMappingæ³¨è§£æ¥å®Œæˆæ˜ å°„å…³ç³»       è¦æƒ³ä½¿@RequestMappingæ³¨è§£ç”Ÿæ•ˆ       å¿…é¡»å‘ä¸Šä¸‹æ–‡ä¸­æ³¨å†ŒDefaultAnnotationHandlerMapping       å’Œä¸€ä¸ªAnnotationMethodHandlerAdapterå®ä¾‹       è¿™ä¸¤ä¸ªå®ä¾‹åˆ†åˆ«åœ¨ç±»çº§åˆ«å’Œæ–¹æ³•çº§åˆ«å¤„ç†ã€‚       è€Œannotation-drivené…ç½®å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨å®Œæˆä¸Šè¿°ä¸¤ä¸ªå®ä¾‹çš„æ³¨å…¥ã€‚    --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span> <span class="token punctuation">/></span></span>   <span class="token comment" spellcheck="true">&lt;!-- è§†å›¾è§£æå™¨ --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.InternalResourceViewResolver<span class="token punctuation">"</span></span>         <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>internalResourceViewResolver<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       <span class="token comment" spellcheck="true">&lt;!-- å‰ç¼€ --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>prefix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/WEB-INF/jsp/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>       <span class="token comment" spellcheck="true">&lt;!-- åç¼€ --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>suffix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.jsp<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>highlight plaintext<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>code<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>2. åœ¨è§†å›¾è§£æå™¨ä¸­æˆ‘ä»¬æŠŠæ‰€æœ‰çš„è§†å›¾éƒ½å­˜æ”¾åœ¨/WEB-INF/ç›®å½•ä¸‹ï¼Œè¿™æ ·å¯ä»¥ä¿è¯è§†å›¾å®‰å…¨ï¼Œå› ä¸ºè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥è®¿é—®ã€‚<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>3. - è®©IOCçš„æ³¨è§£ç”Ÿæ•ˆ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   - é™æ€èµ„æºè¿‡æ»¤ ï¼šHTML . JS . CSS . å›¾ç‰‡ ï¼Œ è§†é¢‘ .....<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   - MVCçš„æ³¨è§£é©±åŠ¨<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   - é…ç½®è§†å›¾è§£æå™¨<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>6ã€åˆ›å»ºController<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>1. ç¼–å†™ä¸€ä¸ªJavaæ§åˆ¶ç±»ï¼šcom.kuang.controller.HelloController , æ³¨æ„ç¼–ç è§„èŒƒ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>2. ```java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   package com.kuang.controller;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   import org.springframework.stereotype.Controller;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   import org.springframework.ui.Model;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   import org.springframework.web.bind.annotation.RequestMapping;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   @Controller<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   @RequestMapping("/HelloController")<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   public class HelloController {<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      //çœŸå®è®¿é—®åœ°å€ : é¡¹ç›®å/HelloController/hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      @RequestMapping("/hello")<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      public String sayHello(Model model){<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          //å‘æ¨¡å‹ä¸­æ·»åŠ å±æ€§msgä¸å€¼ï¼Œå¯ä»¥åœ¨JSPé¡µé¢ä¸­å–å‡ºå¹¶æ¸²æŸ“<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          model.addAttribute("msg","hello,SpringMVC");<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          //web-inf/jsp/hello.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>          return "hello";<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>     }<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   }<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span></code></pre></li><li><ul><li>@Controlleræ˜¯ä¸ºäº†è®©Spring IOCå®¹å™¨åˆå§‹åŒ–æ—¶è‡ªåŠ¨æ‰«æåˆ°ï¼›</li><li>@RequestMappingæ˜¯ä¸ºäº†æ˜ å°„è¯·æ±‚è·¯å¾„ï¼Œè¿™é‡Œå› ä¸ºç±»ä¸æ–¹æ³•ä¸Šéƒ½æœ‰æ˜ å°„æ‰€ä»¥è®¿é—®æ—¶åº”è¯¥æ˜¯/HelloController/helloï¼›</li><li>æ–¹æ³•ä¸­å£°æ˜Modelç±»å‹çš„å‚æ•°æ˜¯ä¸ºäº†æŠŠActionä¸­çš„æ•°æ®å¸¦åˆ°è§†å›¾ä¸­ï¼›</li><li>æ–¹æ³•è¿”å›çš„ç»“æœæ˜¯è§†å›¾çš„åç§°helloï¼ŒåŠ ä¸Šé…ç½®æ–‡ä»¶ä¸­çš„å‰åç¼€å˜æˆWEB-INF/jsp/<strong>hello</strong>.jspã€‚</li></ul></li></ol><p>7ã€åˆ›å»ºè§†å›¾å±‚</p><ol><li><p>åœ¨WEB-INF/ jspç›®å½•ä¸­åˆ›å»ºhello.jsp ï¼Œ è§†å›¾å¯ä»¥ç›´æ¥å–å‡ºå¹¶å±•ç¤ºä»Controllerå¸¦å›çš„ä¿¡æ¯ï¼›</p></li><li><p>å¯ä»¥é€šè¿‡ELè¡¨ç¤ºå–å‡ºModelä¸­å­˜æ”¾çš„å€¼ï¼Œæˆ–è€…å¯¹è±¡ï¼›</p></li><li><p>```html<br>&lt;%@ page contentType=â€text/html;charset=UTF-8â€ language=â€javaâ€ %&gt;</p>   <title></title>${msg}<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line"></span><br><span class="line">**8ã€é…ç½®Tomcatè¿è¡Œ**</span><br><span class="line"></span><br><span class="line">é…ç½®Tomcat ï¼Œ  å¼€å¯æœåŠ¡å™¨ ï¼Œ è®¿é—® å¯¹åº”çš„è¯·æ±‚è·¯å¾„ï¼</span><br><span class="line"></span><br><span class="line">![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7IicxBZbkh0D4dJJiaXSzGEXy3eJXYyibMOnIWqqye9RYfu4zdnE5oYmxiaUHaxAnvZkVEXlyXysRMhTg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)</span><br><span class="line"></span><br><span class="line">**OKï¼Œè¿è¡ŒæˆåŠŸï¼**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### å°ç»“</span><br><span class="line"></span><br><span class="line">å®ç°æ­¥éª¤å…¶å®éå¸¸çš„ç®€å•ï¼š</span><br><span class="line"></span><br><span class="line">1. æ–°å»ºä¸€ä¸ªwebé¡¹ç›®</span><br><span class="line">2. å¯¼å…¥ç›¸å…³jaråŒ…</span><br><span class="line">3. ç¼–å†™web.xml , æ³¨å†ŒDispatcherServlet</span><br><span class="line">4. ç¼–å†™springmvcé…ç½®æ–‡ä»¶</span><br><span class="line">5. æ¥ä¸‹æ¥å°±æ˜¯å»åˆ›å»ºå¯¹åº”çš„æ§åˆ¶ç±» , controller</span><br><span class="line">6. æœ€åå®Œå–„å‰ç«¯è§†å›¾å’Œcontrollerä¹‹é—´çš„å¯¹åº”</span><br><span class="line">7. æµ‹è¯•è¿è¡Œè°ƒè¯•.</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨springMVCå¿…é¡»é…ç½®çš„ä¸‰å¤§ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">**å¤„ç†å™¨æ˜ å°„å™¨ã€å¤„ç†å™¨é€‚é…å™¨ã€è§†å›¾è§£æå™¨**</span><br><span class="line"></span><br><span class="line">é€šå¸¸ï¼Œæˆ‘ä»¬åªéœ€è¦**æ‰‹åŠ¨é…ç½®è§†å›¾è§£æå™¨**ï¼Œè€Œ**å¤„ç†å™¨æ˜ å°„å™¨**å’Œ**å¤„ç†å™¨é€‚é…å™¨**åªéœ€è¦å¼€å¯**æ³¨è§£é©±åŠ¨**å³å¯ï¼Œè€Œçœå»äº†å¤§æ®µçš„xmlé…ç½®</span><br><span class="line"></span><br><span class="line">å†æ¥å›é¡¾ä¸‹åŸç†å§~</span><br><span class="line"></span><br><span class="line">![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7IicxBZbkh0D4dJJiaXSzGEXyzsXDPy7oAJFsBvvBibiaFWpSp75vFIEOCBm7wnt4JKXJCHB9MflUycKw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1)</span><br><span class="line"></span><br><span class="line">ç®€è¦åˆ†ææ‰§è¡Œæµç¨‹</span><br><span class="line"></span><br><span class="line">1. DispatcherServletè¡¨ç¤ºå‰ç½®æ§åˆ¶å™¨ï¼Œæ˜¯æ•´ä¸ªSpringMVCçš„æ§åˆ¶ä¸­å¿ƒã€‚æˆ·å‘å‡ºè¯·æ±‚,</span><br><span class="line">DispatcherServletæ¥æ”¶è¯·æ±‚å¹¶æ‹¦æˆªè¯·æ±‚ã€‚</span><br><span class="line">* æˆ‘ä»¬å‡è®¾è¯·æ±‚çš„urlä¸º: http://localhost:8080/SpringMVC/hello</span><br><span class="line">*  å¦‚ä¸Šurlæ‹†åˆ†æˆä¸‰éƒ¨åˆ†:</span><br><span class="line">*  http://localhost:8080æœåŠ¡å™¨åŸŸå</span><br><span class="line">*  SpringMVCéƒ¨ç½²åœ¨æœåŠ¡å™¨.ä¸Šçš„webç«™ç‚¹</span><br><span class="line">* helloè¡¨ç¤ºæ§åˆ¶å™¨</span><br><span class="line">*  é€šè¿‡åˆ†æï¼Œå¦‚ä¸ŠurIè¡¨ç¤ºä¸º:è¯·æ±‚ä½äºæœåŠ¡å™¨localhost:8080ä¸Šçš„SpringMVCç«™ç‚¹çš„helloæ§åˆ¶å™¨ã€‚</span><br><span class="line">2. HandlerMappingä¸ºå¤„ç†å™¨æ˜ å°„ã€‚DispatcherServletè°ƒç”¨</span><br><span class="line">HandlerMa pping, HandlerMappingæ ¹æ®è¯·æ±‚urlæŸ¥æ‰¾Handlerã€‚</span><br><span class="line">3. HandlerExecutionè¡¨ç¤ºå…·ä½“çš„Handler,å…¶ä¸»è¦ä½œç”¨æ˜¯æ ¹æ®ur|æŸ¥æ‰¾æ§åˆ¶å™¨ï¼Œå¦‚ï¼Œ ä¸Šurlè¢«æŸ¥æ‰¾æ§åˆ¶å™¨</span><br><span class="line">ä¸º: helloã€‚</span><br><span class="line">4. HandlerExecutionå°†è§£æåçš„ä¿¡æ¯ä¼ é€’ç»™DispatcherServlet,å¦‚è§£ææ§åˆ¶å™¨æ˜ å°„ç­‰ã€‚</span><br><span class="line">5. HandlerAdapterè¡¨ç¤ºå¤„ç†å™¨é€‚é…å™¨ï¼Œå…¶æŒ‰ç…§ç‰¹å®šçš„è§„åˆ™å»æ‰§è¡ŒHandlerã€‚</span><br><span class="line">6. Handlerè®©å…·ä½“çš„Controlleræ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## äºŒã€ControlleråŠRestFulé£æ ¼</span><br><span class="line"></span><br><span class="line">### æ§åˆ¶å™¨Controller</span><br><span class="line"></span><br><span class="line">- æ§åˆ¶å™¨å¤æ‚æä¾›è®¿é—®åº”ç”¨ç¨‹åºçš„è¡Œä¸ºï¼Œé€šå¸¸é€šè¿‡æ¥å£å®šä¹‰æˆ–æ³¨è§£å®šä¹‰ä¸¤ç§æ–¹æ³•å®ç°ã€‚</span><br><span class="line"></span><br><span class="line">- æ§åˆ¶å™¨è´Ÿè´£è§£æç”¨æˆ·çš„è¯·æ±‚å¹¶å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªæ¨¡å‹ã€‚</span><br><span class="line"></span><br><span class="line">- åœ¨Spring MVCä¸­ä¸€ä¸ªæ§åˆ¶å™¨ç±»å¯ä»¥åŒ…å«å¤šä¸ªæ–¹æ³•</span><br><span class="line"></span><br><span class="line">- åœ¨Spring MVCä¸­ï¼Œå¯¹äºControllerçš„é…ç½®æ–¹å¼æœ‰å¾ˆå¤šç§</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">### å®ç°Controlleræ¥å£</span><br><span class="line"></span><br><span class="line">Controlleræ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨org.springframework.web.servlet.mvcåŒ…ä¸‹ï¼Œæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼›</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">//å®ç°è¯¥æ¥å£çš„ç±»è·å¾—æ§åˆ¶å™¨åŠŸèƒ½</span><br><span class="line">public interface Controller {</span><br><span class="line">   //å¤„ç†è¯·æ±‚ä¸”è¿”å›ä¸€ä¸ªæ¨¡å‹ä¸è§†å›¾å¯¹è±¡</span><br><span class="line">   ModelAndView handleRequest(HttpServletRequest var1, HttpServletResponse var2) throws Exception;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p><strong>æµ‹è¯•</strong></p><ol><li><p>æ–°å»ºä¸€ä¸ªMoudleï¼Œspringmvc-04-controller ã€‚å°†åˆšæ‰çš„03 æ‹·è´ä¸€ä»½, æˆ‘ä»¬è¿›è¡Œæ“ä½œï¼</p></li><li><ul><li>åˆ æ‰HelloController</li><li>mvcçš„é…ç½®æ–‡ä»¶åªç•™ä¸‹ è§†å›¾è§£æå™¨ï¼</li></ul></li><li><p>ç¼–å†™ä¸€ä¸ªControllerç±»ï¼ŒControllerTest1</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰æ§åˆ¶å™¨</span></span><br><span class="line"><span class="comment">//æ³¨æ„ç‚¹ï¼šä¸è¦å¯¼é”™åŒ…ï¼Œå®ç°Controlleræ¥å£ï¼Œé‡å†™æ–¹æ³•ï¼›</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ControllerTest1</span> <span class="keyword">implements</span> <span class="title class_">Controller</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> ModelAndView <span class="title function_">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">       <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">       mv.addObject(<span class="string">"msg"</span>,<span class="string">"Test1Controller"</span>);</span><br><span class="line">       mv.setViewName(<span class="string">"test"</span>);</span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>ç¼–å†™å®Œæ¯•åï¼Œå»Springé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œè¯·æ±‚çš„beanï¼›nameå¯¹åº”è¯·æ±‚è·¯å¾„ï¼Œclasså¯¹åº”å¤„ç†è¯·æ±‚çš„ç±»</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"/t1"</span> <span class="attr">class</span>=<span class="string">"com.kuang.controller.ControllerTest1"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>ç¼–å†™å‰ç«¯test.jspï¼Œæ³¨æ„åœ¨WEB-INF/jspç›®å½•ä¸‹ç¼–å†™ï¼Œå¯¹åº”æˆ‘ä»¬çš„è§†å›¾è§£æå™¨</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Kuangshen&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">${msg}</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure></li><li><p>é…ç½®Tomcatè¿è¡Œæµ‹è¯•ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰é¡¹ç›®å‘å¸ƒåé…ç½®çš„å°±æ˜¯ä¸€ä¸ª / ï¼Œæ‰€ä»¥è¯·æ±‚ä¸ç”¨åŠ é¡¹ç›®åï¼ŒOKï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsuEHNOK76U1NldDnfJupK4VyyRv7CqWibIz7iccC8vDXSwpHYxicl30dDYQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p></li></ol><p><strong>è¯´æ˜ï¼š</strong></p><ul><li><p>å®ç°æ¥å£Controllerå®šä¹‰æ§åˆ¶å™¨æ˜¯è¾ƒè€çš„åŠæ³•</p></li><li><p>ç¼ºç‚¹æ˜¯ï¼šä¸€ä¸ªæ§åˆ¶å™¨ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœè¦å¤šä¸ªæ–¹æ³•åˆ™éœ€è¦å®šä¹‰å¤šä¸ªControllerï¼›å®šä¹‰çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼›</p></li></ul><h3 id="ä½¿ç”¨æ³¨è§£-Controller"><a href="#ä½¿ç”¨æ³¨è§£-Controller" class="headerlink" title="ä½¿ç”¨æ³¨è§£@Controller"></a>ä½¿ç”¨æ³¨è§£@Controller</h3><ul><li><p>@Controlleræ³¨è§£ç±»å‹ç”¨äºå£°æ˜Springç±»çš„å®ä¾‹æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆåœ¨è®²IOCæ—¶è¿˜æåˆ°äº†å¦å¤–3ä¸ªæ³¨è§£ï¼‰ï¼›</p></li><li><p>Springå¯ä»¥ä½¿ç”¨æ‰«ææœºåˆ¶æ¥æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­æ‰€æœ‰åŸºäºæ³¨è§£çš„æ§åˆ¶å™¨ç±»ï¼Œä¸ºäº†ä¿è¯Springèƒ½æ‰¾åˆ°ä½ çš„æ§åˆ¶å™¨ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å£°æ˜ç»„ä»¶æ‰«æã€‚</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„åŒ…ï¼Œä¸‹é¢æ‰€æœ‰æ³¨è§£ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.kuang.controller"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>å¢åŠ ä¸€ä¸ªControllerTest2ç±»ï¼Œä½¿ç”¨æ³¨è§£å®ç°ï¼›</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//@Controlleræ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨æ·»åŠ åˆ°Springä¸Šä¸‹æ–‡ä¸­</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ControllerTest2</span>{</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„</span></span><br><span class="line">   <span class="meta">@RequestMapping("/t2")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">(Model model)</span>{</span><br><span class="line">       <span class="comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span></span><br><span class="line">       model.addAttribute(<span class="string">"msg"</span>, <span class="string">"ControllerTest2"</span>);</span><br><span class="line">       <span class="comment">//è¿”å›è§†å›¾ä½ç½®</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>è¿è¡Œtomcatæµ‹è¯•</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsuOfarw6u03VH0lJg4tnml6mspCRTKGuwzQQy7rx7NMia7t5Xu1DYOQiag/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p></li></ul><p><strong>å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬çš„ä¸¤ä¸ªè¯·æ±‚éƒ½å¯ä»¥æŒ‡å‘ä¸€ä¸ªè§†å›¾ï¼Œä½†æ˜¯é¡µé¢ç»“æœçš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºè§†å›¾æ˜¯è¢«å¤ç”¨çš„ï¼Œè€Œæ§åˆ¶å™¨ä¸è§†å›¾ä¹‹é—´æ˜¯å¼±å¶åˆå…³ç³»ã€‚</strong></p><p><strong>æ³¨è§£æ–¹å¼æ˜¯å¹³æ—¶ä½¿ç”¨çš„æœ€å¤šçš„æ–¹å¼ï¼</strong></p><h3 id="RequestMapping"><a href="#RequestMapping" class="headerlink" title="RequestMapping"></a>RequestMapping</h3><p><strong>@RequestMapping</strong></p><ul><li><p>@RequestMappingæ³¨è§£ç”¨äºæ˜ å°„urlåˆ°æ§åˆ¶å™¨ç±»æˆ–ä¸€ä¸ªç‰¹å®šçš„å¤„ç†ç¨‹åºæ–¹æ³•ã€‚å¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚</p></li><li><p>ä¸ºäº†æµ‹è¯•ç»“è®ºæ›´åŠ å‡†ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸Šä¸€ä¸ªé¡¹ç›®åæµ‹è¯• myweb</p></li><li><p>åªæ³¨è§£åœ¨æ–¹æ³•ä¸Šé¢</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> {</span><br><span class="line">   <span class="meta">@RequestMapping("/h1")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>{</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/">http://localhost:8080</a> / é¡¹ç›®å / h1</p></li><li><p>åŒæ—¶æ³¨è§£ç±»ä¸æ–¹æ³•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping("/admin")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> {</span><br><span class="line">   <span class="meta">@RequestMapping("/h1")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>{</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/">http://localhost:8080</a> / é¡¹ç›®å/ admin /h1  , éœ€è¦å…ˆæŒ‡å®šç±»çš„è·¯å¾„å†æŒ‡å®šæ–¹æ³•çš„è·¯å¾„ï¼›</p></li></ul><h3 id="RestFul-é£æ ¼"><a href="#RestFul-é£æ ¼" class="headerlink" title="RestFul é£æ ¼"></a>RestFul é£æ ¼</h3><p><strong>æ¦‚å¿µ</strong></p><p>Restfulå°±æ˜¯ä¸€ä¸ªèµ„æºå®šä½åŠèµ„æºæ“ä½œçš„é£æ ¼ã€‚ä¸æ˜¯æ ‡å‡†ä¹Ÿä¸æ˜¯åè®®ï¼Œåªæ˜¯ä¸€ç§é£æ ¼ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚</p><p><strong>åŠŸèƒ½</strong></p><p>èµ„æºï¼šäº’è”ç½‘æ‰€æœ‰çš„äº‹ç‰©éƒ½å¯ä»¥è¢«æŠ½è±¡ä¸ºèµ„æº</p><p>èµ„æºæ“ä½œï¼šä½¿ç”¨POSTã€DELETEã€PUTã€GETï¼Œä½¿ç”¨ä¸åŒæ–¹æ³•å¯¹èµ„æºè¿›è¡Œæ“ä½œã€‚</p><p>åˆ†åˆ«å¯¹åº” æ·»åŠ ã€ åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥è¯¢ã€‚</p><p><strong>ä¼ ç»Ÿæ–¹å¼æ“ä½œèµ„æº</strong>  ï¼šé€šè¿‡ä¸åŒçš„å‚æ•°æ¥å®ç°ä¸åŒçš„æ•ˆæœï¼æ–¹æ³•å•ä¸€ï¼Œpost å’Œ get</p><p>â€‹<a href="http://127.0.0.1/item/queryItem.action?id=1">http://127.0.0.1/item/queryItem.action?id=1</a> æŸ¥è¯¢,GET</p><p>â€‹<a href="http://127.0.0.1/item/saveItem.action">http://127.0.0.1/item/saveItem.action</a> æ–°å¢,POST</p><p>â€‹<a href="http://127.0.0.1/item/updateItem.action">http://127.0.0.1/item/updateItem.action</a> æ›´æ–°,POST</p><p>â€‹<a href="http://127.0.0.1/item/deleteItem.action?id=1">http://127.0.0.1/item/deleteItem.action?id=1</a> åˆ é™¤,GETæˆ–POST</p><p><strong>ä½¿ç”¨RESTfulæ“ä½œèµ„æº</strong> ï¼šå¯ä»¥é€šè¿‡ä¸åŒçš„è¯·æ±‚æ–¹å¼æ¥å®ç°ä¸åŒçš„æ•ˆæœï¼å¦‚ä¸‹ï¼šè¯·æ±‚åœ°å€ä¸€æ ·ï¼Œä½†æ˜¯åŠŸèƒ½å¯ä»¥ä¸åŒï¼</p><p>â€‹<a href="http://127.0.0.1/item/1">http://127.0.0.1/item/1</a> æŸ¥è¯¢,GET</p><p>â€‹<a href="http://127.0.0.1/item">http://127.0.0.1/item</a> æ–°å¢,POST</p><p>â€‹<a href="http://127.0.0.1/item">http://127.0.0.1/item</a> æ›´æ–°,PUT</p><p>â€‹<a href="http://127.0.0.1/item/1">http://127.0.0.1/item/1</a> åˆ é™¤,DELETE</p><p><strong>å­¦ä¹ æµ‹è¯•</strong></p><ol><li><p>åœ¨æ–°å»ºä¸€ä¸ªç±» RestFulController</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestFulController</span> {</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>åœ¨Spring MVCä¸­å¯ä»¥ä½¿ç”¨  @PathVariable æ³¨è§£ï¼Œè®©æ–¹æ³•å‚æ•°çš„å€¼å¯¹åº”ç»‘å®šåˆ°ä¸€ä¸ªURIæ¨¡æ¿å˜é‡ä¸Šã€‚</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestFulController</span> {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„</span></span><br><span class="line">   <span class="meta">@RequestMapping("/commit/{p1}/{p2}")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">(<span class="meta">@PathVariable</span> <span class="type">int</span> p1, <span class="meta">@PathVariable</span> <span class="type">int</span> p2, Model model)</span>{</span><br><span class="line">       </span><br><span class="line">       <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> p1+p2;</span><br><span class="line">       <span class="comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span></span><br><span class="line">       model.addAttribute(<span class="string">"msg"</span>, <span class="string">"ç»“æœï¼š"</span>+result);</span><br><span class="line">       <span class="comment">//è¿”å›è§†å›¾ä½ç½®</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">       </span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>æˆ‘ä»¬æ¥æµ‹è¯•è¯·æ±‚æŸ¥çœ‹ä¸‹</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsu5BqyAspPK6GlhgxeV1nS0RWPnUfVBuaiadicaicQepibic2EVkyDflUh3qQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p></li><li><p>æ€è€ƒï¼šä½¿ç”¨è·¯å¾„å˜é‡çš„å¥½å¤„ï¼Ÿ</p></li><li><ul><li><p>ä½¿è·¯å¾„å˜å¾—æ›´åŠ ç®€æ´ï¼›</p></li><li><p>è·å¾—å‚æ•°æ›´åŠ æ–¹ä¾¿ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ã€‚</p></li><li><p>é€šè¿‡è·¯å¾„å˜é‡çš„ç±»å‹å¯ä»¥çº¦æŸè®¿é—®å‚æ•°ï¼Œå¦‚æœç±»å‹ä¸ä¸€æ ·ï¼Œåˆ™è®¿é—®ä¸åˆ°å¯¹åº”çš„è¯·æ±‚æ–¹æ³•ï¼Œå¦‚è¿™é‡Œè®¿é—®æ˜¯çš„è·¯å¾„æ˜¯/commit/1/aï¼Œåˆ™è·¯å¾„ä¸æ–¹æ³•ä¸åŒ¹é…ï¼Œè€Œä¸ä¼šæ˜¯å‚æ•°è½¬æ¢å¤±è´¥ã€‚</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsumkKQDDBx9D7E67IK9dmVtHnjn0WjPSOZxKnwz9AXrTPRLy6Xu42yrg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p></li></ul></li><li><p>æˆ‘ä»¬æ¥ä¿®æ”¹ä¸‹å¯¹åº”çš„å‚æ•°ç±»å‹ï¼Œå†æ¬¡æµ‹è¯•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„</span></span><br><span class="line"><span class="meta">@RequestMapping("/commit/{p1}/{p2}")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">index</span><span class="params">(<span class="meta">@PathVariable</span> <span class="type">int</span> p1, <span class="meta">@PathVariable</span> String p2, Model model)</span>{</span><br><span class="line"></span><br><span class="line">   <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> p1+p2;</span><br><span class="line">   <span class="comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span></span><br><span class="line">   model.addAttribute(<span class="string">"msg"</span>, <span class="string">"ç»“æœï¼š"</span>+result);</span><br><span class="line">   <span class="comment">//è¿”å›è§†å›¾ä½ç½®</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsuJXyVjg5EaXZiaO78ibGzhUXnEz5UlbRTRDKzGNh0t5WspXrpvSLe9y9w/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p></li></ol><p><strong>ä½¿ç”¨methodå±æ€§æŒ‡å®šè¯·æ±‚ç±»å‹</strong></p><p>ç”¨äºçº¦æŸè¯·æ±‚çš„ç±»å‹ï¼Œå¯ä»¥æ”¶çª„è¯·æ±‚èŒƒå›´ã€‚æŒ‡å®šè¯·æ±‚è°“è¯çš„ç±»å‹å¦‚GET, POST, HEAD, OPTIONS, PUT, PATCH, DELETE, TRACEç­‰</p><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p><ul><li><p>å¢åŠ ä¸€ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„,å¿…é¡»æ˜¯POSTè¯·æ±‚</span></span><br><span class="line"><span class="meta">@RequestMapping(value = "/hello",method = {RequestMethod.POST})</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">index2</span><span class="params">(Model model)</span>{</span><br><span class="line">   model.addAttribute(<span class="string">"msg"</span>, <span class="string">"hello!"</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨åœ°å€æ è¿›è¡Œè®¿é—®é»˜è®¤æ˜¯Getè¯·æ±‚ï¼Œä¼šæŠ¥é”™405ï¼š</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsucZBtV1jA2Clpa2utiajS6zkWWoYIo8VhqlUGIOSiacAjCsiaJEOeVvNUQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p></li><li><p>å¦‚æœå°†POSTä¿®æ”¹ä¸ºGETåˆ™æ­£å¸¸äº†ï¼›</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//æ˜ å°„è®¿é—®è·¯å¾„,å¿…é¡»æ˜¯Getè¯·æ±‚</span></span><br><span class="line"><span class="meta">@RequestMapping(value = "/hello",method = {RequestMethod.GET})</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">index2</span><span class="params">(Model model)</span>{</span><br><span class="line">   model.addAttribute(<span class="string">"msg"</span>, <span class="string">"hello!"</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsua1f90EJnCRJxuBoeSWiaTmdVfjIDgUo5v6ENY5N307GfoXUp4PxYu0g/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p></li></ul><p><strong>å°ç»“ï¼š</strong></p><p>Spring MVC çš„ @RequestMapping æ³¨è§£èƒ½å¤Ÿå¤„ç† HTTP è¯·æ±‚çš„æ–¹æ³•, æ¯”å¦‚ GET, PUT, POST, DELETE ä»¥åŠ PATCHã€‚</p><p><strong>æ‰€æœ‰çš„åœ°å€æ è¯·æ±‚é»˜è®¤éƒ½ä¼šæ˜¯ HTTP GET ç±»å‹çš„ã€‚</strong></p><p>æ–¹æ³•çº§åˆ«çš„æ³¨è§£å˜ä½“æœ‰å¦‚ä¸‹å‡ ä¸ªï¼šç»„åˆæ³¨è§£</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">@GetMapping</span><br><span class="line">@PostMapping</span><br><span class="line">@PutMapping</span><br><span class="line">@DeleteMapping</span><br><span class="line">@PatchMapping</span><br></pre></td></tr></tbody></table></figure><p>@GetMapping æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œå¹³æ—¶ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šï¼</p><p>å®ƒæ‰€æ‰®æ¼”çš„æ˜¯ @RequestMapping(method =RequestMethod.GET) çš„ä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚</p><h3 id="æ‰©å±•ï¼šå°é»„é¸­è°ƒè¯•æ³•"><a href="#æ‰©å±•ï¼šå°é»„é¸­è°ƒè¯•æ³•" class="headerlink" title="æ‰©å±•ï¼šå°é»„é¸­è°ƒè¯•æ³•"></a>æ‰©å±•ï¼šå°é»„é¸­è°ƒè¯•æ³•</h3><p>åœºæ™¯ä¸€ï¼š<em>æˆ‘ä»¬éƒ½æœ‰è¿‡å‘åˆ«äººï¼ˆç”šè‡³å¯èƒ½å‘å®Œå…¨ä¸ä¼šç¼–ç¨‹çš„äººï¼‰æé—®åŠè§£é‡Šç¼–ç¨‹é—®é¢˜çš„ç»å†ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™å°±åœ¨æˆ‘ä»¬è§£é‡Šçš„è¿‡ç¨‹ä¸­è‡ªå·±å´æƒ³åˆ°äº†é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œç„¶åå¯¹æ–¹å´ä¸€è„¸èŒ«ç„¶ã€‚</em></p><p>åœºæ™¯äºŒï¼šä½ çš„åŒè¡Œè·‘æ¥é—®ä½ ä¸€ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å½“ä»–è‡ªå·±æŠŠé—®é¢˜è¯´å®Œï¼Œæˆ–è¯´åˆ°ä¸€åŠçš„æ—¶å€™å°±æƒ³å‡ºç­”æ¡ˆèµ°äº†ï¼Œç•™ä¸‹ä¸€è„¸èŒ«ç„¶çš„ä½ ã€‚</p><p>å…¶å®ä¸Šé¢ä¸¤ç§åœºæ™¯ç°è±¡å°±æ˜¯æ‰€è°“çš„å°é»„é¸­è°ƒè¯•æ³•ï¼ˆRubber Duck Debugingï¼‰ï¼Œåˆç§°æ©¡çš®é¸­è°ƒè¯•æ³•ï¼Œå®ƒæ˜¯æˆ‘ä»¬è½¯ä»¶å·¥ç¨‹ä¸­æœ€å¸¸ä½¿ç”¨è°ƒè¯•æ–¹æ³•ä¹‹ä¸€ã€‚</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JOmNdhqNbrRK9XaseXIDsu4MibRVpZicicSVRRjb0lAblXjlHHppY3gSBn8iaTsa2oLEMO9S3bPCDHoA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>æ­¤æ¦‚å¿µæ®è¯´æ¥è‡ªã€Šç¨‹åºå‘˜ä¿®ç‚¼ä¹‹é“ã€‹ä¹¦ä¸­çš„ä¸€ä¸ªæ•…äº‹ï¼Œä¼ è¯´ç¨‹åºå¤§å¸ˆéšèº«æºå¸¦ä¸€åªå°é»„é¸­ï¼Œåœ¨è°ƒè¯•ä»£ç çš„æ—¶å€™ä¼šåœ¨æ¡Œä¸Šæ”¾ä¸Šè¿™åªå°é»„é¸­ï¼Œç„¶åè¯¦ç»†åœ°å‘é¸­å­è§£é‡Šæ¯è¡Œä»£ç ï¼Œç„¶åå¾ˆå¿«å°±å°†é—®é¢˜å®šä½ä¿®å¤äº†ã€‚</p><h2 id="ä¸‰ã€æ•°æ®å¤„ç†åŠè·³è½¬"><a href="#ä¸‰ã€æ•°æ®å¤„ç†åŠè·³è½¬" class="headerlink" title="ä¸‰ã€æ•°æ®å¤„ç†åŠè·³è½¬"></a>ä¸‰ã€æ•°æ®å¤„ç†åŠè·³è½¬</h2><h3 id="ç»“æœè·³è½¬æ–¹å¼"><a href="#ç»“æœè·³è½¬æ–¹å¼" class="headerlink" title="ç»“æœè·³è½¬æ–¹å¼"></a>ç»“æœè·³è½¬æ–¹å¼</h3><h4 id="ModelAndView"><a href="#ModelAndView" class="headerlink" title="ModelAndView"></a>ModelAndView</h4><p>è®¾ç½®ModelAndViewå¯¹è±¡ , æ ¹æ®viewçš„åç§° , å’Œè§†å›¾è§£æå™¨è·³åˆ°æŒ‡å®šçš„é¡µé¢ .</p><p>é¡µé¢ : {è§†å›¾è§£æå™¨å‰ç¼€} + viewName +{è§†å›¾è§£æå™¨åç¼€}</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span></span></span><br><span class="line"><span class="tag">     <span class="attr">id</span>=<span class="string">"internalResourceViewResolver"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- å‰ç¼€ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- åç¼€ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>å¯¹åº”çš„controllerç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ControllerTest1</span> <span class="keyword">implements</span> <span class="title class_">Controller</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> ModelAndView <span class="title function_">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">       <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">       mv.addObject(<span class="string">"msg"</span>,<span class="string">"ControllerTest1"</span>);</span><br><span class="line">       mv.setViewName(<span class="string">"test"</span>);</span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="ServletAPI"><a href="#ServletAPI" class="headerlink" title="ServletAPI"></a>ServletAPI</h4><p>é€šè¿‡è®¾ç½®ServletAPI , ä¸éœ€è¦è§†å›¾è§£æå™¨ .</p><p>1ã€é€šè¿‡HttpServletResponseè¿›è¡Œè¾“å‡º</p><p>2ã€é€šè¿‡HttpServletResponseå®ç°é‡å®šå‘</p><p>3ã€é€šè¿‡HttpServletResponseå®ç°è½¬å‘</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultGo</span> {</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/result/t1")</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="keyword">throws</span> IOException {</span><br><span class="line">       rsp.getWriter().println(<span class="string">"Hello,Spring BY servlet API"</span>);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/result/t2")</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="keyword">throws</span> IOException {</span><br><span class="line">       rsp.sendRedirect(<span class="string">"/index.jsp"</span>);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/result/t3")</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="comment">//è½¬å‘</span></span><br><span class="line">       req.setAttribute(<span class="string">"msg"</span>,<span class="string">"/result/t3"</span>);</span><br><span class="line">       req.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/test.jsp"</span>).forward(req,rsp);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="SpringMVC-1"><a href="#SpringMVC-1" class="headerlink" title="SpringMVC"></a>SpringMVC</h4><p><strong>é€šè¿‡SpringMVCæ¥å®ç°è½¬å‘å’Œé‡å®šå‘ - æ— éœ€è§†å›¾è§£æå™¨ï¼›</strong></p><p>æµ‹è¯•å‰ï¼Œéœ€è¦å°†è§†å›¾è§£æå™¨æ³¨é‡Šæ‰</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class ResultSpringMVC {</span><br><span class="line">   @RequestMapping("/rsm/t1")</span><br><span class="line">   public String test1(){</span><br><span class="line">       //è½¬å‘</span><br><span class="line">       return "/index.jsp";</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   @RequestMapping("/rsm/t2")</span><br><span class="line">   public String test2(){</span><br><span class="line">       //è½¬å‘äºŒ</span><br><span class="line">       return "forward:/index.jsp";</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   @RequestMapping("/rsm/t3")</span><br><span class="line">   public String test3(){</span><br><span class="line">       //é‡å®šå‘</span><br><span class="line">       return "redirect:/index.jsp";</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>é€šè¿‡SpringMVCæ¥å®ç°è½¬å‘å’Œé‡å®šå‘ - æœ‰è§†å›¾è§£æå™¨ï¼›</strong></p><p>é‡å®šå‘ , ä¸éœ€è¦è§†å›¾è§£æå™¨ , æœ¬è´¨å°±æ˜¯é‡æ–°è¯·æ±‚ä¸€ä¸ªæ–°åœ°æ–¹å˜› , æ‰€ä»¥æ³¨æ„è·¯å¾„é—®é¢˜.</p><p>å¯ä»¥é‡å®šå‘åˆ°å¦å¤–ä¸€ä¸ªè¯·æ±‚å®ç° .</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultSpringMVC2</span> {</span><br><span class="line">   <span class="meta">@RequestMapping("/rsm2/t1")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">test1</span><span class="params">()</span>{</span><br><span class="line">       <span class="comment">//è½¬å‘</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/rsm2/t2")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">test2</span><span class="params">()</span>{</span><br><span class="line">       <span class="comment">//é‡å®šå‘</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br><span class="line">       <span class="comment">//return "redirect:hello.do"; //hello.doä¸ºå¦ä¸€ä¸ªè¯·æ±‚/</span></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h3><h4 id="å¤„ç†æäº¤æ•°æ®"><a href="#å¤„ç†æäº¤æ•°æ®" class="headerlink" title="å¤„ç†æäº¤æ•°æ®"></a>å¤„ç†æäº¤æ•°æ®</h4><p><strong>1ã€æäº¤çš„åŸŸåç§°å’Œå¤„ç†æ–¹æ³•çš„å‚æ•°åä¸€è‡´</strong></p><p>æäº¤æ•°æ® : <a href="http://localhost:8080/hello?name=kuangshen">http://localhost:8080/hello?name=kuangshen</a></p><p>å¤„ç†æ–¹æ³• :</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/hello")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(String name)</span>{</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>åå°è¾“å‡º : kuangshen</p><p><strong>2ã€æäº¤çš„åŸŸåç§°å’Œå¤„ç†æ–¹æ³•çš„å‚æ•°åä¸ä¸€è‡´</strong></p><p>æäº¤æ•°æ® : <a href="http://localhost:8080/hello?username=kuangshen">http://localhost:8080/hello?username=kuangshen</a></p><p>å¤„ç†æ–¹æ³• :</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//@RequestParam("username") : usernameæäº¤çš„åŸŸçš„åç§° .</span></span><br><span class="line"><span class="meta">@RequestMapping("/hello")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(<span class="meta">@RequestParam("username")</span> String name)</span>{</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>åå°è¾“å‡º : kuangshen</p><p><strong>3ã€æäº¤çš„æ˜¯ä¸€ä¸ªå¯¹è±¡</strong></p><p>è¦æ±‚æäº¤çš„è¡¨å•åŸŸå’Œå¯¹è±¡çš„å±æ€§åä¸€è‡´  , å‚æ•°ä½¿ç”¨å¯¹è±¡å³å¯</p><p>1ã€å®ä½“ç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">   <span class="comment">//æ„é€ </span></span><br><span class="line">   <span class="comment">//get/set</span></span><br><span class="line">   <span class="comment">//tostring()</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>2ã€æäº¤æ•°æ® : <a href="http://localhost:8080/mvc04/user?name=kuangshen&amp;id=1&amp;age=15">http://localhost:8080/mvc04/user?name=kuangshen&amp;id=1&amp;age=15</a></p><p>3ã€å¤„ç†æ–¹æ³• :</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/user")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">user</span><span class="params">(User user)</span>{</span><br><span class="line">   System.out.println(user);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>åå°è¾“å‡º : User { id=1, name=â€™kuangshenâ€™, age=15 }</p><p>è¯´æ˜ï¼šå¦‚æœä½¿ç”¨å¯¹è±¡çš„è¯ï¼Œå‰ç«¯ä¼ é€’çš„å‚æ•°åå’Œå¯¹è±¡åå¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™å°±æ˜¯nullã€‚</p><h4 id="æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯"><a href="#æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯" class="headerlink" title="æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯"></a>æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯</h4><p><strong>ç¬¬ä¸€ç§ : é€šè¿‡ModelAndView</strong></p><p>æˆ‘ä»¬å‰é¢ä¸€ç›´éƒ½æ˜¯å¦‚æ­¤ . å°±ä¸è¿‡å¤šè§£é‡Š</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ControllerTest1</span> <span class="keyword">implements</span> <span class="title class_">Controller</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> ModelAndView <span class="title function_">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span></span><br><span class="line">       <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">       mv.addObject(<span class="string">"msg"</span>,<span class="string">"ControllerTest1"</span>);</span><br><span class="line">       mv.setViewName(<span class="string">"test"</span>);</span><br><span class="line">       <span class="keyword">return</span> mv;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>ç¬¬äºŒç§ : é€šè¿‡ModelMap</strong></p><p>ModelMap</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/hello")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(<span class="meta">@RequestParam("username")</span> String name, ModelMap model)</span>{</span><br><span class="line">   <span class="comment">//å°è£…è¦æ˜¾ç¤ºåˆ°è§†å›¾ä¸­çš„æ•°æ®</span></span><br><span class="line">   <span class="comment">//ç›¸å½“äºreq.setAttribute("name",name);</span></span><br><span class="line">   model.addAttribute(<span class="string">"name"</span>,name);</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>ç¬¬ä¸‰ç§ : é€šè¿‡Model</strong></p><p>Model</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/ct2/hello")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">(<span class="meta">@RequestParam("username")</span> String name, Model model)</span>{</span><br><span class="line">   <span class="comment">//å°è£…è¦æ˜¾ç¤ºåˆ°è§†å›¾ä¸­çš„æ•°æ®</span></span><br><span class="line">   <span class="comment">//ç›¸å½“äºreq.setAttribute("name",name);</span></span><br><span class="line">   model.addAttribute(<span class="string">"msg"</span>,name);</span><br><span class="line">   System.out.println(name);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h4><p>å°±å¯¹äºæ–°æ‰‹è€Œè¨€ç®€å•æ¥è¯´ä½¿ç”¨åŒºåˆ«å°±æ˜¯ï¼š</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">Model åªæœ‰å¯¥å¯¥å‡ ä¸ªæ–¹æ³•åªé€‚åˆç”¨äºå‚¨å­˜æ•°æ®ï¼Œç®€åŒ–äº†æ–°æ‰‹å¯¹äºModelå¯¹è±¡çš„æ“ä½œå’Œç†è§£ï¼›</span><br><span class="line"></span><br><span class="line">ModelMap ç»§æ‰¿äº† LinkedMap ï¼Œé™¤äº†å®ç°äº†è‡ªèº«çš„ä¸€äº›æ–¹æ³•ï¼ŒåŒæ ·çš„ç»§æ‰¿ LinkedMap çš„æ–¹æ³•å’Œç‰¹æ€§ï¼›</span><br><span class="line"></span><br><span class="line">ModelAndView å¯ä»¥åœ¨å‚¨å­˜æ•°æ®çš„åŒæ—¶ï¼Œå¯ä»¥è¿›è¡Œè®¾ç½®è¿”å›çš„é€»è¾‘è§†å›¾ï¼Œè¿›è¡Œæ§åˆ¶å±•ç¤ºå±‚çš„è·³è½¬ã€‚</span><br></pre></td></tr></tbody></table></figure><p>å½“ç„¶æ›´å¤šçš„ä»¥åå¼€å‘è€ƒè™‘çš„æ›´å¤šçš„æ˜¯æ€§èƒ½å’Œä¼˜åŒ–ï¼Œå°±ä¸èƒ½å•å•ä»…é™äºæ­¤çš„äº†è§£ã€‚</p><p><strong>è¯·ä½¿ç”¨80%çš„æ—¶é—´æ‰“å¥½æ‰å®çš„åŸºç¡€ï¼Œå‰©ä¸‹18%çš„æ—¶é—´ç ”ç©¶æ¡†æ¶ï¼Œ2%çš„æ—¶é—´å»å­¦ç‚¹è‹±æ–‡ï¼Œæ¡†æ¶çš„å®˜æ–¹æ–‡æ¡£æ°¸è¿œæ˜¯æœ€å¥½çš„æ•™ç¨‹ã€‚</strong></p><h3 id="ä¹±ç é—®é¢˜"><a href="#ä¹±ç é—®é¢˜" class="headerlink" title="ä¹±ç é—®é¢˜"></a>ä¹±ç é—®é¢˜</h3><p>æµ‹è¯•æ­¥éª¤ï¼š</p><p>1ã€æˆ‘ä»¬å¯ä»¥åœ¨é¦–é¡µç¼–å†™ä¸€ä¸ªæäº¤çš„è¡¨å•</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/e/t"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>2ã€åå°ç¼–å†™å¯¹åº”çš„å¤„ç†ç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Encoding</span> {</span><br><span class="line">   <span class="meta">@RequestMapping("/e/t")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">(Model model,String name)</span>{</span><br><span class="line">       model.addAttribute(<span class="string">"msg"</span>,name); <span class="comment">//è·å–è¡¨å•æäº¤çš„å€¼</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"test"</span>; <span class="comment">//è·³è½¬åˆ°testé¡µé¢æ˜¾ç¤ºè¾“å…¥çš„å€¼</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>3ã€è¾“å…¥ä¸­æ–‡æµ‹è¯•ï¼Œå‘ç°ä¹±ç </p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7IY4LDnTZkk5dLWKMlUlx0gqJOSOA4PQnmhg0rYQYexQXAvUWXvBRf8kN3hk6dDzHxC3w97QicX9XQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>ä¸å¾—ä¸è¯´ï¼Œä¹±ç é—®é¢˜æ˜¯åœ¨æˆ‘ä»¬å¼€å‘ä¸­ååˆ†å¸¸è§çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯è®©æˆ‘ä»¬ç¨‹åºçŒ¿æ¯”è¾ƒå¤´å¤§çš„é—®é¢˜ï¼</p><p>ä»¥å‰ä¹±ç é—®é¢˜é€šè¿‡è¿‡æ»¤å™¨è§£å†³ , è€ŒSpringMVCç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè¿‡æ»¤å™¨ , å¯ä»¥åœ¨web.xmlä¸­é…ç½® .</p><p>ä¿®æ”¹äº†xmlæ–‡ä»¶éœ€è¦é‡å¯æœåŠ¡å™¨ï¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>ä½†æ˜¯æˆ‘ä»¬å‘ç° , æœ‰äº›æç«¯æƒ…å†µä¸‹.è¿™ä¸ªè¿‡æ»¤å™¨å¯¹getçš„æ”¯æŒä¸å¥½ .</p><p>å¤„ç†æ–¹æ³• :</p><p>1ã€ä¿®æ”¹tomcaté…ç½®æ–‡ä»¶ ï¼šè®¾ç½®ç¼–ç ï¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">"utf-8"</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">redirectPort</span>=<span class="string">"8443"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>2ã€è‡ªå®šä¹‰è¿‡æ»¤å™¨</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequestWrapper;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* è§£å†³getå’Œpostè¯·æ±‚ å…¨éƒ¨ä¹±ç çš„è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GenericEncodingFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> {</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> {</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException {</span><br><span class="line">       <span class="comment">//å¤„ç†responseçš„å­—ç¬¦ç¼–ç </span></span><br><span class="line">       HttpServletResponse myResponse=(HttpServletResponse) response;</span><br><span class="line">       myResponse.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// è½¬å‹ä¸ºä¸åè®®ç›¸å…³å¯¹è±¡</span></span><br><span class="line">       <span class="type">HttpServletRequest</span> <span class="variable">httpServletRequest</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">       <span class="comment">// å¯¹requeståŒ…è£…å¢å¼º</span></span><br><span class="line">       <span class="type">HttpServletRequest</span> <span class="variable">myrequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyRequest</span>(httpServletRequest);</span><br><span class="line">       chain.doFilter(myrequest, response);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException {</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªå®šä¹‰requestå¯¹è±¡ï¼ŒHttpServletRequestçš„åŒ…è£…ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyRequest</span> <span class="keyword">extends</span> <span class="title class_">HttpServletRequestWrapper</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> HttpServletRequest request;</span><br><span class="line">   <span class="comment">//æ˜¯å¦ç¼–ç çš„æ ‡è®°</span></span><br><span class="line">   <span class="keyword">private</span> <span class="type">boolean</span> hasEncode;</span><br><span class="line">   <span class="comment">//å®šä¹‰ä¸€ä¸ªå¯ä»¥ä¼ å…¥HttpServletRequestå¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œè£…é¥°</span></span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">MyRequest</span><span class="params">(HttpServletRequest request)</span> {</span><br><span class="line">       <span class="built_in">super</span>(request);<span class="comment">// superå¿…é¡»å†™</span></span><br><span class="line">       <span class="built_in">this</span>.request = request;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">// å¯¹éœ€è¦å¢å¼ºæ–¹æ³• è¿›è¡Œè¦†ç›–</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> Map <span class="title function_">getParameterMap</span><span class="params">()</span> {</span><br><span class="line">       <span class="comment">// å…ˆè·å¾—è¯·æ±‚æ–¹å¼</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> request.getMethod();</span><br><span class="line">       <span class="keyword">if</span> (method.equalsIgnoreCase(<span class="string">"post"</span>)) {</span><br><span class="line">           <span class="comment">// postè¯·æ±‚</span></span><br><span class="line">           <span class="keyword">try</span> {</span><br><span class="line">               <span class="comment">// å¤„ç†postä¹±ç </span></span><br><span class="line">               request.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">               <span class="keyword">return</span> request.getParameterMap();</span><br><span class="line">          } <span class="keyword">catch</span> (UnsupportedEncodingException e) {</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">          }</span><br><span class="line">      } <span class="keyword">else</span> <span class="keyword">if</span> (method.equalsIgnoreCase(<span class="string">"get"</span>)) {</span><br><span class="line">           <span class="comment">// getè¯·æ±‚</span></span><br><span class="line">           Map&lt;String, String[]&gt; parameterMap = request.getParameterMap();</span><br><span class="line">           <span class="keyword">if</span> (!hasEncode) { <span class="comment">// ç¡®ä¿getæ‰‹åŠ¨ç¼–ç é€»è¾‘åªè¿è¡Œä¸€æ¬¡</span></span><br><span class="line">               <span class="keyword">for</span> (String parameterName : parameterMap.keySet()) {</span><br><span class="line">                   String[] values = parameterMap.get(parameterName);</span><br><span class="line">                   <span class="keyword">if</span> (values != <span class="literal">null</span>) {</span><br><span class="line">                       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; values.length; i++) {</span><br><span class="line">                           <span class="keyword">try</span> {</span><br><span class="line">                               <span class="comment">// å¤„ç†getä¹±ç </span></span><br><span class="line">                               values[i] = <span class="keyword">new</span> <span class="title class_">String</span>(values[i]</span><br><span class="line">                                      .getBytes(<span class="string">"ISO-8859-1"</span>), <span class="string">"utf-8"</span>);</span><br><span class="line">                          } <span class="keyword">catch</span> (UnsupportedEncodingException e) {</span><br><span class="line">                               e.printStackTrace();</span><br><span class="line">                          }</span><br><span class="line">                      }</span><br><span class="line">                  }</span><br><span class="line">              }</span><br><span class="line">               hasEncode = <span class="literal">true</span>;</span><br><span class="line">          }</span><br><span class="line">           <span class="keyword">return</span> parameterMap;</span><br><span class="line">      }</span><br><span class="line">       <span class="keyword">return</span> <span class="built_in">super</span>.getParameterMap();</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å–ä¸€ä¸ªå€¼</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">getParameter</span><span class="params">(String name)</span> {</span><br><span class="line">       Map&lt;String, String[]&gt; parameterMap = getParameterMap();</span><br><span class="line">       String[] values = parameterMap.get(name);</span><br><span class="line">       <span class="keyword">if</span> (values == <span class="literal">null</span>) {</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">      }</span><br><span class="line">       <span class="keyword">return</span> values[<span class="number">0</span>]; <span class="comment">// å–å›å‚æ•°çš„ç¬¬ä¸€ä¸ªå€¼</span></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å–æ‰€æœ‰å€¼</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> String[] getParameterValues(String name) {</span><br><span class="line">       Map&lt;String, String[]&gt; parameterMap = getParameterMap();</span><br><span class="line">       String[] values = parameterMap.get(name);</span><br><span class="line">       <span class="keyword">return</span> values;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¿™ä¸ªä¹Ÿæ˜¯æˆ‘åœ¨ç½‘ä¸Šæ‰¾çš„ä¸€äº›å¤§ç¥å†™çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSpringMVCé»˜è®¤çš„ä¹±ç å¤„ç†å°±å·²ç»èƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³äº†ï¼</p><p><strong>ç„¶ååœ¨web.xmlä¸­é…ç½®è¿™ä¸ªè¿‡æ»¤å™¨å³å¯ï¼</strong></p><p>ä¹±ç é—®é¢˜ï¼Œéœ€è¦å¹³æ—¶å¤šæ³¨æ„ï¼Œåœ¨å°½å¯èƒ½èƒ½è®¾ç½®ç¼–ç çš„åœ°æ–¹ï¼Œéƒ½è®¾ç½®ä¸ºç»Ÿä¸€ç¼–ç  UTF-8ï¼</p><h2 id="å››ã€Jsonäº¤äº’å¤„ç†"><a href="#å››ã€Jsonäº¤äº’å¤„ç†" class="headerlink" title="å››ã€Jsonäº¤äº’å¤„ç†"></a>å››ã€Jsonäº¤äº’å¤„ç†</h2><h3 id="ä»€ä¹ˆæ˜¯JSONï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯JSONï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯JSONï¼Ÿ"></a>ä»€ä¹ˆæ˜¯JSONï¼Ÿ</h3><ul><li>JSON(JavaScript Object Notation, JS å¯¹è±¡æ ‡è®°) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œç›®å‰ä½¿ç”¨ç‰¹åˆ«å¹¿æ³›ã€‚</li><li>é‡‡ç”¨å®Œå…¨ç‹¬ç«‹äºç¼–ç¨‹è¯­è¨€çš„<strong>æ–‡æœ¬æ ¼å¼</strong>æ¥å­˜å‚¨å’Œè¡¨ç¤ºæ•°æ®ã€‚</li><li>ç®€æ´å’Œæ¸…æ™°çš„å±‚æ¬¡ç»“æ„ä½¿å¾— JSON æˆä¸ºç†æƒ³çš„æ•°æ®äº¤æ¢è¯­è¨€ã€‚</li><li>æ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆï¼Œå¹¶æœ‰æ•ˆåœ°æå‡ç½‘ç»œä¼ è¾“æ•ˆç‡ã€‚</li></ul><p>åœ¨ JavaScript è¯­è¨€ä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ã€‚å› æ­¤ï¼Œä»»ä½•JavaScript æ”¯æŒçš„ç±»å‹éƒ½å¯ä»¥é€šè¿‡ JSON æ¥è¡¨ç¤ºï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ã€æ•°ç»„ç­‰ã€‚çœ‹çœ‹ä»–çš„è¦æ±‚å’Œè¯­æ³•æ ¼å¼ï¼š</p><ul><li>å¯¹è±¡è¡¨ç¤ºä¸ºé”®å€¼å¯¹ï¼Œæ•°æ®ç”±é€—å·åˆ†éš”</li><li>èŠ±æ‹¬å·ä¿å­˜å¯¹è±¡</li><li>æ–¹æ‹¬å·ä¿å­˜æ•°ç»„</li></ul><p><strong>JSON é”®å€¼å¯¹</strong>æ˜¯ç”¨æ¥ä¿å­˜ JavaScript å¯¹è±¡çš„ä¸€ç§æ–¹å¼ï¼Œå’Œ JavaScript å¯¹è±¡çš„å†™æ³•ä¹Ÿå¤§åŒå°å¼‚ï¼Œé”®/å€¼å¯¹ç»„åˆä¸­çš„é”®åå†™åœ¨å‰é¢å¹¶ç”¨åŒå¼•å· â€œâ€ åŒ…è£¹ï¼Œä½¿ç”¨å†’å· : åˆ†éš”ï¼Œç„¶åç´§æ¥ç€å€¼ï¼š</p><figure class="highlight json"><table><tbody><tr><td class="code"><pre><span class="line"><span class="punctuation">{</span><span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"QinJiang"</span><span class="punctuation">}</span></span><br><span class="line"><span class="punctuation">{</span><span class="attr">"age"</span><span class="punctuation">:</span> <span class="string">"3"</span><span class="punctuation">}</span></span><br><span class="line"><span class="punctuation">{</span><span class="attr">"sex"</span><span class="punctuation">:</span> <span class="string">"ç”·"</span><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><p>å¾ˆå¤šäººæä¸æ¸…æ¥š JSON å’Œ JavaScript å¯¹è±¡çš„å…³ç³»ï¼Œç”šè‡³è¿è°æ˜¯è°éƒ½ä¸æ¸…æ¥šã€‚å…¶å®ï¼Œå¯ä»¥è¿™ä¹ˆç†è§£ï¼š</p><p>JSON æ˜¯ JavaScript å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºæ³•ï¼Œå®ƒä½¿ç”¨æ–‡æœ¬è¡¨ç¤ºä¸€ä¸ª JS å¯¹è±¡çš„ä¿¡æ¯ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = {<span class="attr">a</span>: <span class="string">'Hello'</span>, <span class="attr">b</span>: <span class="string">'World'</span>}; <span class="comment">//è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ³¨æ„é”®åä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨å¼•å·åŒ…è£¹çš„</span></span><br><span class="line"><span class="keyword">var</span> json = <span class="string">'{"a": "Hello", "b": "World"}'</span>; <span class="comment">//è¿™æ˜¯ä¸€ä¸ª JSON å­—ç¬¦ä¸²ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br></pre></td></tr></tbody></table></figure><h3 id="JSON-å’Œ-JavaScript-å¯¹è±¡äº’è½¬"><a href="#JSON-å’Œ-JavaScript-å¯¹è±¡äº’è½¬" class="headerlink" title="JSON å’Œ JavaScript å¯¹è±¡äº’è½¬"></a><strong>JSON å’Œ JavaScript å¯¹è±¡äº’è½¬</strong></h3><p>è¦å®ç°ä»JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºJavaScript å¯¹è±¡ï¼Œä½¿ç”¨ JSON.parse() æ–¹æ³•ï¼š</p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">'{"a": "Hello", "b": "World"}'</span>);</span><br><span class="line"><span class="comment">//ç»“æœæ˜¯ {a: 'Hello', b: 'World'}</span></span><br></pre></td></tr></tbody></table></figure><p>è¦å®ç°ä»JavaScript å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ JSON.stringify() æ–¹æ³•ï¼š</p><figure class="highlight js"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> json = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>({<span class="attr">a</span>: <span class="string">'Hello'</span>, <span class="attr">b</span>: <span class="string">'World'</span>});</span><br><span class="line"><span class="comment">//ç»“æœæ˜¯ '{"a": "Hello", "b": "World"}'</span></span><br></pre></td></tr></tbody></table></figure><p><strong>ä»£ç æµ‹è¯•</strong></p><p>1ã€æ–°å»ºä¸€ä¸ªmodule ï¼Œspringmvc-05-json ï¼Œ æ·»åŠ webçš„æ”¯æŒ</p><p>2ã€åœ¨webç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª json-1.html ï¼Œ ç¼–å†™æµ‹è¯•å†…å®¹</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>JSON_ç§¦ç–†<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   <span class="comment">//ç¼–å†™ä¸€ä¸ªjsçš„å¯¹è±¡</span></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">var</span> user = {</span></span><br><span class="line"><span class="language-javascript">       <span class="attr">name</span>:<span class="string">"ç§¦ç–†"</span>,</span></span><br><span class="line"><span class="language-javascript">       <span class="attr">age</span>:<span class="number">3</span>,</span></span><br><span class="line"><span class="language-javascript">       <span class="attr">sex</span>:<span class="string">"ç”·"</span></span></span><br><span class="line"><span class="language-javascript">  };</span></span><br><span class="line"><span class="language-javascript">   <span class="comment">//å°†jså¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²</span></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">var</span> str = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user);</span></span><br><span class="line"><span class="language-javascript">   <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span></span><br><span class="line"><span class="language-javascript">   </span></span><br><span class="line"><span class="language-javascript">   <span class="comment">//å°†jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºjså¯¹è±¡</span></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">var</span> user2 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str);</span></span><br><span class="line"><span class="language-javascript">   <span class="variable language_">console</span>.<span class="title function_">log</span>(user2.<span class="property">age</span>,user2.<span class="property">name</span>,user2.<span class="property">sex</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>3ã€åœ¨IDEAä¸­ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Kr2Q3b19mdVPRfiaSSR0OQ2Q8qXVmDPs7ZNuhAueQdj9ibOh9O9lw1535ibtKD0R7VAwPjUQ2kXmVHg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><blockquote><p>Controllerè¿”å›JSONæ•°æ®</p></blockquote><p>Jacksonåº”è¯¥æ˜¯ç›®å‰æ¯”è¾ƒå¥½çš„jsonè§£æå·¥å…·äº†</p><p>å½“ç„¶å·¥å…·ä¸æ­¢è¿™ä¸€ä¸ªï¼Œæ¯”å¦‚è¿˜æœ‰é˜¿é‡Œå·´å·´çš„ fastjson ç­‰ç­‰ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨Jacksonï¼Œä½¿ç”¨å®ƒéœ€è¦å¯¼å…¥å®ƒçš„jaråŒ…ï¼›</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>é…ç½®SpringMVCéœ€è¦çš„é…ç½®</p><p>web.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--1.æ³¨å†Œservlet--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›è¡Œå…³è”--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å¯åŠ¨é¡ºåºï¼Œæ•°å­—è¶Šå°ï¼Œå¯åŠ¨è¶Šæ—© --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«springmvcæ‹¦æˆª --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>springmvc-servlet.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„åŒ…ï¼Œä¸‹é¢æ‰€æœ‰æ³¨è§£ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç† --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.kuang.controller"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">id</span>=<span class="string">"internalResourceViewResolver"</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å‰ç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- åç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>æˆ‘ä»¬éšä¾¿ç¼–å†™ä¸€ä¸ªUserçš„å®ä½“ç±»ï¼Œç„¶åæˆ‘ä»¬å»ç¼–å†™æˆ‘ä»¬çš„æµ‹è¯•Controllerï¼›</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éœ€è¦å¯¼å…¥lombok</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">   <span class="keyword">private</span> String sex;</span><br><span class="line">   </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ–°ä¸œè¥¿ï¼Œä¸€ä¸ªæ˜¯@ResponseBodyï¼Œä¸€ä¸ªæ˜¯ObjectMapperå¯¹è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸‹å…·ä½“çš„ç”¨æ³•</p><p>ç¼–å†™ä¸€ä¸ªControllerï¼›</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> {</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/json1")</span></span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">json1</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException {</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span></span><br><span class="line">       <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†1å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">       <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> mapper.writeValueAsString(user);</span><br><span class="line">       <span class="comment">//ç”±äº@ResponseBodyæ³¨è§£ï¼Œè¿™é‡Œä¼šå°†strè½¬æˆjsonæ ¼å¼è¿”å›ï¼›ååˆ†æ–¹ä¾¿</span></span><br><span class="line">       <span class="keyword">return</span> str;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>é…ç½®Tomcat ï¼Œ å¯åŠ¨æµ‹è¯•ä¸€ä¸‹ï¼</p><p><a href="http://localhost:8080/json1">http://localhost:8080/json1</a></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Kr2Q3b19mdVPRfiaSSR0OQ2QCNxRSJebDzgryI1iapfrwBWibv6Ww2CgofjS5K59zdO02OvpoRXCz2w/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>å‘ç°å‡ºç°äº†ä¹±ç é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸‹ä»–çš„ç¼–ç æ ¼å¼ä¸ºutf-8ï¼Œä»¥åŠå®ƒè¿”å›çš„ç±»å‹ï¼›</p><p>é€šè¿‡@RequestMapingçš„produceså±æ€§æ¥å®ç°ï¼Œä¿®æ”¹ä¸‹ä»£ç </p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//produces:æŒ‡å®šå“åº”ä½“è¿”å›ç±»å‹å’Œç¼–ç </span></span><br><span class="line"><span class="meta">@RequestMapping(value = "/json1",produces = "application/json;charset=utf-8")</span></span><br></pre></td></tr></tbody></table></figure><p>å†æ¬¡æµ‹è¯•ï¼Œ <a href="http://localhost:8080/json1">http://localhost:8080/json1</a> ï¼Œ ä¹±ç é—®é¢˜OKï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Kr2Q3b19mdVPRfiaSSR0OQ2Dib7IK6ugTmbm4JhqphKhoeEh2wyjzj4CWCjpibSh0Lge5zcxxJOib3hQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>ã€æ³¨æ„ï¼šä½¿ç”¨jsonè®°å¾—å¤„ç†ä¹±ç é—®é¢˜ã€‘</p><h3 id="ä»£ç ä¼˜åŒ–"><a href="#ä»£ç ä¼˜åŒ–" class="headerlink" title="ä»£ç ä¼˜åŒ–"></a>ä»£ç ä¼˜åŒ–</h3><p><strong>ä¹±ç ç»Ÿä¸€è§£å†³</strong></p><p>ä¸Šä¸€ç§æ–¹æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœé¡¹ç›®ä¸­æœ‰è®¸å¤šè¯·æ±‚åˆ™æ¯ä¸€ä¸ªéƒ½è¦æ·»åŠ ï¼Œå¯ä»¥é€šè¿‡Springé…ç½®ç»Ÿä¸€æŒ‡å®šï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éƒ½å»å¤„ç†äº†ï¼</p><p>æˆ‘ä»¬å¯ä»¥åœ¨springmvcçš„é…ç½®æ–‡ä»¶ä¸Šæ·»åŠ ä¸€æ®µæ¶ˆæ¯StringHttpMessageConverterè½¬æ¢é…ç½®ï¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"objectMapper"</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean"</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"failOnEmptyBeans"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p><strong>è¿”å›jsonå­—ç¬¦ä¸²ç»Ÿä¸€è§£å†³</strong></p><p>åœ¨ç±»ä¸Šç›´æ¥ä½¿ç”¨ <strong>@RestController</strong> ï¼Œè¿™æ ·å­ï¼Œé‡Œé¢æ‰€æœ‰çš„æ–¹æ³•éƒ½åªä¼šè¿”å› json å­—ç¬¦ä¸²äº†ï¼Œä¸ç”¨å†æ¯ä¸€ä¸ªéƒ½æ·»åŠ @ResponseBody ï¼æˆ‘ä»¬åœ¨å‰åç«¯åˆ†ç¦»å¼€å‘ä¸­ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨ @RestController ï¼Œååˆ†ä¾¿æ·ï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//produces:æŒ‡å®šå“åº”ä½“è¿”å›ç±»å‹å’Œç¼–ç </span></span><br><span class="line">   <span class="meta">@RequestMapping(value = "/json1")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">json1</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException {</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span></span><br><span class="line">       <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†1å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">       <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> mapper.writeValueAsString(user);</span><br><span class="line">       <span class="comment">//ç”±äº@ResponseBodyæ³¨è§£ï¼Œè¿™é‡Œä¼šå°†strè½¬æˆjsonæ ¼å¼è¿”å›ï¼›ååˆ†æ–¹ä¾¿</span></span><br><span class="line">       <span class="keyword">return</span> str;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å¯åŠ¨tomcatæµ‹è¯•ï¼Œç»“æœéƒ½æ­£å¸¸è¾“å‡ºï¼</p><blockquote><p>æµ‹è¯•é›†åˆè¾“å‡º</p></blockquote><p>å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/json2")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">json2</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span></span><br><span class="line">   <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">   <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">   <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†1å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">   <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†2å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">   <span class="type">User</span> <span class="variable">user3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†3å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">   <span class="type">User</span> <span class="variable">user4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†4å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">   List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;User&gt;();</span><br><span class="line">   list.add(user1);</span><br><span class="line">   list.add(user2);</span><br><span class="line">   list.add(user3);</span><br><span class="line">   list.add(user4);</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">   <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> mapper.writeValueAsString(list);</span><br><span class="line">   <span class="keyword">return</span> str;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¿è¡Œç»“æœ : ååˆ†å®Œç¾ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Kr2Q3b19mdVPRfiaSSR0OQ28xBricP4KKliaicvQJJlG989xjEUftuqcibuRPWGHjOZfEA3HiaVTq4GDRw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><blockquote><p>è¾“å‡ºæ—¶é—´å¯¹è±¡</p></blockquote><p>å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/json3")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">json3</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException {</span><br><span class="line"></span><br><span class="line">   <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line"></span><br><span class="line">   <span class="comment">//åˆ›å»ºæ—¶é—´ä¸€ä¸ªå¯¹è±¡ï¼Œjava.util.Date</span></span><br><span class="line">   <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">   <span class="comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span></span><br><span class="line">   <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> mapper.writeValueAsString(date);</span><br><span class="line">   <span class="keyword">return</span> str;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¿è¡Œç»“æœ :</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Kr2Q3b19mdVPRfiaSSR0OQ2wC0G9p8rYjxUNdyVK8oCUicN5LJ9XVsLJddll3tYr28kVaXoUfO0LaQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><ul><li>é»˜è®¤æ—¥æœŸæ ¼å¼ä¼šå˜æˆä¸€ä¸ªæ•°å­—ï¼Œæ˜¯1970å¹´1æœˆ1æ—¥åˆ°å½“å‰æ—¥æœŸçš„æ¯«ç§’æ•°ï¼</li><li>Jackson é»˜è®¤æ˜¯ä¼šæŠŠæ—¶é—´è½¬æˆtimestampså½¢å¼</li></ul><p><strong>è§£å†³æ–¹æ¡ˆï¼šå–æ¶ˆtimestampså½¢å¼ ï¼Œ è‡ªå®šä¹‰æ—¶é—´æ ¼å¼</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/json4")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">json4</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException {</span><br><span class="line"></span><br><span class="line">   <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ä¸ä½¿ç”¨æ—¶é—´æˆ³çš„æ–¹å¼</span></span><br><span class="line">   mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, <span class="literal">false</span>);</span><br><span class="line">   <span class="comment">//è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼å¯¹è±¡</span></span><br><span class="line">   <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">   <span class="comment">//æŒ‡å®šæ—¥æœŸæ ¼å¼</span></span><br><span class="line">   mapper.setDateFormat(sdf);</span><br><span class="line"></span><br><span class="line">   <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">   <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> mapper.writeValueAsString(date);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> str;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¿è¡Œç»“æœ : æˆåŠŸçš„è¾“å‡ºäº†æ—¶é—´ï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Kr2Q3b19mdVPRfiaSSR0OQ2AVT1icKIk8UDdWlERvmsWdgcOPvsEUr3s0lIRVzPd6IhrjiaPCDSibt2Q/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><blockquote><p>æŠ½å–ä¸ºå·¥å…·ç±»</p></blockquote><p><strong>å¦‚æœè¦ç»å¸¸ä½¿ç”¨çš„è¯ï¼Œè¿™æ ·æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä»£ç å°è£…åˆ°ä¸€ä¸ªå·¥å…·ç±»ä¸­ï¼›æˆ‘ä»¬å»ç¼–å†™ä¸‹</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JsonUtils</span> {</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getJson</span><span class="params">(Object object)</span> {</span><br><span class="line">       <span class="keyword">return</span> getJson(object,<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getJson</span><span class="params">(Object object,String dateFormat)</span> {</span><br><span class="line">       <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">       <span class="comment">//ä¸ä½¿ç”¨æ—¶é—´å·®çš„æ–¹å¼</span></span><br><span class="line">       mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, <span class="literal">false</span>);</span><br><span class="line">       <span class="comment">//è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼å¯¹è±¡</span></span><br><span class="line">       <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(dateFormat);</span><br><span class="line">       <span class="comment">//æŒ‡å®šæ—¥æœŸæ ¼å¼</span></span><br><span class="line">       mapper.setDateFormat(sdf);</span><br><span class="line">       <span class="keyword">try</span> {</span><br><span class="line">           <span class="keyword">return</span> mapper.writeValueAsString(object);</span><br><span class="line">      } <span class="keyword">catch</span> (JsonProcessingException e) {</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">      }</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æˆ‘ä»¬ä½¿ç”¨å·¥å…·ç±»ï¼Œä»£ç å°±æ›´åŠ ç®€æ´äº†ï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/json5")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">json5</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException {</span><br><span class="line">   <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">   <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> JsonUtils.getJson(date);</span><br><span class="line">   <span class="keyword">return</span> json;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å¤§åŠŸå‘Šæˆï¼å®Œç¾ï¼</p><blockquote><p>FastJson</p></blockquote><p>fastjson.jaræ˜¯é˜¿é‡Œå¼€å‘çš„ä¸€æ¬¾ä¸“é—¨ç”¨äºJavaå¼€å‘çš„åŒ…ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°jsonå¯¹è±¡ä¸JavaBeanå¯¹è±¡çš„è½¬æ¢ï¼Œå®ç°JavaBeanå¯¹è±¡ä¸jsonå­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå®ç°jsonå¯¹è±¡ä¸jsonå­—ç¬¦ä¸²çš„è½¬æ¢ã€‚å®ç°jsonçš„è½¬æ¢æ–¹æ³•å¾ˆå¤šï¼Œæœ€åçš„å®ç°ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>fastjson çš„ pomä¾èµ–ï¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.60<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>fastjson ä¸‰ä¸ªä¸»è¦çš„ç±»ï¼š</p><p><strong>JSONObject  ä»£è¡¨ json å¯¹è±¡</strong> </p><ul><li>JSONObjectå®ç°äº†Mapæ¥å£, çŒœæƒ³ JSONObjectåº•å±‚æ“ä½œæ˜¯ç”±Mapå®ç°çš„ã€‚</li><li>JSONObjectå¯¹åº”jsonå¯¹è±¡ï¼Œé€šè¿‡å„ç§å½¢å¼çš„get()æ–¹æ³•å¯ä»¥è·å–jsonå¯¹è±¡ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯åˆ©ç”¨è¯¸å¦‚size()ï¼ŒisEmpty()ç­‰æ–¹æ³•è·å–â€é”®ï¼šå€¼â€å¯¹çš„ä¸ªæ•°å’Œåˆ¤æ–­æ˜¯å¦ä¸ºç©ºã€‚å…¶æœ¬è´¨æ˜¯é€šè¿‡å®ç°Mapæ¥å£å¹¶è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•å®Œæˆçš„ã€‚</li></ul><p><strong>JSONArray  ä»£è¡¨ json å¯¹è±¡æ•°ç»„</strong></p><ul><li>å†…éƒ¨æ˜¯æœ‰Listæ¥å£ä¸­çš„æ–¹æ³•æ¥å®Œæˆæ“ä½œçš„ã€‚</li></ul><p><strong>JSONä»£è¡¨ JSONObjectå’ŒJSONArrayçš„è½¬åŒ–</strong></p><ul><li>JSONç±»æºç åˆ†æä¸ä½¿ç”¨</li><li>ä»”ç»†è§‚å¯Ÿè¿™äº›æ–¹æ³•ï¼Œä¸»è¦æ˜¯å®ç°jsonå¯¹è±¡ï¼Œjsonå¯¹è±¡æ•°ç»„ï¼Œjavabeanå¯¹è±¡ï¼Œjsonå­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬åŒ–ã€‚</li></ul><p><strong>ä»£ç æµ‹è¯•ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªFastJsonDemo ç±»</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.kuang.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FastJsonDemo</span> {</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">       <span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†1å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†2å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">user3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†3å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">user4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†4å·"</span>, <span class="number">3</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">       List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;User&gt;();</span><br><span class="line">       list.add(user1);</span><br><span class="line">       list.add(user2);</span><br><span class="line">       list.add(user3);</span><br><span class="line">       list.add(user4);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"*******Javaå¯¹è±¡ è½¬ JSONå­—ç¬¦ä¸²*******"</span>);</span><br><span class="line">       <span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> JSON.toJSONString(list);</span><br><span class="line">       System.out.println(<span class="string">"JSON.toJSONString(list)==&gt;"</span>+str1);</span><br><span class="line">       <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> JSON.toJSONString(user1);</span><br><span class="line">       System.out.println(<span class="string">"JSON.toJSONString(user1)==&gt;"</span>+str2);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"\n****** JSONå­—ç¬¦ä¸² è½¬ Javaå¯¹è±¡*******"</span>);</span><br><span class="line">       User jp_user1=JSON.parseObject(str2,User.class);</span><br><span class="line">       System.out.println(<span class="string">"JSON.parseObject(str2,User.class)==&gt;"</span>+jp_user1);</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"\n****** Javaå¯¹è±¡ è½¬ JSONå¯¹è±¡ ******"</span>);</span><br><span class="line">       <span class="type">JSONObject</span> <span class="variable">jsonObject1</span> <span class="operator">=</span> (JSONObject) JSON.toJSON(user2);</span><br><span class="line">       System.out.println(<span class="string">"(JSONObject) JSON.toJSON(user2)==&gt;"</span>+jsonObject1.getString(<span class="string">"name"</span>));</span><br><span class="line"></span><br><span class="line">       System.out.println(<span class="string">"\n****** JSONå¯¹è±¡ è½¬ Javaå¯¹è±¡ ******"</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">to_java_user</span> <span class="operator">=</span> JSON.toJavaObject(jsonObject1, User.class);</span><br><span class="line">       System.out.println(<span class="string">"JSON.toJavaObject(jsonObject1, User.class)==&gt;"</span>+to_java_user);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¿™ç§å·¥å…·ç±»ï¼Œæˆ‘ä»¬åªéœ€è¦æŒæ¡ä½¿ç”¨å°±å¥½äº†ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™åœ¨æ ¹æ®å…·ä½“çš„ä¸šåŠ¡å»æ‰¾å¯¹åº”çš„å®ç°ã€‚å’Œä»¥å‰çš„commons-ioé‚£ç§å·¥å…·åŒ…ä¸€æ ·ï¼Œæ‹¿æ¥ç”¨å°±å¥½äº†ï¼</p><h2 id="äº”ã€æ•´åˆSSM"><a href="#äº”ã€æ•´åˆSSM" class="headerlink" title="äº”ã€æ•´åˆSSM"></a>äº”ã€æ•´åˆSSM</h2><h3 id="ç¯å¢ƒè¦æ±‚"><a href="#ç¯å¢ƒè¦æ±‚" class="headerlink" title="ç¯å¢ƒè¦æ±‚"></a>ç¯å¢ƒè¦æ±‚</h3><p>ç¯å¢ƒï¼š</p><ul><li>IDEA</li><li>MySQL 5.7.19</li><li>Tomcat 9</li><li>Maven 3.6</li></ul><p> è¦æ±‚ï¼š</p><ul><li>éœ€è¦ç†Ÿç»ƒæŒæ¡MySQLæ•°æ®åº“ï¼ŒSpringï¼ŒJavaWebåŠMyBatisçŸ¥è¯†ï¼Œç®€å•çš„å‰ç«¯çŸ¥è¯†ï¼›</li></ul><h4 id="æ•°æ®åº“ç¯å¢ƒ"><a href="#æ•°æ®åº“ç¯å¢ƒ" class="headerlink" title="æ•°æ®åº“ç¯å¢ƒ"></a>æ•°æ®åº“ç¯å¢ƒ</h4><p>åˆ›å»ºä¸€ä¸ªå­˜æ”¾ä¹¦ç±æ•°æ®çš„æ•°æ®åº“è¡¨</p><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE `ssmbuild`;</span><br><span class="line"></span><br><span class="line">USE `ssmbuild`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `books`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `books` (</span><br><span class="line">`bookID` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">'ä¹¦id'</span>,</span><br><span class="line">`bookName` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'ä¹¦å'</span>,</span><br><span class="line">`bookCounts` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'æ•°é‡'</span>,</span><br><span class="line">`detail` <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'æè¿°'</span>,</span><br><span class="line">KEY `bookID` (`bookID`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span>  <span class="keyword">INTO</span> `books`(`bookID`,`bookName`,`bookCounts`,`detail`)<span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>,<span class="string">'Java'</span>,<span class="number">1</span>,<span class="string">'ä»å…¥é—¨åˆ°æ”¾å¼ƒ'</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">'MySQL'</span>,<span class="number">10</span>,<span class="string">'ä»åˆ åº“åˆ°è·‘è·¯'</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">'Linux'</span>,<span class="number">5</span>,<span class="string">'ä»è¿›é—¨åˆ°è¿›ç‰¢'</span>);</span><br></pre></td></tr></tbody></table></figure><h4 id="åŸºæœ¬ç¯å¢ƒæ­å»º"><a href="#åŸºæœ¬ç¯å¢ƒæ­å»º" class="headerlink" title="åŸºæœ¬ç¯å¢ƒæ­å»º"></a>åŸºæœ¬ç¯å¢ƒæ­å»º</h4><p>1ã€æ–°å»ºä¸€Mavené¡¹ç›®ï¼ssmbuild ï¼Œ æ·»åŠ webçš„æ”¯æŒ</p><p>2ã€å¯¼å…¥ç›¸å…³çš„pomä¾èµ–ï¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--Junit--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æ•°æ®åº“é©±åŠ¨--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- æ•°æ®åº“è¿æ¥æ±  --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--Servlet - JSP --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--Mybatis--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--Spring--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>3ã€Mavenèµ„æºè¿‡æ»¤è®¾ç½®</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>4ã€å»ºç«‹åŸºæœ¬ç»“æ„å’Œé…ç½®æ¡†æ¶ï¼</p><ul><li><p>com.kuang.pojo</p></li><li><p>com.kuang.dao</p></li><li><p>com.kuang.service</p></li><li><p>com.kuang.controller</p></li><li><p>mybatis-config.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">       <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">       <span class="string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>applicationContext.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li></ul><h4 id="Mybatiså±‚ç¼–å†™"><a href="#Mybatiså±‚ç¼–å†™" class="headerlink" title="Mybatiså±‚ç¼–å†™"></a>Mybatiså±‚ç¼–å†™</h4><p>1ã€æ•°æ®åº“é…ç½®æ–‡ä»¶ <strong>database.properties</strong></p><figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="comment">#å¦‚æœä½¿ç”¨çš„æ˜¯Mysql8.0+éœ€è¦å¢åŠ ä¸€ä¸ªæ—¶åŒºçš„é…ç½®</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/ssmbuild?useSSL=true&amp;useUnicode=true&amp;characterEncoding=utf8&amp;ServerTimezone=Asia/Chongqing</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">123456</span></span><br></pre></td></tr></tbody></table></figure><p>2ã€IDEAå…³è”æ•°æ®åº“</p><p>3ã€ç¼–å†™MyBatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">       <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">       <span class="string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.kuang.pojo"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/kuang/dao/BookMapper.xml"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>4ã€ç¼–å†™æ•°æ®åº“å¯¹åº”çš„å®ä½“ç±» com.kuang.pojo.Books</p><p>ä½¿ç”¨lombokæ’ä»¶ï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Books</span> {</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> bookID;</span><br><span class="line">   <span class="keyword">private</span> String bookName;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> bookCounts;</span><br><span class="line">   <span class="keyword">private</span> String detail;</span><br><span class="line">   </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>5ã€ç¼–å†™Daoå±‚çš„ Mapperæ¥å£ï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.kuang.pojo.Books;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookMapper</span> {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å¢åŠ ä¸€ä¸ªBook</span></span><br><span class="line">   <span class="type">int</span> <span class="title function_">addBook</span><span class="params">(Books book)</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook</span></span><br><span class="line">   <span class="type">int</span> <span class="title function_">deleteBookById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ›´æ–°Book</span></span><br><span class="line">   <span class="type">int</span> <span class="title function_">updateBook</span><span class="params">(Books books)</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook</span></span><br><span class="line">   Books <span class="title function_">queryBookById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//æŸ¥è¯¢å…¨éƒ¨Book,è¿”å›listé›†åˆ</span></span><br><span class="line">   List&lt;Books&gt; <span class="title function_">queryAllBook</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>6ã€ç¼–å†™æ¥å£å¯¹åº”çš„ Mapper.xml æ–‡ä»¶ã€‚éœ€è¦å¯¼å…¥MyBatisçš„åŒ…ï¼›</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">       <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">       <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.kuang.dao.BookMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--å¢åŠ ä¸€ä¸ªBook--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addBook"</span> <span class="attr">parameterType</span>=<span class="string">"Books"</span>&gt;</span></span><br><span class="line">      insert into ssmbuild.books(bookName,bookCounts,detail)</span><br><span class="line">      values (#{bookName}, #{bookCounts}, #{detail})</span><br><span class="line">   <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteBookById"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">      delete from ssmbuild.books where bookID=#{bookID}</span><br><span class="line">   <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ›´æ–°Book--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateBook"</span> <span class="attr">parameterType</span>=<span class="string">"Books"</span>&gt;</span></span><br><span class="line">      update ssmbuild.books</span><br><span class="line">      set bookName = #{bookName},bookCounts = #{bookCounts},detail = #{detail}</span><br><span class="line">      where bookID = #{bookID}</span><br><span class="line">   <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBookById"</span> <span class="attr">resultType</span>=<span class="string">"Books"</span>&gt;</span></span><br><span class="line">      select * from ssmbuild.books</span><br><span class="line">      where bookID = #{bookID}</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--æŸ¥è¯¢å…¨éƒ¨Book--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryAllBook"</span> <span class="attr">resultType</span>=<span class="string">"Books"</span>&gt;</span></span><br><span class="line">      SELECT * from ssmbuild.books</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>7ã€ç¼–å†™Serviceå±‚çš„æ¥å£å’Œå®ç°ç±»</p><p>æ¥å£ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.kuang.pojo.Books;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">//BookService:åº•ä¸‹éœ€è¦å»å®ç°,è°ƒç”¨daoå±‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookService</span> {</span><br><span class="line">   <span class="comment">//å¢åŠ ä¸€ä¸ªBook</span></span><br><span class="line">   <span class="type">int</span> <span class="title function_">addBook</span><span class="params">(Books book)</span>;</span><br><span class="line">   <span class="comment">//æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook</span></span><br><span class="line">   <span class="type">int</span> <span class="title function_">deleteBookById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line">   <span class="comment">//æ›´æ–°Book</span></span><br><span class="line">   <span class="type">int</span> <span class="title function_">updateBook</span><span class="params">(Books books)</span>;</span><br><span class="line">   <span class="comment">//æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook</span></span><br><span class="line">   Books <span class="title function_">queryBookById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line">   <span class="comment">//æŸ¥è¯¢å…¨éƒ¨Book,è¿”å›listé›†åˆ</span></span><br><span class="line">   List&lt;Books&gt; <span class="title function_">queryAllBook</span><span class="params">()</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å®ç°ç±»ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.kuang.dao.BookMapper;</span><br><span class="line"><span class="keyword">import</span> com.kuang.pojo.Books;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//è°ƒç”¨daoå±‚çš„æ“ä½œï¼Œè®¾ç½®ä¸€ä¸ªsetæ¥å£ï¼Œæ–¹ä¾¿Springç®¡ç†</span></span><br><span class="line">   <span class="keyword">private</span> BookMapper bookMapper;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookMapper</span><span class="params">(BookMapper bookMapper)</span> {</span><br><span class="line">       <span class="built_in">this</span>.bookMapper = bookMapper;</span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">addBook</span><span class="params">(Books book)</span> {</span><br><span class="line">       <span class="keyword">return</span> bookMapper.addBook(book);</span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteBookById</span><span class="params">(<span class="type">int</span> id)</span> {</span><br><span class="line">       <span class="keyword">return</span> bookMapper.deleteBookById(id);</span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">updateBook</span><span class="params">(Books books)</span> {</span><br><span class="line">       <span class="keyword">return</span> bookMapper.updateBook(books);</span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> Books <span class="title function_">queryBookById</span><span class="params">(<span class="type">int</span> id)</span> {</span><br><span class="line">       <span class="keyword">return</span> bookMapper.queryBookById(id);</span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> List&lt;Books&gt; <span class="title function_">queryAllBook</span><span class="params">()</span> {</span><br><span class="line">       <span class="keyword">return</span> bookMapper.queryAllBook();</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>OKï¼Œåˆ°æ­¤ï¼Œåº•å±‚éœ€æ±‚æ“ä½œç¼–å†™å®Œæ¯•ï¼</strong></p><h4 id="Springå±‚"><a href="#Springå±‚" class="headerlink" title="Springå±‚"></a>Springå±‚</h4><p>1ã€é…ç½®<strong>Springæ•´åˆMyBatis</strong>ï¼Œæˆ‘ä»¬è¿™é‡Œæ•°æ®æºä½¿ç”¨c3p0è¿æ¥æ± ï¼›</p><p>2ã€æˆ‘ä»¬å»ç¼–å†™Springæ•´åˆMybatisçš„ç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼›spring-dao.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- é…ç½®æ•´åˆmybatis --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 1.å…³è”æ•°æ®åº“æ–‡ä»¶ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:database.properties"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 2.æ•°æ®åº“è¿æ¥æ±  --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--æ•°æ®åº“è¿æ¥æ± </span></span><br><span class="line"><span class="comment">       dbcp åŠè‡ªåŠ¨åŒ–æ“ä½œ ä¸èƒ½è‡ªåŠ¨è¿æ¥</span></span><br><span class="line"><span class="comment">       c3p0 è‡ªåŠ¨åŒ–æ“ä½œï¼ˆè‡ªåŠ¨çš„åŠ è½½é…ç½®æ–‡ä»¶ å¹¶ä¸”è®¾ç½®åˆ°å¯¹è±¡é‡Œé¢ï¼‰</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- é…ç½®è¿æ¥æ± å±æ€§ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"${jdbc.driver}"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"${jdbc.url}"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"${jdbc.username}"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"${jdbc.password}"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">&lt;!-- c3p0è¿æ¥æ± çš„ç§æœ‰å±æ€§ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxPoolSize"</span> <span class="attr">value</span>=<span class="string">"30"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minPoolSize"</span> <span class="attr">value</span>=<span class="string">"10"</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å…³é—­è¿æ¥åä¸è‡ªåŠ¨commit --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"autoCommitOnClose"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- è·å–è¿æ¥è¶…æ—¶æ—¶é—´ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"checkoutTimeout"</span> <span class="attr">value</span>=<span class="string">"10000"</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å½“è·å–è¿æ¥å¤±è´¥é‡è¯•æ¬¡æ•° --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"acquireRetryAttempts"</span> <span class="attr">value</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 3.é…ç½®SqlSessionFactoryå¯¹è±¡ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- æ³¨å…¥æ•°æ®åº“è¿æ¥æ±  --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- é…ç½®MyBatieså…¨å±€é…ç½®æ–‡ä»¶:mybatis-config.xml --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 4.é…ç½®æ‰«æDaoæ¥å£åŒ…ï¼ŒåŠ¨æ€å®ç°Daoæ¥å£æ³¨å…¥åˆ°springå®¹å™¨ä¸­ --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--è§£é‡Š ï¼šhttps://www.cnblogs.com/jpfss/p/7799806.html--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- æ³¨å…¥sqlSessionFactory --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- ç»™å‡ºéœ€è¦æ‰«æDaoæ¥å£åŒ… --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.kuang.dao"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>3ã€Springæ•´åˆserviceå±‚</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- æ‰«æserviceç›¸å…³çš„bean --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.kuang.service"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--BookServiceImplæ³¨å…¥åˆ°IOCå®¹å™¨ä¸­--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"BookServiceImpl"</span> <span class="attr">class</span>=<span class="string">"com.kuang.service.BookServiceImpl"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"bookMapper"</span> <span class="attr">ref</span>=<span class="string">"bookMapper"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- æ³¨å…¥æ•°æ®åº“è¿æ¥æ±  --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>Springå±‚æå®šï¼å†æ¬¡ç†è§£ä¸€ä¸‹ï¼ŒSpringå°±æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ï¼Œä¸€ä¸ªå®¹å™¨ï¼å¯¹å§ï¼</p><h4 id="SpringMVCå±‚"><a href="#SpringMVCå±‚" class="headerlink" title="SpringMVCå±‚"></a>SpringMVCå±‚</h4><p>1ã€<strong>web.xml</strong></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--DispatcherServlet--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="comment">&lt;!--ä¸€å®šè¦æ³¨æ„:æˆ‘ä»¬è¿™é‡ŒåŠ è½½çš„æ˜¯æ€»çš„é…ç½®æ–‡ä»¶ï¼Œä¹‹å‰è¢«è¿™é‡Œå‘äº†ï¼--&gt;</span>  </span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--encodingFilter--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">          org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">       <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">&lt;!--Sessionè¿‡æœŸæ—¶é—´--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>15<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>2ã€<strong>spring-mvc.xml</strong></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">   https://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- é…ç½®SpringMVC --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 1.å¼€å¯SpringMVCæ³¨è§£é©±åŠ¨ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 2.é™æ€èµ„æºé»˜è®¤servleté…ç½®--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 3.é…ç½®jsp æ˜¾ç¤ºViewResolverè§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"viewClass"</span> <span class="attr">value</span>=<span class="string">"org.springframework.web.servlet.view.JstlView"</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 4.æ‰«æwebç›¸å…³çš„bean --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.kuang.controller"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>3ã€<strong>Springé…ç½®æ•´åˆæ–‡ä»¶ï¼ŒapplicationContext.xml</strong></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring-dao.xml"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring-service.xml"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring-mvc.xml"</span>/&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p><strong>é…ç½®æ–‡ä»¶ï¼Œæš‚æ—¶ç»“æŸï¼</strong></p><h4 id="Controller-å’Œ-è§†å›¾å±‚ç¼–å†™"><a href="#Controller-å’Œ-è§†å›¾å±‚ç¼–å†™" class="headerlink" title="Controller å’Œ è§†å›¾å±‚ç¼–å†™"></a><strong>Controller å’Œ è§†å›¾å±‚ç¼–å†™</strong></h4><p>1ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸€ï¼šæŸ¥è¯¢å…¨éƒ¨ä¹¦ç±</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping("/book")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookController</span> {</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="meta">@Qualifier("BookServiceImpl")</span></span><br><span class="line">   <span class="keyword">private</span> BookService bookService;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/allBook")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">list</span><span class="params">(Model model)</span> {</span><br><span class="line">       List&lt;Books&gt; list = bookService.queryAllBook();</span><br><span class="line">       model.addAttribute(<span class="string">"list"</span>, list);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"allBook"</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>2ã€ç¼–å†™é¦–é¡µ <strong>index.jsp</strong></p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;é¦–é¡µ&lt;/title&gt;</span><br><span class="line">   &lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line">       a {</span><br><span class="line">           text-decoration: none;</span><br><span class="line">           color: black;</span><br><span class="line">           font-size: 18px;</span><br><span class="line">      }</span><br><span class="line">       h3 {</span><br><span class="line">           width: 180px;</span><br><span class="line">           height: 38px;</span><br><span class="line">           margin: 100px auto;</span><br><span class="line">           text-align: center;</span><br><span class="line">           line-height: 38px;</span><br><span class="line">           background: deepskyblue;</span><br><span class="line">           border-radius: 4px;</span><br><span class="line">      }</span><br><span class="line">   &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h3&gt;</span><br><span class="line">   &lt;a href=<span class="string">"${pageContext.request.contextPath}/book/allBook"</span>&gt;ç‚¹å‡»è¿›å…¥åˆ—è¡¨é¡µ&lt;/a&gt;</span><br><span class="line">&lt;/h3&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>3ã€ä¹¦ç±åˆ—è¡¨é¡µé¢ <strong>allbook.jsp</strong></p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;ä¹¦ç±åˆ—è¡¨&lt;/title&gt;</span><br><span class="line">   &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">   &lt;!-- å¼•å…¥ Bootstrap --&gt;</span><br><span class="line">   &lt;link href=<span class="string">"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"container"</span>&gt;</span><br><span class="line"></span><br><span class="line">   &lt;div class=<span class="string">"row clearfix"</span>&gt;</span><br><span class="line">       &lt;div class=<span class="string">"col-md-12 column"</span>&gt;</span><br><span class="line">           &lt;div class=<span class="string">"page-header"</span>&gt;</span><br><span class="line">               &lt;h1&gt;</span><br><span class="line">                   &lt;small&gt;ä¹¦ç±åˆ—è¡¨ â€”â€” æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç±&lt;/small&gt;</span><br><span class="line">               &lt;/h1&gt;</span><br><span class="line">           &lt;/div&gt;</span><br><span class="line">       &lt;/div&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">   &lt;div class=<span class="string">"row"</span>&gt;</span><br><span class="line">       &lt;div class=<span class="string">"col-md-4 column"</span>&gt;</span><br><span class="line">           &lt;a class=<span class="string">"btn btn-primary"</span> href=<span class="string">"${pageContext.request.contextPath}/book/toAddBook"</span>&gt;æ–°å¢&lt;/a&gt;</span><br><span class="line">       &lt;/div&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">   &lt;div class=<span class="string">"row clearfix"</span>&gt;</span><br><span class="line">       &lt;div class=<span class="string">"col-md-12 column"</span>&gt;</span><br><span class="line">           &lt;table class=<span class="string">"table table-hover table-striped"</span>&gt;</span><br><span class="line">               &lt;thead&gt;</span><br><span class="line">               &lt;tr&gt;</span><br><span class="line">                   &lt;th&gt;ä¹¦ç±ç¼–å·&lt;/th&gt;</span><br><span class="line">                   &lt;th&gt;ä¹¦ç±åå­—&lt;/th&gt;</span><br><span class="line">                   &lt;th&gt;ä¹¦ç±æ•°é‡&lt;/th&gt;</span><br><span class="line">                   &lt;th&gt;ä¹¦ç±è¯¦æƒ…&lt;/th&gt;</span><br><span class="line">                   &lt;th&gt;æ“ä½œ&lt;/th&gt;</span><br><span class="line">               &lt;/tr&gt;</span><br><span class="line">               &lt;/thead&gt;</span><br><span class="line"></span><br><span class="line">               &lt;tbody&gt;</span><br><span class="line">               &lt;c:forEach <span class="keyword">var</span>=<span class="string">"book"</span> items=<span class="string">"${requestScope.get('list')}"</span>&gt;</span><br><span class="line">                   &lt;tr&gt;</span><br><span class="line">                       &lt;td&gt;${book.getBookID()}&lt;/td&gt;</span><br><span class="line">                       &lt;td&gt;${book.getBookName()}&lt;/td&gt;</span><br><span class="line">                       &lt;td&gt;${book.getBookCounts()}&lt;/td&gt;</span><br><span class="line">                       &lt;td&gt;${book.getDetail()}&lt;/td&gt;</span><br><span class="line">                       &lt;td&gt;</span><br><span class="line">                           &lt;a href=<span class="string">"${pageContext.request.contextPath}/book/toUpdateBook?id=${book.getBookID()}"</span>&gt;æ›´æ”¹&lt;/a&gt; |</span><br><span class="line">                           &lt;a href=<span class="string">"${pageContext.request.contextPath}/book/del/${book.getBookID()}"</span>&gt;åˆ é™¤&lt;/a&gt;</span><br><span class="line">                       &lt;/td&gt;</span><br><span class="line">                   &lt;/tr&gt;</span><br><span class="line">               &lt;/c:forEach&gt;</span><br><span class="line">               &lt;/tbody&gt;</span><br><span class="line">           &lt;/table&gt;</span><br><span class="line">       &lt;/div&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></tbody></table></figure><p>4ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•äºŒï¼šæ·»åŠ ä¹¦ç±</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/toAddBook")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toAddPaper</span><span class="params">()</span> {</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"addBook"</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping("/addBook")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">addPaper</span><span class="params">(Books books)</span> {</span><br><span class="line">   System.out.println(books);</span><br><span class="line">   bookService.addBook(books);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"redirect:/book/allBook"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>5ã€æ·»åŠ ä¹¦ç±é¡µé¢ï¼š<strong>addBook.jsp</strong></p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;æ–°å¢ä¹¦ç±&lt;/title&gt;</span><br><span class="line">   &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">   &lt;!-- å¼•å…¥ Bootstrap --&gt;</span><br><span class="line">   &lt;link href=<span class="string">"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=<span class="string">"container"</span>&gt;</span><br><span class="line"></span><br><span class="line">   &lt;div class=<span class="string">"row clearfix"</span>&gt;</span><br><span class="line">       &lt;div class=<span class="string">"col-md-12 column"</span>&gt;</span><br><span class="line">           &lt;div class=<span class="string">"page-header"</span>&gt;</span><br><span class="line">               &lt;h1&gt;</span><br><span class="line">                   &lt;small&gt;æ–°å¢ä¹¦ç±&lt;/small&gt;</span><br><span class="line">               &lt;/h1&gt;</span><br><span class="line">           &lt;/div&gt;</span><br><span class="line">       &lt;/div&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">   &lt;form action=<span class="string">"${pageContext.request.contextPath}/book/addBook"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">      ä¹¦ç±åç§°ï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"bookName"</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">      ä¹¦ç±æ•°é‡ï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"bookCounts"</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">      ä¹¦ç±è¯¦æƒ…ï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"detail"</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">       &lt;input type=<span class="string">"submit"</span> value=<span class="string">"æ·»åŠ "</span>&gt;</span><br><span class="line">   &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></tbody></table></figure><p>6ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸‰ï¼šä¿®æ”¹ä¹¦ç±</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/toUpdateBook")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toUpdateBook</span><span class="params">(Model model, <span class="type">int</span> id)</span> {</span><br><span class="line">   <span class="type">Books</span> <span class="variable">books</span> <span class="operator">=</span> bookService.queryBookById(id);</span><br><span class="line">   System.out.println(books);</span><br><span class="line">   model.addAttribute(<span class="string">"book"</span>,books );</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"updateBook"</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping("/updateBook")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">updateBook</span><span class="params">(Model model, Books book)</span> {</span><br><span class="line">   System.out.println(book);</span><br><span class="line">   bookService.updateBook(book);</span><br><span class="line">   <span class="type">Books</span> <span class="variable">books</span> <span class="operator">=</span> bookService.queryBookById(book.getBookID());</span><br><span class="line">   model.addAttribute(<span class="string">"books"</span>, books);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"redirect:/book/allBook"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>7ã€ä¿®æ”¹ä¹¦ç±é¡µé¢  <strong>updateBook.jsp</strong></p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;ä¿®æ”¹ä¿¡æ¯&lt;/title&gt;</span><br><span class="line">   &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">   &lt;!-- å¼•å…¥ Bootstrap --&gt;</span><br><span class="line">   &lt;link href=<span class="string">"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=<span class="string">"container"</span>&gt;</span><br><span class="line"></span><br><span class="line">   &lt;div class=<span class="string">"row clearfix"</span>&gt;</span><br><span class="line">       &lt;div class=<span class="string">"col-md-12 column"</span>&gt;</span><br><span class="line">           &lt;div class=<span class="string">"page-header"</span>&gt;</span><br><span class="line">               &lt;h1&gt;</span><br><span class="line">                   &lt;small&gt;ä¿®æ”¹ä¿¡æ¯&lt;/small&gt;</span><br><span class="line">               &lt;/h1&gt;</span><br><span class="line">           &lt;/div&gt;</span><br><span class="line">       &lt;/div&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">   &lt;form action=<span class="string">"${pageContext.request.contextPath}/book/updateBook"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">       &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"bookID"</span> value=<span class="string">"${book.getBookID()}"</span>/&gt;</span><br><span class="line">      ä¹¦ç±åç§°ï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"bookName"</span> value=<span class="string">"${book.getBookName()}"</span>/&gt;</span><br><span class="line">      ä¹¦ç±æ•°é‡ï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"bookCounts"</span> value=<span class="string">"${book.getBookCounts()}"</span>/&gt;</span><br><span class="line">      ä¹¦ç±è¯¦æƒ…ï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"detail"</span> value=<span class="string">"${book.getDetail() }"</span>/&gt;</span><br><span class="line">       &lt;input type=<span class="string">"submit"</span> value=<span class="string">"æäº¤"</span>/&gt;</span><br><span class="line">   &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></tbody></table></figure><p>8ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•å››ï¼šåˆ é™¤ä¹¦ç±</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/del/{bookId}")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">deleteBook</span><span class="params">(<span class="meta">@PathVariable("bookId")</span> <span class="type">int</span> id)</span> {</span><br><span class="line">   bookService.deleteBookById(id);</span><br><span class="line">   <span class="keyword">return</span> <span class="string">"redirect:/book/allBook"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>é…ç½®Tomcatï¼Œè¿›è¡Œè¿è¡Œï¼</strong></p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªSSMé¡¹ç›®æ•´åˆå·²ç»å®Œå…¨çš„OKäº†ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œè¿›è¡Œæµ‹è¯•ï¼è¿™ä¸ªç»ƒä¹ ååˆ†çš„é‡è¦ï¼Œå¤§å®¶éœ€è¦ä¿è¯ï¼Œä¸çœ‹ä»»ä½•ä¸œè¥¿ï¼Œè‡ªå·±ä¹Ÿå¯ä»¥å®Œæ•´çš„å®ç°å‡ºæ¥ï¼</p><h4 id="é¡¹ç›®ç»“æ„å›¾"><a href="#é¡¹ç›®ç»“æ„å›¾" class="headerlink" title="é¡¹ç›®ç»“æ„å›¾"></a><strong>é¡¹ç›®ç»“æ„å›¾</strong></h4><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Ia40lmtNCqoTzA58pI46q4FvRpJa5kiaGm2TSfRhrLZQonS28jGsBb3WEGe5uqJVosLrB64X7AVSQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7Ia40lmtNCqoTzA58pI46q4Zf0Z4iabyfgc9OPrZnOhctwGM99LzkicKctNoXM7nq45VShnMdhbZ4KA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><h2 id="å…­ã€Ajax"><a href="#å…­ã€Ajax" class="headerlink" title="å…­ã€Ajax"></a>å…­ã€Ajax</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><ul><li><p><strong>AJAX = Asynchronous JavaScript and XMLï¼ˆå¼‚æ­¥çš„ JavaScript å’Œ XMLï¼‰ã€‚</strong></p></li><li><p>AJAX æ˜¯ä¸€ç§åœ¨æ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿæ›´æ–°éƒ¨åˆ†ç½‘é¡µçš„æŠ€æœ¯ã€‚</p></li><li><p><strong>Ajax ä¸æ˜¯ä¸€ç§æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯ä¸€ç§ç”¨äºåˆ›å»ºæ›´å¥½æ›´å¿«ä»¥åŠäº¤äº’æ€§æ›´å¼ºçš„Webåº”ç”¨ç¨‹åºçš„æŠ€æœ¯ã€‚</strong></p></li><li><p>åœ¨ 2005 å¹´ï¼ŒGoogle é€šè¿‡å…¶ Google Suggest ä½¿ AJAX å˜å¾—æµè¡Œèµ·æ¥ã€‚Google Suggestèƒ½å¤Ÿè‡ªåŠ¨å¸®ä½ å®Œæˆæœç´¢å•è¯ã€‚</p></li><li><p>Google Suggest ä½¿ç”¨ AJAX åˆ›é€ å‡ºåŠ¨æ€æ€§æå¼ºçš„ web ç•Œé¢ï¼šå½“æ‚¨åœ¨è°·æ­Œçš„æœç´¢æ¡†è¾“å…¥å…³é”®å­—æ—¶ï¼ŒJavaScript ä¼šæŠŠè¿™äº›å­—ç¬¦å‘é€åˆ°æœåŠ¡å™¨ï¼Œç„¶åæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæœç´¢å»ºè®®çš„åˆ—è¡¨ã€‚</p></li><li><p>å°±å’Œå›½å†…ç™¾åº¦çš„æœç´¢æ¡†ä¸€æ ·!</p></li><li><p>ä¼ ç»Ÿçš„ç½‘é¡µ(å³ä¸ç”¨ajaxæŠ€æœ¯çš„ç½‘é¡µ)ï¼Œæƒ³è¦æ›´æ–°å†…å®¹æˆ–è€…æäº¤ä¸€ä¸ªè¡¨å•ï¼Œéƒ½éœ€è¦é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µã€‚</p></li><li><p>ä½¿ç”¨ajaxæŠ€æœ¯çš„ç½‘é¡µï¼Œé€šè¿‡åœ¨åå°æœåŠ¡å™¨è¿›è¡Œå°‘é‡çš„æ•°æ®äº¤æ¢ï¼Œå°±å¯ä»¥å®ç°å¼‚æ­¥å±€éƒ¨æ›´æ–°ã€‚</p></li><li><p>ä½¿ç”¨Ajaxï¼Œç”¨æˆ·å¯ä»¥åˆ›å»ºæ¥è¿‘æœ¬åœ°æ¡Œé¢åº”ç”¨çš„ç›´æ¥ã€é«˜å¯ç”¨ã€æ›´ä¸°å¯Œã€æ›´åŠ¨æ€çš„Webç”¨æˆ·ç•Œé¢ã€‚</p></li></ul><h3 id="ä¼ªé€ Ajax"><a href="#ä¼ªé€ Ajax" class="headerlink" title="ä¼ªé€ Ajax"></a>ä¼ªé€ Ajax</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‰ç«¯çš„ä¸€ä¸ªæ ‡ç­¾æ¥ä¼ªé€ ä¸€ä¸ªajaxçš„æ ·å­ã€‚iframeæ ‡ç­¾</p><p>1ã€æ–°å»ºä¸€ä¸ªmodule ï¼šsspringmvc-06-ajax ï¼Œ å¯¼å…¥webæ”¯æŒï¼</p><p>2ã€ç¼–å†™ä¸€ä¸ª ajax-frame.html ä½¿ç”¨ iframe æµ‹è¯•ï¼Œæ„Ÿå—ä¸‹æ•ˆæœ</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head lang=<span class="string">"en"</span>&gt;</span><br><span class="line">   &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">   &lt;title&gt;kuangshen&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">   window.onload = function(){</span><br><span class="line">       <span class="type">var</span> <span class="variable">myDate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">       document.getElementById(<span class="string">'currentTime'</span>).innerText = myDate.getTime();</span><br><span class="line">  };</span><br><span class="line"></span><br><span class="line">   function <span class="title function_">LoadPage</span><span class="params">()</span>{</span><br><span class="line">       <span class="type">var</span> <span class="variable">targetUrl</span> <span class="operator">=</span>  document.getElementById(<span class="string">'url'</span>).value;</span><br><span class="line">       console.log(targetUrl);</span><br><span class="line">       document.getElementById(<span class="string">"iframePosition"</span>).src = targetUrl;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">   &lt;p&gt;è¯·è¾“å…¥è¦åŠ è½½çš„åœ°å€ï¼š&lt;span id=<span class="string">"currentTime"</span>&gt;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">   &lt;p&gt;</span><br><span class="line">       &lt;input id=<span class="string">"url"</span> type=<span class="string">"text"</span> value=<span class="string">"https://www.baidu.com/"</span>/&gt;</span><br><span class="line">       &lt;input type=<span class="string">"button"</span> value=<span class="string">"æäº¤"</span> onclick=<span class="string">"LoadPage()"</span>&gt;</span><br><span class="line">   &lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">   &lt;h3&gt;åŠ è½½é¡µé¢ä½ç½®ï¼š&lt;/h3&gt;</span><br><span class="line">   &lt;iframe id=<span class="string">"iframePosition"</span> style=<span class="string">"width: 100%;height: 500px;"</span>&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>3ã€ä½¿ç”¨IDEAå¼€æµè§ˆå™¨æµ‹è¯•ä¸€ä¸‹ï¼</p><p><strong>åˆ©ç”¨AJAXå¯ä»¥åšï¼š</strong></p><ul><li>æ³¨å†Œæ—¶ï¼Œè¾“å…¥ç”¨æˆ·åè‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æ˜¯å¦å·²ç»å­˜åœ¨ã€‚</li><li>ç™»é™†æ—¶ï¼Œæç¤ºç”¨æˆ·åå¯†ç é”™è¯¯</li><li>åˆ é™¤æ•°æ®è¡Œæ—¶ï¼Œå°†è¡ŒIDå‘é€åˆ°åå°ï¼Œåå°åœ¨æ•°æ®åº“ä¸­åˆ é™¤ï¼Œæ•°æ®åº“åˆ é™¤æˆåŠŸåï¼Œåœ¨é¡µé¢DOMä¸­å°†æ•°æ®è¡Œä¹Ÿåˆ é™¤ã€‚</li><li>â€¦.ç­‰ç­‰</li></ul><h3 id="jQuery-ajax"><a href="#jQuery-ajax" class="headerlink" title="jQuery.ajax"></a>jQuery.ajax</h3><p>çº¯JSåŸç”Ÿå®ç°Ajaxæˆ‘ä»¬ä¸å»è®²è§£è¿™é‡Œï¼Œç›´æ¥ä½¿ç”¨jqueryæä¾›çš„ï¼Œæ–¹ä¾¿å­¦ä¹ å’Œä½¿ç”¨ï¼Œé¿å…é‡å¤é€ è½®å­ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å»äº†è§£ä¸‹JSåŸç”ŸXMLHttpRequest ï¼</p><p>Ajaxçš„æ ¸å¿ƒæ˜¯XMLHttpRequestå¯¹è±¡(XHR)ã€‚XHRä¸ºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚å’Œè§£ææœåŠ¡å™¨å“åº”æä¾›äº†æ¥å£ã€‚èƒ½å¤Ÿä»¥å¼‚æ­¥æ–¹å¼ä»æœåŠ¡å™¨è·å–æ–°æ•°æ®ã€‚</p><p>jQuery æä¾›å¤šä¸ªä¸ AJAX æœ‰å…³çš„æ–¹æ³•ã€‚</p><p>é€šè¿‡ jQuery AJAX æ–¹æ³•ï¼Œæ‚¨èƒ½å¤Ÿä½¿ç”¨ HTTP Get å’Œ HTTP Post ä»è¿œç¨‹æœåŠ¡å™¨ä¸Šè¯·æ±‚æ–‡æœ¬ã€HTMLã€XML æˆ– JSON â€“ åŒæ—¶æ‚¨èƒ½å¤ŸæŠŠè¿™äº›å¤–éƒ¨æ•°æ®ç›´æ¥è½½å…¥ç½‘é¡µçš„è¢«é€‰å…ƒç´ ä¸­ã€‚</p><p>jQuery ä¸æ˜¯ç”Ÿäº§è€…ï¼Œè€Œæ˜¯å¤§è‡ªç„¶æ¬è¿å·¥ã€‚</p><p>jQuery Ajaxæœ¬è´¨å°±æ˜¯ XMLHttpRequestï¼Œå¯¹ä»–è¿›è¡Œäº†å°è£…ï¼Œæ–¹ä¾¿è°ƒç”¨ï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">jQuery.ajax(...)</span><br><span class="line">      éƒ¨åˆ†å‚æ•°ï¼š</span><br><span class="line">            urlï¼šè¯·æ±‚åœ°å€</span><br><span class="line">            typeï¼šè¯·æ±‚æ–¹å¼ï¼ŒGETã€POSTï¼ˆ<span class="number">1.9</span><span class="number">.0</span>ä¹‹åç”¨methodï¼‰</span><br><span class="line">        headersï¼šè¯·æ±‚å¤´</span><br><span class="line">            dataï¼šè¦å‘é€çš„æ•°æ®</span><br><span class="line">    contentTypeï¼šå³å°†å‘é€ä¿¡æ¯è‡³æœåŠ¡å™¨çš„å†…å®¹ç¼–ç ç±»å‹(é»˜è®¤: <span class="string">"application/x-www-form-urlencoded; charset=UTF-8"</span>)</span><br><span class="line">          asyncï¼šæ˜¯å¦å¼‚æ­¥</span><br><span class="line">        timeoutï¼šè®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span><br><span class="line">      beforeSendï¼šå‘é€è¯·æ±‚å‰æ‰§è¡Œçš„å‡½æ•°(å…¨å±€)</span><br><span class="line">        completeï¼šå®Œæˆä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°(å…¨å±€)</span><br><span class="line">        successï¼šæˆåŠŸä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°(å…¨å±€)</span><br><span class="line">          errorï¼šå¤±è´¥ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°(å…¨å±€)</span><br><span class="line">        acceptsï¼šé€šè¿‡è¯·æ±‚å¤´å‘é€ç»™æœåŠ¡å™¨ï¼Œå‘Šè¯‰æœåŠ¡å™¨å½“å‰å®¢æˆ·ç«¯å¯æ¥å—çš„æ•°æ®ç±»å‹</span><br><span class="line">        dataTypeï¼šå°†æœåŠ¡å™¨ç«¯è¿”å›çš„æ•°æ®è½¬æ¢æˆæŒ‡å®šç±»å‹</span><br><span class="line">          <span class="string">"xml"</span>: å°†æœåŠ¡å™¨ç«¯è¿”å›çš„å†…å®¹è½¬æ¢æˆxmlæ ¼å¼</span><br><span class="line">          <span class="string">"text"</span>: å°†æœåŠ¡å™¨ç«¯è¿”å›çš„å†…å®¹è½¬æ¢æˆæ™®é€šæ–‡æœ¬æ ¼å¼</span><br><span class="line">          <span class="string">"html"</span>: å°†æœåŠ¡å™¨ç«¯è¿”å›çš„å†…å®¹è½¬æ¢æˆæ™®é€šæ–‡æœ¬æ ¼å¼ï¼Œåœ¨æ’å…¥DOMä¸­æ—¶ï¼Œå¦‚æœåŒ…å«JavaScriptæ ‡ç­¾ï¼Œåˆ™ä¼šå°è¯•å»æ‰§è¡Œã€‚</span><br><span class="line">        <span class="string">"script"</span>: å°è¯•å°†è¿”å›å€¼å½“ä½œJavaScriptå»æ‰§è¡Œï¼Œç„¶åå†å°†æœåŠ¡å™¨ç«¯è¿”å›çš„å†…å®¹è½¬æ¢æˆæ™®é€šæ–‡æœ¬æ ¼å¼</span><br><span class="line">          <span class="string">"json"</span>: å°†æœåŠ¡å™¨ç«¯è¿”å›çš„å†…å®¹è½¬æ¢æˆç›¸åº”çš„JavaScriptå¯¹è±¡</span><br><span class="line">        <span class="string">"jsonp"</span>: JSONP æ ¼å¼ä½¿ç”¨ JSONP å½¢å¼è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¦‚ <span class="string">"myurl?callback=?"</span> jQuery å°†è‡ªåŠ¨æ›¿æ¢ ? ä¸ºæ­£ç¡®çš„å‡½æ•°åï¼Œä»¥æ‰§è¡Œå›è°ƒå‡½æ•°</span><br></pre></td></tr></tbody></table></figure><p><strong>æˆ‘ä»¬æ¥ä¸ªç®€å•çš„æµ‹è¯•ï¼Œä½¿ç”¨æœ€åŸå§‹çš„HttpServletResponseå¤„ç† , .æœ€ç®€å• , æœ€é€šç”¨</strong></p><p>1ã€é…ç½®web.xml å’Œ springmvcçš„é…ç½®æ–‡ä»¶ï¼Œå¤åˆ¶ä¸Šé¢æ¡ˆä¾‹çš„å³å¯ ã€è®°å¾—é™æ€èµ„æºè¿‡æ»¤å’Œæ³¨è§£é©±åŠ¨é…ç½®ä¸Šã€‘</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„åŒ…ï¼Œä¸‹é¢æ‰€æœ‰æ³¨è§£ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç† --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.kuang.controller"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">id</span>=<span class="string">"internalResourceViewResolver"</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- å‰ç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- åç¼€ --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>2ã€ç¼–å†™ä¸€ä¸ªAjaxController</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AjaxController</span> {</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/a1")</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ajax1</span><span class="params">(String name , HttpServletResponse response)</span> <span class="keyword">throws</span> IOException {</span><br><span class="line">       <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name)){</span><br><span class="line">           response.getWriter().print(<span class="string">"true"</span>);</span><br><span class="line">      }<span class="keyword">else</span>{</span><br><span class="line">           response.getWriter().print(<span class="string">"false"</span>);</span><br><span class="line">      }</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>3ã€å¯¼å…¥jquery ï¼Œ å¯ä»¥ä½¿ç”¨åœ¨çº¿çš„CDN ï¼Œ ä¹Ÿå¯ä»¥ä¸‹è½½å¯¼å…¥</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">&lt;script src="https://code.jquery.com/jquery-3.1.1.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="${pageContext.request.contextPath}/statics/js/jquery-3.1.1.min.js"&gt;&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure><p>4ã€ç¼–å†™index.jspæµ‹è¯•</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"> &lt;head&gt;</span><br><span class="line">   &lt;title&gt;$Title$&lt;/title&gt;</span><br><span class="line">  &lt;%--&lt;script src=<span class="string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;&lt;/script&gt;--%&gt;</span><br><span class="line">   &lt;script src=<span class="string">"${pageContext.request.contextPath}/statics/js/jquery-3.1.1.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line">       function <span class="title function_">a1</span><span class="params">()</span>{</span><br><span class="line">           $.post({</span><br><span class="line">               url:<span class="string">"${pageContext.request.contextPath}/a1"</span>,</span><br><span class="line">               data:{<span class="string">'name'</span>:$(<span class="string">"#txtName"</span>).val()},</span><br><span class="line">               success:function (data,status) {</span><br><span class="line">                   alert(data);</span><br><span class="line">                   alert(status);</span><br><span class="line">              }</span><br><span class="line">          });</span><br><span class="line">      }</span><br><span class="line">   &lt;/script&gt;</span><br><span class="line"> &lt;/head&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;%--onblurï¼šå¤±å»ç„¦ç‚¹è§¦å‘äº‹ä»¶--%&gt;</span><br><span class="line">ç”¨æˆ·å:&lt;input type=<span class="string">"text"</span> id=<span class="string">"txtName"</span> onblur=<span class="string">"a1()"</span>/&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>5ã€å¯åŠ¨tomcatæµ‹è¯•ï¼æ‰“å¼€æµè§ˆå™¨çš„æ§åˆ¶å°ï¼Œå½“æˆ‘ä»¬é¼ æ ‡ç¦»å¼€è¾“å…¥æ¡†çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°å‘å‡ºäº†ä¸€ä¸ªajaxçš„è¯·æ±‚ï¼æ˜¯åå°è¿”å›ç»™æˆ‘ä»¬çš„ç»“æœï¼æµ‹è¯•æˆåŠŸï¼</p><p><strong>Springmvcå®ç°</strong></p><p>å®ä½“ç±»user</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line">   <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">   <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æˆ‘ä»¬æ¥è·å–ä¸€ä¸ªé›†åˆå¯¹è±¡ï¼Œå±•ç¤ºåˆ°å‰ç«¯é¡µé¢</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/a2")</span></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">ajax2</span><span class="params">()</span>{</span><br><span class="line">   List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;User&gt;();</span><br><span class="line">   list.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†1å·"</span>,<span class="number">3</span>,<span class="string">"ç”·"</span>));</span><br><span class="line">   list.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†2å·"</span>,<span class="number">3</span>,<span class="string">"ç”·"</span>));</span><br><span class="line">   list.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">"ç§¦ç–†3å·"</span>,<span class="number">3</span>,<span class="string">"ç”·"</span>));</span><br><span class="line">   <span class="keyword">return</span> list; <span class="comment">//ç”±äº@RestControlleræ³¨è§£ï¼Œå°†listè½¬æˆjsonæ ¼å¼è¿”å›</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å‰ç«¯é¡µé¢</p><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"btn"</span> <span class="attr">value</span>=<span class="string">"è·å–æ•°æ®"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">"80%"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>å§“å<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>å¹´é¾„<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ€§åˆ«<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"${pageContext.request.contextPath}/statics/js/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   $(<span class="keyword">function</span> (<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">       $(<span class="string">"#btn"</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">           $.<span class="title function_">post</span>(<span class="string">"${pageContext.request.contextPath}/a2"</span>,<span class="keyword">function</span> (<span class="params">data</span>) {</span></span><br><span class="line"><span class="language-javascript">               <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">var</span> html=<span class="string">""</span>;</span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;data.<span class="property">length</span> ; i++) {</span></span><br><span class="line"><span class="language-javascript">                   html+= <span class="string">"&lt;tr&gt;"</span> +</span></span><br><span class="line"><span class="language-javascript">                       <span class="string">"&lt;td&gt;"</span> + data[i].<span class="property">name</span> + <span class="string">"&lt;/td&gt;"</span> +</span></span><br><span class="line"><span class="language-javascript">                       <span class="string">"&lt;td&gt;"</span> + data[i].<span class="property">age</span> + <span class="string">"&lt;/td&gt;"</span> +</span></span><br><span class="line"><span class="language-javascript">                       <span class="string">"&lt;td&gt;"</span> + data[i].<span class="property">sex</span> + <span class="string">"&lt;/td&gt;"</span> +</span></span><br><span class="line"><span class="language-javascript">                       <span class="string">"&lt;/tr&gt;"</span></span></span><br><span class="line"><span class="language-javascript">              }</span></span><br><span class="line"><span class="language-javascript">               $(<span class="string">"#content"</span>).<span class="title function_">html</span>(html);</span></span><br><span class="line"><span class="language-javascript">          });</span></span><br><span class="line"><span class="language-javascript">      })</span></span><br><span class="line"><span class="language-javascript">  })</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p><strong>æˆåŠŸå®ç°äº†æ•°æ®å›æ˜¾ï¼å¯ä»¥ä½“ä¼šä¸€ä¸‹Ajaxçš„å¥½å¤„ï¼</strong></p><blockquote><p>æ³¨å†Œæç¤ºæ•ˆæœ</p></blockquote><p>æˆ‘ä»¬å†æµ‹è¯•ä¸€ä¸ªå°Demoï¼Œæ€è€ƒä¸€ä¸‹æˆ‘ä»¬å¹³æ—¶æ³¨å†Œæ—¶å€™ï¼Œè¾“å…¥æ¡†åé¢çš„å®æ—¶æç¤ºæ€ä¹ˆåšåˆ°çš„ï¼›å¦‚ä½•ä¼˜åŒ–</p><p>æˆ‘ä»¬å†™ä¸€ä¸ªController</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/a3")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">ajax3</span><span class="params">(String name,String pwd)</span>{</span><br><span class="line">   <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="string">""</span>;</span><br><span class="line">   <span class="comment">//æ¨¡æ‹Ÿæ•°æ®åº“ä¸­å­˜åœ¨æ•°æ®</span></span><br><span class="line">   <span class="keyword">if</span> (name!=<span class="literal">null</span>){</span><br><span class="line">       <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name)){</span><br><span class="line">           msg = <span class="string">"OK"</span>;</span><br><span class="line">      }<span class="keyword">else</span> {</span><br><span class="line">           msg = <span class="string">"ç”¨æˆ·åè¾“å…¥é”™è¯¯"</span>;</span><br><span class="line">      }</span><br><span class="line">  }</span><br><span class="line">   <span class="keyword">if</span> (pwd!=<span class="literal">null</span>){</span><br><span class="line">       <span class="keyword">if</span> (<span class="string">"123456"</span>.equals(pwd)){</span><br><span class="line">           msg = <span class="string">"OK"</span>;</span><br><span class="line">      }<span class="keyword">else</span> {</span><br><span class="line">           msg = <span class="string">"å¯†ç è¾“å…¥æœ‰è¯¯"</span>;</span><br><span class="line">      }</span><br><span class="line">  }</span><br><span class="line">   <span class="keyword">return</span> msg; <span class="comment">//ç”±äº@RestControlleræ³¨è§£ï¼Œå°†msgè½¬æˆjsonæ ¼å¼è¿”å›</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å‰ç«¯é¡µé¢ login.jsp</p><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>ajax<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"${pageContext.request.contextPath}/statics/js/jquery-3.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">       <span class="keyword">function</span> <span class="title function_">a1</span>(<span class="params"></span>){</span></span><br><span class="line"><span class="language-javascript">           $.<span class="title function_">post</span>({</span></span><br><span class="line"><span class="language-javascript">               <span class="attr">url</span>:<span class="string">"${pageContext.request.contextPath}/a3"</span>,</span></span><br><span class="line"><span class="language-javascript">               <span class="attr">data</span>:{<span class="string">'name'</span>:$(<span class="string">"#name"</span>).<span class="title function_">val</span>()},</span></span><br><span class="line"><span class="language-javascript">               <span class="attr">success</span>:<span class="keyword">function</span> (<span class="params">data</span>) {</span></span><br><span class="line"><span class="language-javascript">                   <span class="keyword">if</span> (data.<span class="title function_">toString</span>()==<span class="string">'OK'</span>){</span></span><br><span class="line"><span class="language-javascript">                       $(<span class="string">"#userInfo"</span>).<span class="title function_">css</span>(<span class="string">"color"</span>,<span class="string">"green"</span>);</span></span><br><span class="line"><span class="language-javascript">                  }<span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">                       $(<span class="string">"#userInfo"</span>).<span class="title function_">css</span>(<span class="string">"color"</span>,<span class="string">"red"</span>);</span></span><br><span class="line"><span class="language-javascript">                  }</span></span><br><span class="line"><span class="language-javascript">                   $(<span class="string">"#userInfo"</span>).<span class="title function_">html</span>(data);</span></span><br><span class="line"><span class="language-javascript">              }</span></span><br><span class="line"><span class="language-javascript">          });</span></span><br><span class="line"><span class="language-javascript">      }</span></span><br><span class="line"><span class="language-javascript">       <span class="keyword">function</span> <span class="title function_">a2</span>(<span class="params"></span>){</span></span><br><span class="line"><span class="language-javascript">           $.<span class="title function_">post</span>({</span></span><br><span class="line"><span class="language-javascript">               <span class="attr">url</span>:<span class="string">"${pageContext.request.contextPath}/a3"</span>,</span></span><br><span class="line"><span class="language-javascript">               <span class="attr">data</span>:{<span class="string">'pwd'</span>:$(<span class="string">"#pwd"</span>).<span class="title function_">val</span>()},</span></span><br><span class="line"><span class="language-javascript">               <span class="attr">success</span>:<span class="keyword">function</span> (<span class="params">data</span>) {</span></span><br><span class="line"><span class="language-javascript">                   <span class="keyword">if</span> (data.<span class="title function_">toString</span>()==<span class="string">'OK'</span>){</span></span><br><span class="line"><span class="language-javascript">                       $(<span class="string">"#pwdInfo"</span>).<span class="title function_">css</span>(<span class="string">"color"</span>,<span class="string">"green"</span>);</span></span><br><span class="line"><span class="language-javascript">                  }<span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">                       $(<span class="string">"#pwdInfo"</span>).<span class="title function_">css</span>(<span class="string">"color"</span>,<span class="string">"red"</span>);</span></span><br><span class="line"><span class="language-javascript">                  }</span></span><br><span class="line"><span class="language-javascript">                   $(<span class="string">"#pwdInfo"</span>).<span class="title function_">html</span>(data);</span></span><br><span class="line"><span class="language-javascript">              }</span></span><br><span class="line"><span class="language-javascript">          });</span></span><br><span class="line"><span class="language-javascript">      }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  ç”¨æˆ·å:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">onblur</span>=<span class="string">"a1()"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"userInfo"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  å¯†ç :<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"pwd"</span> <span class="attr">onblur</span>=<span class="string">"a2()"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"pwdInfo"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>ã€è®°å¾—å¤„ç†jsonä¹±ç é—®é¢˜ã€‘</p><p>æµ‹è¯•ä¸€ä¸‹æ•ˆæœï¼ŒåŠ¨æ€è¯·æ±‚å“åº”ï¼Œå±€éƒ¨åˆ·æ–°ï¼Œå°±æ˜¯å¦‚æ­¤ï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7KZibKx8mbpgp9uicB6eJRNyNtU7ek8sJ1kpbFia5e5IoMRtGFwBiaylw7iakYBws0icEAqyH22l6Y7FMzQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><blockquote><p>è·å–baiduæ¥å£Demo</p></blockquote><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span>&gt;</span><br><span class="line">   &lt;title&gt;JSONPç™¾åº¦æœç´¢&lt;/title&gt;</span><br><span class="line">   &lt;style&gt;</span><br><span class="line">       #q{</span><br><span class="line">           width: 500px;</span><br><span class="line">           height: 30px;</span><br><span class="line">           border:1px solid #ddd;</span><br><span class="line">           line-height: 30px;</span><br><span class="line">           display: block;</span><br><span class="line">           margin: <span class="number">0</span> auto;</span><br><span class="line">           padding: <span class="number">0</span> 10px;</span><br><span class="line">           font-size: 14px;</span><br><span class="line">      }</span><br><span class="line">       #ul{</span><br><span class="line">           width: 520px;</span><br><span class="line">           list-style: none;</span><br><span class="line">           margin: <span class="number">0</span> auto;</span><br><span class="line">           padding: <span class="number">0</span>;</span><br><span class="line">           border:1px solid #ddd;</span><br><span class="line">           margin-top: -1px;</span><br><span class="line">           display: none;</span><br><span class="line">      }</span><br><span class="line">       #ul li{</span><br><span class="line">           line-height: 30px;</span><br><span class="line">           padding: <span class="number">0</span> 10px;</span><br><span class="line">      }</span><br><span class="line">       #ul li:hover{</span><br><span class="line">           background-color: #f60;</span><br><span class="line">           color: #fff;</span><br><span class="line">      }</span><br><span class="line">   &lt;/style&gt;</span><br><span class="line">   &lt;script&gt;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 2.æ­¥éª¤äºŒ</span></span><br><span class="line">       <span class="comment">// å®šä¹‰demoå‡½æ•° (åˆ†ææ¥å£ã€æ•°æ®)</span></span><br><span class="line">       function <span class="title function_">demo</span><span class="params">(data)</span>{</span><br><span class="line">           <span class="type">var</span> <span class="variable">Ul</span> <span class="operator">=</span> document.getElementById(<span class="string">'ul'</span>);</span><br><span class="line">           <span class="type">var</span> <span class="variable">html</span> <span class="operator">=</span> <span class="string">''</span>;</span><br><span class="line">           <span class="comment">// å¦‚æœæœç´¢æ•°æ®å­˜åœ¨ æŠŠå†…å®¹æ·»åŠ è¿›å»</span></span><br><span class="line">           <span class="keyword">if</span> (data.s.length) {</span><br><span class="line">               <span class="comment">// éšè—æ‰çš„ulæ˜¾ç¤ºå‡ºæ¥</span></span><br><span class="line">               Ul.style.display = <span class="string">'block'</span>;</span><br><span class="line">               <span class="comment">// æœç´¢åˆ°çš„æ•°æ®å¾ªç¯è¿½åŠ åˆ°lié‡Œ</span></span><br><span class="line">               <span class="keyword">for</span>(<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;data.s.length;i++){</span><br><span class="line">                   html += <span class="string">'&lt;li&gt;'</span>+data.s[i]+<span class="string">'&lt;/li&gt;'</span>;</span><br><span class="line">              }</span><br><span class="line">               <span class="comment">// å¾ªç¯çš„liå†™å…¥ul</span></span><br><span class="line">               Ul.innerHTML = html;</span><br><span class="line">          }</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 1.æ­¥éª¤ä¸€</span></span><br><span class="line">       window.onload = function(){</span><br><span class="line">           <span class="comment">// è·å–è¾“å…¥æ¡†å’Œul</span></span><br><span class="line">           <span class="type">var</span> <span class="variable">Q</span> <span class="operator">=</span> document.getElementById(<span class="string">'q'</span>);</span><br><span class="line">           <span class="type">var</span> <span class="variable">Ul</span> <span class="operator">=</span> document.getElementById(<span class="string">'ul'</span>);</span><br><span class="line"></span><br><span class="line">           <span class="comment">// äº‹ä»¶é¼ æ ‡æŠ¬èµ·æ—¶å€™</span></span><br><span class="line">           Q.onkeyup = function(){</span><br><span class="line">               <span class="comment">// å¦‚æœè¾“å…¥æ¡†ä¸ç­‰äºç©º</span></span><br><span class="line">               <span class="keyword">if</span> (<span class="built_in">this</span>.value != <span class="string">''</span>) {</span><br><span class="line">                   <span class="comment">// â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†JSONPzé‡ç‚¹â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†</span></span><br><span class="line">                   <span class="comment">// åˆ›å»ºæ ‡ç­¾</span></span><br><span class="line">                   <span class="type">var</span> <span class="variable">script</span> <span class="operator">=</span> document.createElement(<span class="string">'script'</span>);</span><br><span class="line">                   <span class="comment">//ç»™å®šè¦è·¨åŸŸçš„åœ°å€ èµ‹å€¼ç»™src</span></span><br><span class="line">                   <span class="comment">//è¿™é‡Œæ˜¯è¦è¯·æ±‚çš„è·¨åŸŸçš„åœ°å€ æˆ‘å†™çš„æ˜¯ç™¾åº¦æœç´¢çš„è·¨åŸŸåœ°å€</span></span><br><span class="line">                   script.src = <span class="string">'https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd='</span>+<span class="built_in">this</span>.value+<span class="string">'&amp;cb=demo'</span>;</span><br><span class="line">                   <span class="comment">// å°†ç»„åˆå¥½çš„å¸¦srcçš„scriptæ ‡ç­¾è¿½åŠ åˆ°bodyé‡Œ</span></span><br><span class="line">                   document.body.appendChild(script);</span><br><span class="line">              }</span><br><span class="line">          }</span><br><span class="line">      }</span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;input type=<span class="string">"text"</span> id=<span class="string">"q"</span> /&gt;</span><br><span class="line">&lt;ul id=<span class="string">"ul"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><h2 id="ä¸ƒã€æ‹¦æˆªå™¨"><a href="#ä¸ƒã€æ‹¦æˆªå™¨" class="headerlink" title="ä¸ƒã€æ‹¦æˆªå™¨"></a>ä¸ƒã€æ‹¦æˆªå™¨</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>SpringMVCçš„å¤„ç†å™¨æ‹¦æˆªå™¨ç±»ä¼¼äºServletå¼€å‘ä¸­çš„è¿‡æ»¤å™¨Filter,ç”¨äºå¯¹å¤„ç†å™¨è¿›è¡Œé¢„å¤„ç†å’Œåå¤„ç†ã€‚å¼€å‘è€…å¯ä»¥è‡ªå·±å®šä¹‰ä¸€äº›æ‹¦æˆªå™¨æ¥å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚</p><p><strong>è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„åŒºåˆ«ï¼š</strong>æ‹¦æˆªå™¨æ˜¯AOPæ€æƒ³çš„å…·ä½“åº”ç”¨ã€‚</p><p><strong>è¿‡æ»¤å™¨</strong></p><ul><li>servletè§„èŒƒä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä»»ä½•java webå·¥ç¨‹éƒ½å¯ä»¥ä½¿ç”¨</li><li>åœ¨url-patternä¸­é…ç½®äº†/*ä¹‹åï¼Œå¯ä»¥å¯¹æ‰€æœ‰è¦è®¿é—®çš„èµ„æºè¿›è¡Œæ‹¦æˆª</li></ul><p><strong>æ‹¦æˆªå™¨</strong> </p><ul><li>æ‹¦æˆªå™¨æ˜¯SpringMVCæ¡†æ¶è‡ªå·±çš„ï¼Œåªæœ‰ä½¿ç”¨äº†SpringMVCæ¡†æ¶çš„å·¥ç¨‹æ‰èƒ½ä½¿ç”¨</li><li>æ‹¦æˆªå™¨åªä¼šæ‹¦æˆªè®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œ å¦‚æœè®¿é—®çš„æ˜¯jsp/html/css/image/jsæ˜¯ä¸ä¼šè¿›è¡Œæ‹¦æˆªçš„</li></ul><h3 id="è‡ªå®šä¹‰æ‹¦æˆªå™¨"><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="è‡ªå®šä¹‰æ‹¦æˆªå™¨"></a>è‡ªå®šä¹‰æ‹¦æˆªå™¨</h3><p>é‚£å¦‚ä½•å®ç°æ‹¦æˆªå™¨å‘¢ï¼Ÿ</p><p>æƒ³è¦è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œå¿…é¡»å®ç° HandlerInterceptor æ¥å£ã€‚</p><p>1ã€æ–°å»ºä¸€ä¸ªMoudule ï¼Œ springmvc-07-Interceptor  ï¼Œ æ·»åŠ webæ”¯æŒ</p><p>2ã€é…ç½®web.xml å’Œ springmvc-servlet.xml æ–‡ä»¶</p><p>3ã€ç¼–å†™ä¸€ä¸ªæ‹¦æˆªå™¨</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//åœ¨è¯·æ±‚å¤„ç†çš„æ–¹æ³•ä¹‹å‰æ‰§è¡Œ</span></span><br><span class="line">   <span class="comment">//å¦‚æœè¿”å›trueæ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨</span></span><br><span class="line">   <span class="comment">//å¦‚æœè¿”å›falseå°±ä¸æ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨</span></span><br><span class="line">   <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       System.out.println(<span class="string">"------------å¤„ç†å‰------------"</span>);</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">//åœ¨è¯·æ±‚å¤„ç†æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œ</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       System.out.println(<span class="string">"------------å¤„ç†å------------"</span>);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">//åœ¨dispatcherServletå¤„ç†åæ‰§è¡Œ,åšæ¸…ç†å·¥ä½œ.</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       System.out.println(<span class="string">"------------æ¸…ç†------------"</span>);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>4ã€åœ¨springmvcçš„é…ç½®æ–‡ä»¶ä¸­é…ç½®æ‹¦æˆªå™¨</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å…³äºæ‹¦æˆªå™¨çš„é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--/** åŒ…æ‹¬è·¯å¾„åŠå…¶å­è·¯å¾„--&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--/admin/* æ‹¦æˆªçš„æ˜¯/admin/addç­‰ç­‰è¿™ç§ , /admin/add/userä¸ä¼šè¢«æ‹¦æˆª--&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--/admin/** æ‹¦æˆªçš„æ˜¯/admin/ä¸‹çš„æ‰€æœ‰--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--beané…ç½®çš„å°±æ˜¯æ‹¦æˆªå™¨--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.kuang.interceptor.MyInterceptor"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>5ã€ç¼–å†™ä¸€ä¸ªControllerï¼Œæ¥æ”¶è¯·æ±‚</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•æ‹¦æˆªå™¨çš„æ§åˆ¶å™¨</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InterceptorController</span> {</span><br><span class="line"></span><br><span class="line">   <span class="meta">@RequestMapping("/interceptor")</span></span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">testFunction</span><span class="params">()</span> {</span><br><span class="line">       System.out.println(<span class="string">"æ§åˆ¶å™¨ä¸­çš„æ–¹æ³•æ‰§è¡Œäº†"</span>);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>6ã€å‰ç«¯ index.jsp</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">&lt;a href="${pageContext.request.contextPath}/interceptor"&gt;æ‹¦æˆªå™¨æµ‹è¯•&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure><p>7ã€å¯åŠ¨tomcat æµ‹è¯•ä¸€ä¸‹ï¼</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7KshicHhIPa51icXVueiaMfB0HtJH2NsHDlcibyEJuibgomZzDNpHiammcSRt2V87uPMYGC7h0gt5KS2Dcw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><h3 id="éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•-è®¤è¯ç”¨æˆ·"><a href="#éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•-è®¤è¯ç”¨æˆ·" class="headerlink" title="éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½• (è®¤è¯ç”¨æˆ·)"></a>éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½• (è®¤è¯ç”¨æˆ·)</h3><p><strong>å®ç°æ€è·¯</strong></p><p>1ã€æœ‰ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œéœ€è¦å†™ä¸€ä¸ªcontrollerè®¿é—®é¡µé¢ã€‚</p><p>2ã€ç™»é™†é¡µé¢æœ‰ä¸€æäº¤è¡¨å•çš„åŠ¨ä½œã€‚éœ€è¦åœ¨controllerä¸­å¤„ç†ã€‚åˆ¤æ–­ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœæ­£ç¡®ï¼Œå‘sessionä¸­å†™å…¥ç”¨æˆ·ä¿¡æ¯ã€‚<em>è¿”å›ç™»é™†æˆåŠŸã€‚</em></p><p>3ã€æ‹¦æˆªç”¨æˆ·è¯·æ±‚ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†ã€‚å¦‚æœç”¨æˆ·å·²ç»ç™»é™†ã€‚æ”¾è¡Œï¼Œ å¦‚æœç”¨æˆ·æœªç™»é™†ï¼Œè·³è½¬åˆ°ç™»é™†é¡µé¢</p><p><strong>æµ‹è¯•ï¼š</strong></p><p>1ã€ç¼–å†™ä¸€ä¸ªç™»é™†é¡µé¢  login.jsp</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;ç™»å½•é¡µé¢&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"${pageContext.request.contextPath}/user/login"</span>&gt;</span><br><span class="line">  ç”¨æˆ·åï¼š&lt;input type=<span class="string">"text"</span> name=<span class="string">"username"</span>&gt; &lt;br&gt;</span><br><span class="line">  å¯†ç ï¼š&lt;input type=<span class="string">"password"</span> name=<span class="string">"pwd"</span>&gt; &lt;br&gt;</span><br><span class="line">   &lt;input type=<span class="string">"submit"</span> value=<span class="string">"æäº¤"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>2ã€ç¼–å†™ä¸€ä¸ªControllerå¤„ç†è¯·æ±‚</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping("/user")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//è·³è½¬åˆ°ç™»é™†é¡µé¢</span></span><br><span class="line">   <span class="meta">@RequestMapping("/jumplogin")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">jumpLogin</span><span class="params">()</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"login"</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">//è·³è½¬åˆ°æˆåŠŸé¡µé¢</span></span><br><span class="line">   <span class="meta">@RequestMapping("/jumpSuccess")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">jumpSuccess</span><span class="params">()</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ç™»é™†æäº¤</span></span><br><span class="line">   <span class="meta">@RequestMapping("/login")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">login</span><span class="params">(HttpSession session, String username, String pwd)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="comment">// å‘sessionè®°å½•ç”¨æˆ·èº«ä»½ä¿¡æ¯</span></span><br><span class="line">       System.out.println(<span class="string">"æ¥æ”¶å‰ç«¯==="</span>+username);</span><br><span class="line">       session.setAttribute(<span class="string">"user"</span>, username);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="comment">//é€€å‡ºç™»é™†</span></span><br><span class="line">   <span class="meta">@RequestMapping("logout")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">logout</span><span class="params">(HttpSession session)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">       <span class="comment">// session è¿‡æœŸ</span></span><br><span class="line">       session.invalidate();</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"login"</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>3ã€ç¼–å†™ä¸€ä¸ªç™»é™†æˆåŠŸçš„é¡µé¢ success.jsp</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;ç™»å½•æˆåŠŸé¡µé¢&lt;/h1&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line"></span><br><span class="line">${user}</span><br><span class="line">&lt;a href=<span class="string">"${pageContext.request.contextPath}/user/logout"</span>&gt;æ³¨é”€&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>4ã€åœ¨ index é¡µé¢ä¸Šæµ‹è¯•è·³è½¬ï¼å¯åŠ¨Tomcat æµ‹è¯•ï¼Œæœªç™»å½•ä¹Ÿå¯ä»¥è¿›å…¥ä¸»é¡µï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"> &lt;head&gt;</span><br><span class="line">   &lt;title&gt;$Title$&lt;/title&gt;</span><br><span class="line"> &lt;/head&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line"> &lt;h1&gt;é¦–é¡µ&lt;/h1&gt;</span><br><span class="line"> &lt;hr&gt;</span><br><span class="line">&lt;%--ç™»å½•--%&gt;</span><br><span class="line"> &lt;a href=<span class="string">"${pageContext.request.contextPath}/user/jumplogin"</span>&gt;ç™»å½•&lt;/a&gt;</span><br><span class="line"> &lt;a href=<span class="string">"${pageContext.request.contextPath}/user/jumpSuccess"</span>&gt;æˆåŠŸé¡µé¢&lt;/a&gt;</span><br><span class="line"> &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>5ã€ç¼–å†™ç”¨æˆ·ç™»å½•æ‹¦æˆªå™¨</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> {</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> ServletException, IOException {</span><br><span class="line">       <span class="comment">// å¦‚æœæ˜¯ç™»é™†é¡µé¢åˆ™æ”¾è¡Œ</span></span><br><span class="line">       System.out.println(<span class="string">"uri: "</span> + request.getRequestURI());</span><br><span class="line">       <span class="keyword">if</span> (request.getRequestURI().contains(<span class="string">"login"</span>)) {</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">       <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line"></span><br><span class="line">       <span class="comment">// å¦‚æœç”¨æˆ·å·²ç™»é™†ä¹Ÿæ”¾è¡Œ</span></span><br><span class="line">       <span class="keyword">if</span>(session.getAttribute(<span class="string">"user"</span>) != <span class="literal">null</span>) {</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">       <span class="comment">// ç”¨æˆ·æ²¡æœ‰ç™»é™†è·³è½¬åˆ°ç™»é™†é¡µé¢</span></span><br><span class="line">       request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/login.jsp"</span>).forward(request, response);</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line"></span><br><span class="line">  }</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line"></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>6ã€åœ¨Springmvcçš„é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œæ‹¦æˆªå™¨</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å…³äºæ‹¦æˆªå™¨çš„é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"loginInterceptor"</span> <span class="attr">class</span>=<span class="string">"com.kuang.interceptor.LoginInterceptor"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>7ã€å†æ¬¡é‡å¯Tomcatæµ‹è¯•ï¼</p><p><strong>OKï¼Œæµ‹è¯•ç™»å½•æ‹¦æˆªåŠŸèƒ½æ— è¯¯.</strong></p><h2 id="å…«ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½"><a href="#å…«ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½" class="headerlink" title="å…«ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½"></a>å…«ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½</h2><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>æ–‡ä»¶ä¸Šä¼ æ˜¯é¡¹ç›®å¼€å‘ä¸­æœ€å¸¸è§çš„åŠŸèƒ½ä¹‹ä¸€ ,springMVC å¯ä»¥å¾ˆå¥½çš„æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯SpringMVCä¸Šä¸‹æ–‡ä¸­é»˜è®¤æ²¡æœ‰è£…é…MultipartResolverï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹å…¶ä¸èƒ½å¤„ç†æ–‡ä»¶ä¸Šä¼ å·¥ä½œã€‚å¦‚æœæƒ³ä½¿ç”¨Springçš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­é…ç½®MultipartResolverã€‚</p><p>å‰ç«¯è¡¨å•è¦æ±‚ï¼šä¸ºäº†èƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œå¿…é¡»å°†è¡¨å•çš„methodè®¾ç½®ä¸ºPOSTï¼Œå¹¶å°†enctypeè®¾ç½®ä¸ºmultipart/form-dataã€‚åªæœ‰åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ‰ä¼šæŠŠç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶ä»¥äºŒè¿›åˆ¶æ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼›</p><p><strong>å¯¹è¡¨å•ä¸­çš„ enctype å±æ€§åšä¸ªè¯¦ç»†çš„è¯´æ˜ï¼š</strong></p><ul><li>application/x-www=form-urlencodedï¼šé»˜è®¤æ–¹å¼ï¼Œåªå¤„ç†è¡¨å•åŸŸä¸­çš„ value å±æ€§å€¼ï¼Œé‡‡ç”¨è¿™ç§ç¼–ç æ–¹å¼çš„è¡¨å•ä¼šå°†è¡¨å•åŸŸä¸­çš„å€¼å¤„ç†æˆ URL ç¼–ç æ–¹å¼ã€‚</li><li>multipart/form-dataï¼šè¿™ç§ç¼–ç æ–¹å¼ä¼šä»¥äºŒè¿›åˆ¶æµçš„æ–¹å¼æ¥å¤„ç†è¡¨å•æ•°æ®ï¼Œè¿™ç§ç¼–ç æ–¹å¼ä¼šæŠŠæ–‡ä»¶åŸŸæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ä¹Ÿå°è£…åˆ°è¯·æ±‚å‚æ•°ä¸­ï¼Œä¸ä¼šå¯¹å­—ç¬¦ç¼–ç ã€‚</li><li>text/plainï¼šé™¤äº†æŠŠç©ºæ ¼è½¬æ¢ä¸º â€œ+â€ å·å¤–ï¼Œå…¶ä»–å­—ç¬¦éƒ½ä¸åšç¼–ç å¤„ç†ï¼Œè¿™ç§æ–¹å¼é€‚ç”¨ç›´æ¥é€šè¿‡è¡¨å•å‘é€é‚®ä»¶ã€‚</li></ul><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">""</span> enctype=<span class="string">"multipart/form-data"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">   &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span>/&gt;</span><br><span class="line">   &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></tbody></table></figure><p>ä¸€æ—¦è®¾ç½®äº†enctypeä¸ºmultipart/form-dataï¼Œæµè§ˆå™¨å³ä¼šé‡‡ç”¨äºŒè¿›åˆ¶æµçš„æ–¹å¼æ¥å¤„ç†è¡¨å•æ•°æ®ï¼Œè€Œå¯¹äºæ–‡ä»¶ä¸Šä¼ çš„å¤„ç†åˆ™æ¶‰åŠåœ¨æœåŠ¡å™¨ç«¯è§£æåŸå§‹çš„HTTPå“åº”ã€‚åœ¨2003å¹´ï¼ŒApache Software Foundationå‘å¸ƒäº†å¼€æºçš„Commons FileUploadç»„ä»¶ï¼Œå…¶å¾ˆå¿«æˆä¸ºServlet/JSPç¨‹åºå‘˜ä¸Šä¼ æ–‡ä»¶çš„æœ€ä½³é€‰æ‹©ã€‚</p><ul><li>Servlet3.0è§„èŒƒå·²ç»æä¾›æ–¹æ³•æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼Œä½†è¿™ç§ä¸Šä¼ éœ€è¦åœ¨Servletä¸­å®Œæˆã€‚</li><li>è€ŒSpring MVCåˆ™æä¾›äº†æ›´ç®€å•çš„å°è£…ã€‚</li><li>Spring MVCä¸ºæ–‡ä»¶ä¸Šä¼ æä¾›äº†ç›´æ¥çš„æ”¯æŒï¼Œè¿™ç§æ”¯æŒæ˜¯ç”¨å³æ’å³ç”¨çš„MultipartResolverå®ç°çš„ã€‚</li><li>Spring MVCä½¿ç”¨Apache Commons FileUploadæŠ€æœ¯å®ç°äº†ä¸€ä¸ªMultipartResolverå®ç°ç±»ï¼š</li><li>CommonsMultipartResolverã€‚å› æ­¤ï¼ŒSpringMVCçš„æ–‡ä»¶ä¸Šä¼ è¿˜éœ€è¦ä¾èµ–Apache Commons FileUploadçš„ç»„ä»¶ã€‚</li></ul><h3 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h3><p>1ã€å¯¼å…¥æ–‡ä»¶ä¸Šä¼ çš„jaråŒ…ï¼Œcommons-fileupload ï¼Œ Mavenä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å¯¼å…¥ä»–çš„ä¾èµ–åŒ… commons-ioåŒ…ï¼›</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–‡ä»¶ä¸Šä¼ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--servlet-apiå¯¼å…¥é«˜ç‰ˆæœ¬çš„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>2ã€é…ç½®beanï¼šmultipartResolver</p><p>ã€<strong>æ³¨æ„ï¼ï¼ï¼è¿™ä¸ªbenaçš„idå¿…é¡»ä¸ºï¼šmultipartResolver ï¼Œ å¦åˆ™ä¸Šä¼ æ–‡ä»¶ä¼šæŠ¥400çš„é”™è¯¯ï¼åœ¨è¿™é‡Œæ ½è¿‡å‘,æ•™è®­ï¼</strong>ã€‘</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–‡ä»¶ä¸Šä¼ é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span>  <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- è¯·æ±‚çš„ç¼–ç æ ¼å¼ï¼Œå¿…é¡»å’ŒjSPçš„pageEncodingå±æ€§ä¸€è‡´ï¼Œä»¥ä¾¿æ­£ç¡®è¯»å–è¡¨å•çš„å†…å®¹ï¼Œé»˜è®¤ä¸ºISO-8859-1 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> <span class="attr">value</span>=<span class="string">"utf-8"</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼ˆ10485760=10Mï¼‰ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"10485760"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxInMemorySize"</span> <span class="attr">value</span>=<span class="string">"40960"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>CommonsMultipartFile çš„ å¸¸ç”¨æ–¹æ³•ï¼š</p><ul><li><strong>String getOriginalFilename()ï¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„åŸå</strong></li><li><strong>InputStream getInputStream()ï¼šè·å–æ–‡ä»¶æµ</strong></li><li><strong>void transferTo(File dest)ï¼šå°†ä¸Šä¼ æ–‡ä»¶ä¿å­˜åˆ°ä¸€ä¸ªç›®å½•æ–‡ä»¶ä¸­</strong></li></ul><p> æˆ‘ä»¬å»å®é™…æµ‹è¯•ä¸€ä¸‹</p><p>3ã€ç¼–å†™å‰ç«¯é¡µé¢</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">"/upload"</span> enctype=<span class="string">"multipart/form-data"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line"> &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span>/&gt;</span><br><span class="line"> &lt;input type=<span class="string">"submit"</span> value=<span class="string">"upload"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></tbody></table></figure><p>4ã€<strong>Controller</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.commons.CommonsMultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileController</span> {</span><br><span class="line">   <span class="comment">//@RequestParam("file") å°†name=fileæ§ä»¶å¾—åˆ°çš„æ–‡ä»¶å°è£…æˆCommonsMultipartFile å¯¹è±¡</span></span><br><span class="line">   <span class="comment">//æ‰¹é‡ä¸Šä¼ CommonsMultipartFileåˆ™ä¸ºæ•°ç»„å³å¯</span></span><br><span class="line">   <span class="meta">@RequestMapping("/upload")</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">fileUpload</span><span class="params">(<span class="meta">@RequestParam("file")</span> CommonsMultipartFile file , HttpServletRequest request)</span> <span class="keyword">throws</span> IOException {</span><br><span class="line"></span><br><span class="line">       <span class="comment">//è·å–æ–‡ä»¶å : file.getOriginalFilename();</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">uploadFileName</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//å¦‚æœæ–‡ä»¶åä¸ºç©ºï¼Œç›´æ¥å›åˆ°é¦–é¡µï¼</span></span><br><span class="line">       <span class="keyword">if</span> (<span class="string">""</span>.equals(uploadFileName)){</span><br><span class="line">           <span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br><span class="line">      }</span><br><span class="line">       System.out.println(<span class="string">"ä¸Šä¼ æ–‡ä»¶å : "</span>+uploadFileName);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> request.getServletContext().getRealPath(<span class="string">"/upload"</span>);</span><br><span class="line">       <span class="comment">//å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ª</span></span><br><span class="line">       <span class="type">File</span> <span class="variable">realPath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">       <span class="keyword">if</span> (!realPath.exists()){</span><br><span class="line">           realPath.mkdir();</span><br><span class="line">      }</span><br><span class="line">       System.out.println(<span class="string">"ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š"</span>+realPath);</span><br><span class="line"></span><br><span class="line">       <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> file.getInputStream(); <span class="comment">//æ–‡ä»¶è¾“å…¥æµ</span></span><br><span class="line">       <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(realPath,uploadFileName)); <span class="comment">//æ–‡ä»¶è¾“å‡ºæµ</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//è¯»å–å†™å‡º</span></span><br><span class="line">       <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">       <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">       <span class="keyword">while</span> ((len=is.read(buffer))!=-<span class="number">1</span>){</span><br><span class="line">           os.write(buffer,<span class="number">0</span>,len);</span><br><span class="line">           os.flush();</span><br><span class="line">      }</span><br><span class="line">       os.close();</span><br><span class="line">       is.close();</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>5ã€æµ‹è¯•ä¸Šä¼ æ–‡ä»¶ï¼ŒOKï¼</p><p><strong>é‡‡ç”¨file.Transto æ¥ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶</strong></p><p>1ã€ç¼–å†™Controller</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* é‡‡ç”¨file.Transto æ¥ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@RequestMapping("/upload2")</span></span><br><span class="line"><span class="keyword">public</span> String  <span class="title function_">fileUpload2</span><span class="params">(<span class="meta">@RequestParam("file")</span> CommonsMultipartFile file, HttpServletRequest request)</span> <span class="keyword">throws</span> IOException {</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span></span><br><span class="line">   <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> request.getServletContext().getRealPath(<span class="string">"/upload"</span>);</span><br><span class="line">   <span class="type">File</span> <span class="variable">realPath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">   <span class="keyword">if</span> (!realPath.exists()){</span><br><span class="line">       realPath.mkdir();</span><br><span class="line">  }</span><br><span class="line">   <span class="comment">//ä¸Šä¼ æ–‡ä»¶åœ°å€</span></span><br><span class="line">   System.out.println(<span class="string">"ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š"</span>+realPath);</span><br><span class="line"></span><br><span class="line">   <span class="comment">//é€šè¿‡CommonsMultipartFileçš„æ–¹æ³•ç›´æ¥å†™æ–‡ä»¶ï¼ˆæ³¨æ„è¿™ä¸ªæ—¶å€™ï¼‰</span></span><br><span class="line">   file.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(realPath +<span class="string">"/"</span>+ file.getOriginalFilename()));</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>2ã€å‰ç«¯è¡¨å•æäº¤åœ°å€ä¿®æ”¹</p><p>3ã€è®¿é—®æäº¤æµ‹è¯•ï¼ŒOKï¼</p><h3 id="æ–‡ä»¶ä¸‹è½½"><a href="#æ–‡ä»¶ä¸‹è½½" class="headerlink" title="æ–‡ä»¶ä¸‹è½½"></a>æ–‡ä»¶ä¸‹è½½</h3><p><strong>æ–‡ä»¶ä¸‹è½½æ­¥éª¤ï¼š</strong></p><p>1ã€è®¾ç½® response å“åº”å¤´</p><p>2ã€è¯»å–æ–‡ä»¶ â€“ InputStream</p><p>3ã€å†™å‡ºæ–‡ä»¶ â€“ OutputStream</p><p>4ã€æ‰§è¡Œæ“ä½œ</p><p>5ã€å…³é—­æµ ï¼ˆå…ˆå¼€åå…³ï¼‰</p><p><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value="/download")</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">downloads</span><span class="params">(HttpServletResponse response ,HttpServletRequest request)</span> <span class="keyword">throws</span> Exception{</span><br><span class="line">   <span class="comment">//è¦ä¸‹è½½çš„å›¾ç‰‡åœ°å€</span></span><br><span class="line">   <span class="type">String</span>  <span class="variable">path</span> <span class="operator">=</span> request.getServletContext().getRealPath(<span class="string">"/upload"</span>);</span><br><span class="line">   <span class="type">String</span>  <span class="variable">fileName</span> <span class="operator">=</span> <span class="string">"åŸºç¡€è¯­æ³•.jpg"</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//1ã€è®¾ç½®response å“åº”å¤´</span></span><br><span class="line">   response.reset(); <span class="comment">//è®¾ç½®é¡µé¢ä¸ç¼“å­˜,æ¸…ç©ºbuffer</span></span><br><span class="line">   response.setCharacterEncoding(<span class="string">"UTF-8"</span>); <span class="comment">//å­—ç¬¦ç¼–ç </span></span><br><span class="line">   response.setContentType(<span class="string">"multipart/form-data"</span>); <span class="comment">//äºŒè¿›åˆ¶ä¼ è¾“æ•°æ®</span></span><br><span class="line">   <span class="comment">//è®¾ç½®å“åº”å¤´</span></span><br><span class="line">   response.setHeader(<span class="string">"Content-Disposition"</span>,</span><br><span class="line">           <span class="string">"attachment;fileName="</span>+URLEncoder.encode(fileName, <span class="string">"UTF-8"</span>));</span><br><span class="line"></span><br><span class="line">   <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path,fileName);</span><br><span class="line">   <span class="comment">//2ã€ è¯»å–æ–‡ä»¶--è¾“å…¥æµ</span></span><br><span class="line">   InputStream input=<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">   <span class="comment">//3ã€ å†™å‡ºæ–‡ä»¶--è¾“å‡ºæµ</span></span><br><span class="line">   <span class="type">OutputStream</span> <span class="variable">out</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line"></span><br><span class="line">   <span class="type">byte</span>[] buff =<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">   <span class="type">int</span> index=<span class="number">0</span>;</span><br><span class="line">   <span class="comment">//4ã€æ‰§è¡Œ å†™å‡ºæ“ä½œ</span></span><br><span class="line">   <span class="keyword">while</span>((index= input.read(buff))!= -<span class="number">1</span>){</span><br><span class="line">       out.write(buff, <span class="number">0</span>, index);</span><br><span class="line">       out.flush();</span><br><span class="line">  }</span><br><span class="line">   out.close();</span><br><span class="line">   input.close();</span><br><span class="line">   <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å‰ç«¯</p><figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;a href=<span class="string">"/download"</span>&gt;ç‚¹å‡»ä¸‹è½½&lt;/a&gt;</span><br></pre></td></tr></tbody></table></figure><p>æµ‹è¯•ï¼Œæ–‡ä»¶ä¸‹è½½OKï¼Œå¤§å®¶å¯ä»¥å’Œæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„JavaWebåŸç”Ÿçš„æ–¹å¼å¯¹æ¯”ä¸€ä¸‹ï¼Œå°±å¯ä»¥çŸ¥é“è¿™ä¸ªä¾¿æ·å¤šäº†!</p>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringMVC </tag>
            
            <tag> SSMæ•´åˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis</title>
      <link href="/2021/09/21/mybatis/"/>
      <url>/2021/09/21/mybatis/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h2><h2 id="1ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº"><a href="#1ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº" class="headerlink" title="1ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº"></a>1ã€ç¬¬ä¸€ä¸ªMybatisç¨‹åº</h2><h3 id="å¯¼å…¥mavenä¾èµ–"><a href="#å¯¼å…¥mavenä¾èµ–" class="headerlink" title="å¯¼å…¥mavenä¾èµ–"></a>å¯¼å…¥mavenä¾èµ–</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--      çˆ¶å·¥ç¨‹  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.miaobuyi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ssm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>11<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="ä¾¿æºmybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#ä¾¿æºmybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="ä¾¿æºmybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>ä¾¿æºmybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  æ¯ä¸€ä¸ªMapper.XMLéƒ½éœ€è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œï¼  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span>  <span class="attr">resource</span>=<span class="string">"com/miaobuyi/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="ç¼–å†™mybatiså·¥å…·ç±»"><a href="#ç¼–å†™mybatiså·¥å…·ç±»" class="headerlink" title="ç¼–å†™mybatiså·¥å…·ç±»"></a>ç¼–å†™mybatiså·¥å…·ç±»</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">//sqlSessionFactory --&gt; sqlSession</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisUtils</span> {</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line">    <span class="keyword">static</span> {</span><br><span class="line">       <span class="keyword">try</span> {</span><br><span class="line">           <span class="comment">//ä½¿ç”¨Mybatisç¬¬ä¸€æ­¥ï¼šè·å–sqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">resource</span> <span class="operator">=</span> <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            sqlSessionFactory = <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(inputStream);</span><br><span class="line">        } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//æ—¢ç„¶æœ‰äº† ï¼Œé¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»ä¸­è·å¾—SqlSessionçš„å®ä¾‹äº†ã€‚</span></span><br><span class="line">    <span class="comment">//SqlSession å®Œå…¨åŒ…å«äº†é¢å‘æ•°æ®åº“æ‰§è¡ŒSQLå‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title function_">getSqlSeesion</span><span class="params">()</span>{</span><br><span class="line">        <span class="keyword">return</span>  sqlSessionFactory.openSession();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="å®ä½“ç±»"><a href="#å®ä½“ç±»" class="headerlink" title="å®ä½“ç±»"></a>å®ä½“ç±»</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(<span class="type">int</span> id, String name, String pwd)</span> {</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.pwd = pwd;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> {</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> {</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPwd</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> pwd;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPwd</span><span class="params">(String pwd)</span> {</span><br><span class="line">        <span class="built_in">this</span>.pwd = pwd;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="Mapper-æ¥å£"><a href="#Mapper-æ¥å£" class="headerlink" title="Mapper æ¥å£"></a>Mapper æ¥å£</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.mapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> {</span><br><span class="line">    List&lt;User&gt; <span class="title function_">getUserList</span><span class="params">()</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="XMLæ–‡ä»¶é‡Œä¸è¦å†™ä¸­æ–‡æ³¨é‡Šè¦æŠ¥é”™"><a href="#XMLæ–‡ä»¶é‡Œä¸è¦å†™ä¸­æ–‡æ³¨é‡Šè¦æŠ¥é”™" class="headerlink" title="XMLæ–‡ä»¶é‡Œä¸è¦å†™ä¸­æ–‡æ³¨é‡Šè¦æŠ¥é”™"></a>XMLæ–‡ä»¶é‡Œä¸è¦å†™ä¸­æ–‡æ³¨é‡Šè¦æŠ¥é”™</h3><p>æ¥å£å®ç°ç±» ç”±åŸæ¥çš„UserMapperImplè½¬å˜æˆä¸ºä¸€ä¸ªMapperé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace=ç»‘å®šä¸€ä¸ªå¯¹åº”çš„Dao/Mappseræ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.miaobuyi.mapper.UserMapper"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--selecteæŸ¥è¯¢è¯­å¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserList"</span> <span class="attr">resultType</span>=<span class="string">"com.miaobuyi.pojo.User"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><p>mavenç”±äºä»–çš„çº¦å®šå¤§äºé…ç½®ï¼Œæˆ‘ä»¬ä¹‹åå¯èƒ½é‡åˆ°æˆ‘ä»¬é…ç½®æ–‡ä»¶ï¼Œæ— æ³•è¢«åˆ°å¤„æˆ–è€…ç”Ÿæ•ˆçš„é—®é¢˜ï¼›è§£å†³æ–¹æ¡ˆpom.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åœ¨buildä¸­é…ç½®resourceã€‚æ¥é˜²æ­¢æˆ‘ä»¬èµ„æºå¯¼å‡ºå¤±è´¥çš„é—®é¢˜   --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resource<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.mapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.utils.MybatisUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMapperTest</span> {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>{</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€æ­¥è·å–SqlSessionå¯¹è±¡</span></span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="comment">//æ‰§è¡Œsql  æ–¹å¼1ï¼šgetMapper</span></span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">userMapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        List&lt;User&gt; userList = userMapper.getUserList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹å¼2 è€æ–¹å¼</span></span><br><span class="line">        <span class="comment">//userList =  sqlSession.selectList("com.miaobuyi.mapper.UserMapper.getUserList");</span></span><br><span class="line">        <span class="keyword">for</span> (User user :userList){</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­SqlSession</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h2 id="2ã€CRUD"><a href="#2ã€CRUD" class="headerlink" title="2ã€CRUD"></a>2ã€CRUD</h2><h3 id="1ã€namesapce"><a href="#1ã€namesapce" class="headerlink" title="1ã€namesapce"></a>1ã€namesapce</h3><p>namespaceä¸­çš„åŒ…åè¦å’ŒDao/mapperæ¥å£ä¸­çš„åŒ…åä¸€è‡´ï¼</p><h3 id="2ã€select"><a href="#2ã€select" class="headerlink" title="2ã€select"></a>2ã€select</h3><p>é€‰æ‹©ï¼ŒæŸ¥è¯¢ä¸€å¥ï¼š</p><ul><li>idï¼šå°±æ˜¯å¯¹åº”namespaceä¸­çš„æ–¹æ³•å</li><li>resultTypeï¼šsqlè¯­å¥æ‰§è¡Œçš„è¿”å›å€¼</li><li>parameterTpeyï¼šå‚æ•°ç±»å‹</li></ul><ol><li><p>ç¼–å†™æ¥å£</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">    User <span class="title function_">getUserById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br></pre></td></tr></tbody></table></figure></li><li><p>ç¼–å†™å¯¹åº”mapperä¸­çš„sqlè¯­å¥</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">resultType</span>=<span class="string">"com.miaobuyi.pojo.User"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>æµ‹è¯•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUserById</span><span class="params">()</span>{</span><br><span class="line">       <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> MybatisUtils.getSqlSession();</span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mapper.getUserById(<span class="number">1</span>);</span><br><span class="line">       System.out.println(user);</span><br><span class="line">       sqlSession.close();</span><br><span class="line">   }</span><br></pre></td></tr></tbody></table></figure></li></ol><h3 id="3ã€insert"><a href="#3ã€insert" class="headerlink" title="3ã€insert"></a>3ã€insert</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.miaobuyi.pojo.User"</span>&gt;</span></span><br><span class="line">        insert  into mybatis.user (id,name,pwd)values (#{id},#{name},#{pwd})</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="4ã€update"><a href="#4ã€update" class="headerlink" title="4ã€update"></a>4ã€update</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.miaobuyi.pojo.User"</span>&gt;</span></span><br><span class="line">        update mybatis.user set name = #{name},pwd=#{pwd} where id=#{id};</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="5ã€delete"><a href="#5ã€delete" class="headerlink" title="5ã€delete"></a>5ã€delete</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">    delete from mybatis.user where id=#{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>æ³¨æ„ï¼šå¢åˆ æ”¹éœ€è¦æäº¤äº‹åŠ¡</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">sqlSessionFactory.openSession(<span class="literal">true</span>);<span class="comment">//å·¥å…·ç±»ä¸­  è‡ªåŠ¨å¼€å¯æäº¤äº‹åŠ¡</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">sqlSession.commit();</span><br></pre></td></tr></tbody></table></figure><h3 id="6ã€åˆ†æé”™è¯¯"><a href="#6ã€åˆ†æé”™è¯¯" class="headerlink" title="6ã€åˆ†æé”™è¯¯"></a>6ã€åˆ†æé”™è¯¯</h3><ul><li><p>æ ‡ç­¾ä¸è¦åŒ¹é…é”™è¯¯</p></li><li><p>resourceç»‘å®šmapperï¼Œéœ€è¦ä½¿ç”¨è·¯å¾„</p></li><li><p>ç¨‹åºé…ç½®æ–‡ä»¶å¿…é¡»ç¬¦åˆè§„èŒƒ</p></li><li><p>NullPointerExceptionï¼Œæ²¡æœ‰æ³¨å†Œåˆ°èµ„æº</p></li><li><p>è¾“å‡ºçš„xmlæ–‡ä»¶ä¸­å­˜åœ¨ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ˆæœ€å¥½ä¸è¦å†™æ³¨é‡Šï¼‰</p></li><li><p>mavenèµ„æºæ²¡æœ‰å¯¼å‡ºé—®é¢˜</p></li></ul><h3 id="7ã€ä¸‡èƒ½map"><a href="#7ã€ä¸‡èƒ½map" class="headerlink" title="7ã€ä¸‡èƒ½map"></a>7ã€ä¸‡èƒ½map</h3><p>å‡è®¾ï¼Œæˆ‘ä»¬çš„å®ä½“ç±»ï¼Œæˆ–è€…æ•°æ®åº“ä¸­çš„è¡¨ï¼Œå­—æ®µæˆ–è€…å‚æ•°è¿‡å¤šï¼Œæˆ‘ä»¬åº”å½“è€ƒè™‘ä½¿ç”¨mapï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//ä¸‡èƒ½map</span></span><br><span class="line">User <span class="title function_">addUser2</span><span class="params">(Map&lt;String,Object&gt; map)</span>;</span><br></pre></td></tr></tbody></table></figure><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser2"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">        insert  into mybatis.user (id,name,pwd)values (#{userid},#{uerName},#{password})</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser2</span><span class="params">()</span>{</span><br><span class="line">       <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> MybatisUtils.getSqlSession();</span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">       Map&lt;String,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Object&gt;();</span><br><span class="line">       map.put(<span class="string">"userid"</span>,<span class="string">"2"</span>);</span><br><span class="line">       map.put(<span class="string">"userName"</span>,<span class="string">"2"</span>);</span><br><span class="line">       map.put(<span class="string">"password"</span>,<span class="string">"2"</span>);</span><br><span class="line">       mapper.addUser2(map);</span><br><span class="line">       sqlSession.close();</span><br><span class="line">   }</span><br></pre></td></tr></tbody></table></figure><p>Mapä¼ é€’å‚æ•°æ—¶ï¼Œåœ¨sqlä¸­ç›´æ¥å–å‡ºkeyå³å¯</p><p>å¯¹è±¡ä¼ é€’å‚æ•°ï¼Œç›´æ¥åœ¨sqlä¸­å–å¯¹è±¡å±æ€§å³å¯</p><p>åªæœ‰ä¸€ä¸ªåŸºæœ¬ç±»å‹å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥åœ¨sqlä¸­å–åˆ°</p><p>å¤šä¸ªå‚æ•°ç”¨Mapï¼Œæˆ–è€…<strong>æ³¨è§£</strong></p><h3 id="8ã€æ€è€ƒé¢˜"><a href="#8ã€æ€è€ƒé¢˜" class="headerlink" title="8ã€æ€è€ƒé¢˜"></a>8ã€æ€è€ƒé¢˜</h3><p>æ¨¡ç³ŠæŸ¥è¯¢æ€ä¹ˆå†™ï¼Ÿ</p><ol><li><p>javaä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼ é€’é€šé…ç¬¦% %</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">List&lt;User&gt; userList = mapper.getUserLike(<span class="string">"%æ%"</span>);</span><br></pre></td></tr></tbody></table></figure></li><li><p>åœ¨sqlæ‹¼æ¥ä¸­ä½¿ç”¨é€šé…ç¬¦ï¼</p><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mybatis.user <span class="keyword">where</span> name <span class="keyword">like</span> "%"#{<span class="keyword">value</span>}"%"</span><br></pre></td></tr></tbody></table></figure></li></ol><h2 id="3ã€é…ç½®è§£æ"><a href="#3ã€é…ç½®è§£æ" class="headerlink" title="3ã€é…ç½®è§£æ"></a>3ã€é…ç½®è§£æ</h2><h3 id="1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>1ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶</h3><ul><li><p>mybatis-config.xml</p></li><li><p>Mybatisçš„é…ç½®æ–‡ä»¶åŒ…å«äº†ä¼šæ·±æ·±å½±å“Mybatisè¡Œä¸ºçš„è®¾ç½®å’Œå±æ€§ä¿¡æ¯</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line">configurationï¼ˆé…ç½®ï¼‰</span><br><span class="line">propertiesï¼ˆå±æ€§ï¼‰</span><br><span class="line">settingsï¼ˆè®¾ç½®ï¼‰</span><br><span class="line">typeAliasesï¼ˆç±»å‹åˆ«åï¼‰</span><br><span class="line">typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</span><br><span class="line">objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</span><br><span class="line">pluginsï¼ˆæ’ä»¶ï¼‰</span><br><span class="line">environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰</span><br><span class="line">environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰</span><br><span class="line">transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</span><br><span class="line">dataSourceï¼ˆæ•°æ®æºï¼‰</span><br><span class="line">databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰</span><br><span class="line">mappersï¼ˆæ˜ å°„å™¨ï¼‰</span><br></pre></td></tr></tbody></table></figure></li></ul><h3 id="2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"><a href="#2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰" class="headerlink" title="2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"></a>2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰</h3><p>MyBatis å¯ä»¥é…ç½®æˆé€‚åº”å¤šç§ç¯å¢ƒ</p><p><strong>ä¸è¿‡è¦è®°ä½ï¼šå°½ç®¡å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œä½†æ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒã€‚</strong></p><p>å­¦ä¼šä½¿ç”¨å¤šå¥—é…ç½®è¿è¡Œç¯å¢ƒ</p><p>mybatisé»˜è®¤çš„é£Ÿç‰©ç®¡ç†å™¨å°±æ˜¯JDBCï¼Œè¿æ¥æ± ï¼šPOOLED</p><h3 id="3ã€å±æ€§ï¼ˆpropertiesï¼‰"><a href="#3ã€å±æ€§ï¼ˆpropertiesï¼‰" class="headerlink" title="3ã€å±æ€§ï¼ˆpropertiesï¼‰"></a>3ã€å±æ€§ï¼ˆpropertiesï¼‰</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡propertieså±æ€§æ¥å®ç°å¼•ç”¨é…ç½®æ–‡ä»¶</p><p>è¿™äº›å±æ€§å¯ä»¥åœ¨å¤–éƒ¨è¿›è¡Œé…ç½®ï¼Œå¹¶å¯ä»¥è¿›è¡ŒåŠ¨æ€æ›¿æ¢ã€‚ä½ æ—¢å¯ä»¥åœ¨å…¸å‹çš„ Java å±æ€§æ–‡ä»¶ä¸­é…ç½®è¿™äº›å±æ€§ï¼Œä¹Ÿå¯ä»¥åœ¨ properties å…ƒç´ çš„å­å…ƒç´ ä¸­è®¾ç½®ã€‚</p><p>db.properties</p><p>ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶</p><figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?useSSL=false&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">123456</span></span><br></pre></td></tr></tbody></table></figure><p>åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­å¼•ç”¨</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><ul><li>å¯ä»¥ç›´æ¥å¼•å…¥å¤–éƒ¨æ–‡ä»¶</li><li>å¯ä»¥åœ¨å…¶ä¸­å¢åŠ ä¸€äº›é…ç½®å±æ€§</li><li>å¦‚æœä¸¤ä¸ªæ–‡ä»¶æœ‰åŒä¸€ä¸ªå­—æ®µï¼Œå…ˆè¯»å–propertieså…ƒç´ ä½“å†…æŒ‡å®šçš„å±æ€§ï¼Œç„¶åæ ¹æ®propertieså…ƒç´ ä¸­resourceå±æ€§è¯»å–ç±»è·¯å¾„ä¸‹å±æ€§æ–‡ä»¶ï¼Œæˆ–æ ¹æ®urlå±æ€§æŒ‡å®šçš„è·¯å¾„è¯»å–å±æ€§æ–‡ä»¶ï¼Œå¹¶è¦†ç›–ä¹‹å‰è¯»å–è¿‡å¾—åŒåå±æ€§ï¼Œæœ€åè¯»å–ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’çš„å±æ€§ï¼Œå¹¶è¦†ç›–ä¹‹å‰è¯»å–è¿‡çš„åŒåå±æ€§</li></ul><h3 id="4ã€ç±»å‹åˆ«å-typeAliases"><a href="#4ã€ç±»å‹åˆ«å-typeAliases" class="headerlink" title="4ã€ç±»å‹åˆ«å(typeAliases)"></a>4ã€ç±»å‹åˆ«å(typeAliases)</h3><ul><li>ç±»å‹åˆ«åæ˜¯javaç±»å‹è®¾ç½®ä¸€ä¸ªçŸ­çš„åå­—</li><li>å®ƒä»…ç”¨äº XML é…ç½®ï¼Œæ„åœ¨é™ä½å†—ä½™çš„å…¨é™å®šç±»åä¹¦å†™</li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.miaobuyi.pojo.User"</span> <span class="attr">alias</span>=<span class="string">"User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…åï¼ŒMyBatis ä¼šåœ¨åŒ…åä¸‹é¢æœç´¢éœ€è¦çš„ Java Bean</p><p>æ‰«æå®ä½“ç±»çš„åŒ…ï¼Œå®ƒçš„é»˜è®¤åˆ«åå°±ä¸ºè¿™ä¸ªç±»çš„ç±»åï¼Œé¦–å­—æ¯å°å†™ï¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.miaobuyi.pojo"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>åœ¨å®ä½“ç±»æ¯”è¾ƒå°‘çš„æ—¶å€™ä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼</p><p>å¦‚æœå®ä½“ç±»ååˆ†å¤šï¼Œå»ºè®®ä½¿ç”¨ç¬¬äºŒç§</p><p>ç¬¬ä¸€ç§å¯ä»¥DIYåˆ«åï¼Œç¬¬äºŒç§ä¸è¡Œï¼Œå¦‚æœéè¦æ”¹ï¼Œéœ€è¦åœ¨å®ä½“ä¸Šå¢åŠ æ³¨è§£</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Alias("user")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {}</span><br></pre></td></tr></tbody></table></figure><h3 id="5ã€è®¾ç½®"><a href="#5ã€è®¾ç½®" class="headerlink" title="5ã€è®¾ç½®"></a>5ã€è®¾ç½®</h3><p>è¿™æ˜¯MyBatisä¸­æä¸ºé‡è¦çš„è°ƒæ•´è®¾ç½®ï¼Œå®ƒä»¬ä¼šæ”¹å˜MyBatisçš„è¿è¡Œæ—¶è¡Œä¸ºã€‚</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210714190420538.png" alt="image-20210714190420538"></p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210714190451330.png" alt="image-20210714190451330"></p><h4 id="6ã€å…¶ä»–è®¾ç½®"><a href="#6ã€å…¶ä»–è®¾ç½®" class="headerlink" title="6ã€å…¶ä»–è®¾ç½®"></a>6ã€å…¶ä»–è®¾ç½®</h4><ul><li><p>typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</p></li><li><p>objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</p></li><li><p>pluginsï¼ˆæ’ä»¶ï¼‰</p></li><li><p>mybatis-generator-core</p></li><li><p>mybatis-plus</p></li><li><p>é€šç”¨mapper</p></li></ul><h3 id="7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰"><a href="#7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰" class="headerlink" title="7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰"></a>7ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰</h3><p>MapperRegistryï¼šæ³¨å†Œç»‘å®šæˆ‘ä»¬çš„Mapperæ–‡ä»¶ï¼›</p><p>æ–¹å¼ä¸€ï¼šã€æ¨èä½¿ç”¨ã€‘</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  æ¯ä¸€ä¸ªMapper.XMLéƒ½éœ€è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œï¼  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span>  <span class="attr">resource</span>=<span class="string">"com/miaobuyi/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.mapper.UserMapper"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>æ–¹å¼äºŒï¼šä½¿ç”¨classæ–‡ä»¶ç»‘å®šæ³¨å†Œ</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.mapper.UserMapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>æ³¨æ„ç‚¹ï¼š</p><ul><li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åŒåï¼</li><li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼</li></ul><p>æ–¹å¼ä¸‰ï¼š</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.miaobuyi.mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><ul><li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åŒåï¼ï¼ˆUserMapperæ¥å£å’ŒUserMapper.xmlï¼‰</li><li>æ¥å£å’Œä»–çš„Mapperé…ç½®æ–‡ä»¶å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼</li></ul><h3 id="8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"><a href="#8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ" class="headerlink" title="8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"></a>8ã€ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ</h3><p>ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸæ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„<strong>å¹¶å‘é—®é¢˜</strong>ã€‚</p><p><strong>SqlSessionFactoryBuilder</strong>ï¼š</p><ul><li>ä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†</li><li>å±€éƒ¨å˜é‡</li></ul><p><strong>SqlSessionFactory</strong>ï¼š</p><ul><li>è¯´ç™½äº†å°±æ˜¯å¯ä»¥æƒ³è±¡ä¸ºï¼šæ•°æ®é“¾æ¥æ± </li><li>SqlSessionFactoryä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œ<strong>æ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹</strong></li><li>å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚ </li><li>æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨<strong>å•ä¾‹æ¨¡å¼</strong>æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼</li></ul><p><strong>SqlSession</strong></p><ul><li>é“¾æ¥åˆ°è¿æ¥æ± çš„ä¸€ä¸ªè¯·æ±‚ï¼</li><li>SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸ</li><li>ç”¨å®Œä¹‹åéœ€è¦èµ¶ç´§å…³é—­ï¼Œå¦åˆ™èµ„æºè¢«å ç”¨ï¼</li></ul><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210714194447645.png" alt="image-20210714194447645"></p><p>è¿™é‡Œé¢çš„æ¯ä¸€ä¸ªMapperï¼Œå°±ä»£è¡¨ä¸€ä¸ªå…·ä½“çš„ä¸šåŠ¡ï¼</p><h2 id="4ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"><a href="#4ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜" class="headerlink" title="4ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"></a>4ã€è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜</h2><h3 id="1ã€é—®é¢˜"><a href="#1ã€é—®é¢˜" class="headerlink" title="1ã€é—®é¢˜"></a>1ã€é—®é¢˜</h3><p>æ•°æ®åº“ä¸­çš„å­—æ®µ</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210714194722061.png" alt="image-20210714194722061"></p><p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ‹·è´ä¹‹å‰çš„ï¼Œæµ‹è¯•å®ä½“ç±»å­—æ®µä¸ä¸€è‡´çš„æƒ…å†µ</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æµ‹è¯•å‡ºç°é—®é¢˜</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210714195944486.png" alt="image-20210714195944486"></p><p>è§£å†³åŠæ³•</p><ul><li><p>èµ·åˆ«å</p>  <figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mybatis.user <span class="keyword">where</span> id <span class="operator">=</span> #{id}</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>ç±»å‹å¤„ç†å™¨</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span><span class="keyword">select</span> id,name,pwd <span class="keyword">from</span> mybatis.user <span class="keyword">where</span> id <span class="operator">=</span> #{id}```</span><br></pre></td></tr></tbody></table></figure></li></ul><h3 id="2ã€resultMap"><a href="#2ã€resultMap" class="headerlink" title="2ã€resultMap"></a>2ã€resultMap</h3><p>ç»“æœé›†æ˜ å°„</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">id name pwd</span><br><span class="line">id name password</span><br></pre></td></tr></tbody></table></figure><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--ç»“æœé›†æ˜ å°„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"UserMap"</span> <span class="attr">type</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--columnæ•°æ®åº“ä¸­çš„å­—æ®µï¼Œpropertyå®ä½“ç±»ä¸­çš„å±æ€§--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pwd"</span> <span class="attr">property</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">resultMap</span>=<span class="string">"UserMap"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><ul><li><code>resultMap</code> å…ƒç´ æ˜¯ MyBatis ä¸­æœ€é‡è¦æœ€å¼ºå¤§çš„å…ƒç´ </li><li><code>ResultMap</code> çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œå¯¹ç®€å•çš„è¯­å¥åšåˆ°é›¶é…ç½®ï¼Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼Œåªéœ€è¦æè¿°è¯­å¥ä¹‹é—´çš„å…³ç³»å°±è¡Œäº†ã€‚</li><li><code>ResultMap</code>çš„ä¼˜ç§€ä¹‹å¤„,è™½ç„¶ä½ å·²ç»å¯¹ä»–ç›¸å½“äº†è§£äº†ï¼Œä½†æ˜¯æ ¹æœ¬å°±ä¸éœ€è¦æ˜¾å¼åœ°é…ç½®å®ƒä»¬ã€‚</li></ul><h2 id="5ã€æ—¥å¿—"><a href="#5ã€æ—¥å¿—" class="headerlink" title="5ã€æ—¥å¿—"></a>5ã€æ—¥å¿—</h2><h3 id="1ã€æ—¥å¿—å·¥ç¨‹"><a href="#1ã€æ—¥å¿—å·¥ç¨‹" class="headerlink" title="1ã€æ—¥å¿—å·¥ç¨‹"></a>1ã€æ—¥å¿—å·¥ç¨‹</h3><p>å¦‚æœä¸€ä¸ªæ•°æ®åº“æ“ä½œï¼Œå‡ºç°äº†å¼‚å¸¸ï¼Œæˆ‘ä»¬éœ€è¦é…é”™ï¼Œæ—¥å¿—å°±æ˜¯æœ€å¥½çš„åŠ©æ‰‹</p><p>æ›¾ç»ï¼šsoutï¼Œdebug</p><p>ç°åœ¨ï¼šæ—¥å¿—å·¥å‚ï¼</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210715124954090.png" alt="image-20210715124954090"></p><ul><li>SLF4J </li><li>LOG4J ã€æŒæ¡ã€‘</li><li>LOG4J2 </li><li>JDK_LOGGING </li><li>COMMONS_LOGGING </li><li>STDOUT_LOGGING ã€æŒæ¡ã€‘</li><li>NO_LOGGING</li></ul><p>åœ¨mybatisä¸­å…·ä½“ä½¿ç”¨å“ªä¸€ä¸ªæ—¥å¿—å®ç°ï¼Œåœ¨è®¾ç½®ä¸­è®¾å®š</p><p><strong>STDOUT_LOGGINGæ ‡å‡†æ—¥å¿—è¾“å‡º</strong></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"STDOUT_LOGGING"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210715125831931.png" alt="image-20210715125831931"></p><h3 id="2ã€LOG4J"><a href="#2ã€LOG4J" class="headerlink" title="2ã€LOG4J"></a>2ã€LOG4J</h3><p>ä»€ä¹ˆæ˜¯LOG4J ï¼Ÿ</p><ul><li>Log4jæ˜¯<a href="https://baike.baidu.com/item/Apache/8512995">Apache</a>çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œé€šè¿‡ä½¿ç”¨Log4jï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“é€çš„ç›®çš„åœ°æ˜¯<a href="https://baike.baidu.com/item/%E6%8E%A7%E5%88%B6%E5%8F%B0/2438626">æ§åˆ¶å°</a>ã€æ–‡ä»¶ã€<a href="https://baike.baidu.com/item/GUI">GUI</a>ç»„ä»¶</li><li>é€šè¿‡å®šä¹‰æ¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯çš„çº§åˆ«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç»†è‡´åœ°æ§åˆ¶æ—¥å¿—çš„ç”Ÿæˆè¿‡ç¨‹ã€‚</li><li>é€šè¿‡ä¸€ä¸ª<a href="https://baike.baidu.com/item/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/286550">é…ç½®æ–‡ä»¶</a>æ¥çµæ´»åœ°è¿›è¡Œé…ç½®ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åº”ç”¨çš„ä»£ç ã€‚</li></ul><ol><li><p>å…ˆå¯¼å…¥LOG4J çš„åŒ…ã€</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>log4j.properties</p><figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#å°†ç­‰çº§ä¸ºDEBUGçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°consoleå’Œfileè¿™ä¸¤ä¸ªç›®çš„åœ°ï¼Œconsoleå’Œfileçš„å®šä¹‰åœ¨ä¸‹é¢çš„ä»£ç </span></span><br><span class="line"><span class="attr">log4j.rootLogger</span>=<span class="string">DEBUG,console,file</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#æ§åˆ¶å°è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="attr">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="attr">log4j.appender.console.Target</span> = <span class="string">System.out</span></span><br><span class="line"><span class="attr">log4j.appender.console.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.console.layout.ConversionPattern</span>=<span class="string">[%c]-%m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#æ–‡ä»¶è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="attr">log4j.appender.file</span> = <span class="string">org.apache.log4j.RollingFileAppender</span></span><br><span class="line"><span class="attr">log4j.appender.file.File</span>=<span class="string">./log/miaobuyi.log</span></span><br><span class="line"><span class="attr">log4j.appender.file.MaxFileSize</span>=<span class="string">10mb</span></span><br><span class="line"><span class="attr">log4j.appender.file.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">[%p][%d{yy-MM-dd}][%c]%m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#æ—¥å¿—è¾“å‡ºçº§åˆ«</span></span><br><span class="line"><span class="attr">log4j.logger.org.mybatis</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.logger.java.sql</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.logger.java.sql.Statement</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.logger.java.sql.ResultSet</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.logger.java.sql.PreparedStatement</span>=<span class="string">DEBUG</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>é…ç½®log4jä¸ºæ—¥å¿—çš„å®ç°</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>log4jçš„ä½¿ç”¨ï¼ç›´æ¥è¿è¡Œåˆšæ‰çš„æŸ¥è¯¢</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210715132513047.png" alt="image-20210715132513047"></p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210715132537236.png" alt="image-20210715132537236"></p></li></ol><p><strong>ç®€å•ä½¿ç”¨</strong></p><ol><li><p>åœ¨è¦ä½¿ç”¨log4jç±»ä¸­ï¼Œå¯¼å…¥åŒ… import org.apache.log4j.Logger;</p></li><li><p>æ—¥å¿—å¯¹è±¡ï¼Œå‚æ•°ä¸ºå½“å‰ç±»çš„class</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> Logger.getLogger(UserMapperTest.class);</span><br></pre></td></tr></tbody></table></figure></li><li><p>æ—¥å¿—çº§åˆ«</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">logger.info(<span class="string">"info:è¿›å…¥äº†testLog4j"</span>);</span><br><span class="line">logger.debug(<span class="string">"debug:è¿›å…¥äº†testLog4j"</span>);</span><br><span class="line">logger.error(<span class="string">"error:è¿›å…¥äº†testLog4j"</span>);</span><br></pre></td></tr></tbody></table></figure></li></ol><h2 id="6ã€åˆ†é¡µ"><a href="#6ã€åˆ†é¡µ" class="headerlink" title="6ã€åˆ†é¡µ"></a>6ã€åˆ†é¡µ</h2><p><strong>æ€è€ƒï¼šä¸ºä»€ä¹ˆè¦åˆ†é¡µ</strong></p><ul><li>å‡å°‘ä»¥æ•°æ®çš„å¤„ç†é‡</li></ul><h3 id="1ã€ä½¿ç”¨Limitåˆ†é¡µ"><a href="#1ã€ä½¿ç”¨Limitåˆ†é¡µ" class="headerlink" title="1ã€ä½¿ç”¨Limitåˆ†é¡µ"></a>1ã€ä½¿ç”¨Limitåˆ†é¡µ</h3><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">è¯­æ³•ï¼š<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> limit startIndex,pageSize</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mybatis.user limit <span class="number">3</span>; #[<span class="number">0</span>,n]</span><br></pre></td></tr></tbody></table></figure><p>ä½¿ç”¨Mybatisåˆ†é¡µï¼Œæ ¸å¿ƒSQL</p><ol><li><p>æ¥å£</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line">List<span class="tag">&lt;<span class="name">User</span>&gt;</span> getUserByLimit(Map&lt;String,Integer&gt; map);</span><br></pre></td></tr></tbody></table></figure></li><li><p>Mapper.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByLimit"</span> <span class="attr">resultMap</span>=<span class="string">"UserMap"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user limit #{startIndex},#{pageSize}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>æµ‹è¯•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUserByLimit</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> MybatisUtils.getSqlSession();</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    HashMap&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Integer&gt;();</span><br><span class="line">    map.put(<span class="string">"startIndex"</span>,<span class="number">0</span>);</span><br><span class="line">    map.put(<span class="string">"pageSize"</span>,<span class="number">2</span>);</span><br><span class="line">    List&lt;User&gt; userList = mapper.getUserByLimit(map);</span><br><span class="line">    <span class="keyword">for</span> (User user:userList){</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    }</span><br><span class="line">    sqlSession.close();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><h3 id="2ã€RowBoundsã€äº†è§£ã€‘"><a href="#2ã€RowBoundsã€äº†è§£ã€‘" class="headerlink" title="2ã€RowBoundsã€äº†è§£ã€‘"></a>2ã€RowBoundsã€äº†è§£ã€‘</h3><p>ä¸å†ä½¿ç”¨SQLå®ç°åˆ†é¡µ</p><ol><li><p>æ¥å£</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">List&lt;User&gt; <span class="title function_">getUserByRowBounds</span><span class="params">()</span>;</span><br></pre></td></tr></tbody></table></figure></li><li><p>mapper.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByRowBounds"</span> <span class="attr">resultMap</span>=<span class="string">"UserMap"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>æµ‹è¯•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUserByRowBounds</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> MybatisUtils.getSqlSession();</span><br><span class="line">    <span class="comment">//RowBoundså®ç°</span></span><br><span class="line">    <span class="type">RowBounds</span> <span class="variable">rowBounds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RowBounds</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡javaä»£ç å±‚é¢å®ç°åˆ†é¡µ</span></span><br><span class="line">    List&lt;User&gt; userList = sqlSession.selectList(<span class="string">"com.miaobuyi.mapper.UserMapper.getUserByRowBounds"</span>,<span class="literal">null</span>,rowBounds);</span><br><span class="line">    <span class="keyword">for</span> (User user:userList){</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    }</span><br><span class="line">    sqlSession.close();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><h3 id="3ã€æ’ä»¶åˆ†é¡µã€äº†è§£ã€‘"><a href="#3ã€æ’ä»¶åˆ†é¡µã€äº†è§£ã€‘" class="headerlink" title="3ã€æ’ä»¶åˆ†é¡µã€äº†è§£ã€‘"></a>3ã€æ’ä»¶åˆ†é¡µã€äº†è§£ã€‘</h3><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210715165613496.png" alt="image-20210715165613496"></p><h2 id="7ã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#7ã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="7ã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>7ã€ä½¿ç”¨æ³¨è§£å¼€å‘</h2><h3 id="1ã€é¢å‘æ¥å£ç¼–ç¨‹"><a href="#1ã€é¢å‘æ¥å£ç¼–ç¨‹" class="headerlink" title="1ã€é¢å‘æ¥å£ç¼–ç¨‹"></a>1ã€é¢å‘æ¥å£ç¼–ç¨‹</h3><p>å¤§å®¶ä¹‹å‰éƒ½å­¦è¿‡é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œä¹Ÿå­¦ä¹ è¿‡æ¥å£ï¼Œä½†åœ¨çœŸæ­£çš„å¼€å‘ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šé€‰æ‹©é¢å‘æ¥å£ç¼–ç¨‹</p><p><strong>-æ ¹æœ¬åŸå› âˆ¶è§£è€¦ï¼Œå¯æ‹“å±•ï¼Œæé«˜å¤ç”¨ï¼Œåˆ†å±‚å¼€å‘ä¸­ï¼Œä¸Šå±‚ä¸ç”¨ç®¡å…·ä½“çš„å®ç°ï¼Œå¤§å®¶éƒ½éµå®ˆå…±åŒçš„æ ‡å‡†ï¼Œä½¿å¾—å¼€å‘å˜å¾—å®¹æ˜“ï¼Œè§„èŒƒæ€§æ›´å¥½</strong></p><ul><li><p>åœ¨ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿçš„å„ç§åŠŸèƒ½æ˜¯ç”±è®¸è®¸å¤šå¤šçš„ä¸åŒå¯¹è±¡åä½œå®Œæˆçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹.å„ä¸ªå¯¹è±¡å†…éƒ¨æ˜¯å¦‚ä½•å®ç°è‡ªå·±çš„,å¯¹ç³»ç»Ÿè®¾è®¡äººå‘˜æ¥è®²å°±ä¸é‚£ä¹ˆé‡è¦äº†;</p></li><li><p>è€Œå„ä¸ªå¯¹è±¡ä¹‹é—´çš„åä½œå…³ç³»åˆ™æˆä¸ºç³»ç»Ÿè®¾è®¡çš„å…³é”®ã€‚å°åˆ°ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¤§åˆ°å„æ¨¡å—ä¹‹é—´çš„äº¤äº’ï¼Œåœ¨ç³»ç»Ÿè®¾è®¡ä¹‹åˆéƒ½æ˜¯è¦ç€é‡è€ƒè™‘çš„ï¼Œè¿™ä¹Ÿæ˜¯ç³»ç»Ÿè®¾è®¡çš„ä¸»è¦å·¥ä½œå†…å®¹ã€‚é¢å‘æ¥å£ç¼–ç¨‹å°±æ˜¯æŒ‡æŒ‰ç…§è¿™ç§æ€æƒ³æ¥ç¼–ç¨‹ã€‚</p></li></ul><p><strong>å…³äºæ¥å£çš„ç†è§£</strong></p><ul><li><p>æ¥å£ä»æ›´æ·±å±‚æ¬¡çš„ç†è§£ï¼Œåº”æ˜¯å®šä¹‰(è§„èŒƒï¼Œçº¦æŸï¼‰ä¸å®ç°(åå®åˆ†ç¦»çš„åŸåˆ™ï¼‰çš„åˆ†ç¦»ã€‚</p></li><li><p>æ¥å£çš„æœ¬èº«åæ˜ äº†ç³»ç»Ÿè®¾è®¡äººå‘˜å¯¹ç³»ç»Ÿçš„æŠ½è±¡ç†è§£ã€‚</p></li><li><p>æ¥å£åº”æœ‰ä¸¤ç±»:</p><ul><li>ç¬¬ä¸€ç±»æ˜¯å¯¹ä¸€ä¸ªä¸ªä½“çš„æŠ½è±¡ï¼Œå®ƒå¯å¯¹åº”ä¸ºä¸€ä¸ªæŠ½è±¡ä½“(abstract class);</li><li>ç¬¬äºŒç±»æ˜¯å¯¹ä¸€ä¸ªä¸ªä½“æŸä¸€æ–¹é¢çš„æŠ½è±¡ï¼Œå³å½¢æˆä¸€ä¸ªæŠ½è±¡é¢( interface) ;</li></ul></li><li><p>ä¸€ä¸ªä½“æœ‰å¯èƒ½æœ‰å¤šä¸ªæŠ½è±¡é¢ã€‚æŠ½è±¡ä½“ä¸æŠ½è±¡é¢æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p></li></ul><p><strong>ä¸‰ä¸ªé¢å‘åŒºåˆ«</strong></p><ul><li><p>é¢å‘å¯¹è±¡æ˜¯æŒ‡ï¼Œæˆ‘ä»¬è€ƒè™‘é—®é¢˜æ—¶ï¼Œä»¥å¯¹è±¡ä¸ºå•ä½,è€ƒè™‘å®ƒçš„å±æ€§åŠæ–¹æ³•.</p></li><li><p>é¢å‘è¿‡ç¨‹æ˜¯æŒ‡ï¼Œæˆ‘ä»¬è€ƒè™‘é—®é¢˜æ—¶ï¼Œä»¥ä¸€ä¸ªå…·ä½“çš„æµç¨‹(äº‹åŠ¡è¿‡ç¨‹)ä¸ºå•ä½ï¼Œè€ƒè™‘å®ƒçš„å®ç°.</p></li><li><p>æ¥å£è®¾è®¡ä¸éæ¥å£è®¾è®¡æ˜¯é’ˆå¯¹å¤ç”¨æŠ€æœ¯è€Œè¨€çš„ï¼Œä¸é¢å‘å¯¹è±¡(è¿‡ç¨‹)ä¸æ˜¯ä¸€ä¸€ä¸ªé—®é¢˜.æ›´å¤šçš„ä½“ç°å°±æ˜¯å¯¹ç³»ç»Ÿæ•´ä½“çš„</p></li></ul><h3 id="2ã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#2ã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="2ã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>2ã€ä½¿ç”¨æ³¨è§£å¼€å‘</h3><ol><li><p>æ³¨è§£åœ¨æ¥å£ä¸Šå®ç°</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Select("select * from user")</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">getUsers</span><span class="params">()</span>;</span><br></pre></td></tr></tbody></table></figure></li><li><p>éœ€è¦åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ç»‘å®šæ¥å£</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--    ç»‘å®šæ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.mapper.UserMapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>æµ‹è¯•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> MybatisUtils.getSqlSession();</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    List&lt;User&gt; userList = mapper.getUsers();</span><br><span class="line">    <span class="keyword">for</span>(User user:userList){</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    }</span><br><span class="line">    sqlSession.close();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p>æœ¬è´¨ï¼šåå°„æœºåˆ¶å®ç°</p><p>åº•å±‚ï¼šåŠ¨æ€ä»£ç†ï¼</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210715175854323.png" alt="image-20210715175854323"> </p><p><strong>Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹ï¼</strong></p><h2 id="8ã€Lombok"><a href="#8ã€Lombok" class="headerlink" title="8ã€Lombok"></a>8ã€Lombok</h2><p>ä½¿ç”¨æ­¥éª¤</p><ol><li><p>åœ¨IDEAä¸­å®‰è£…Lombok</p></li><li><p>åœ¨é¡¹ç›®ä¸­å¯¼å…¥Lombokçš„jaråŒ…</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li><li><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Getter</span> and <span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@FieldNameConstants</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span>, <span class="meta">@RequiredArgsConstructor</span> and <span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Log</span>, <span class="meta">@Log4j</span>, <span class="meta">@Log4j2</span>, <span class="meta">@Slf4j</span>, <span class="meta">@XSlf4j</span>, <span class="meta">@CommonsLog</span>, <span class="meta">@JBossLog</span>, <span class="meta">@Flogger</span>, <span class="meta">@CustomLog</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@SuperBuilder</span></span><br><span class="line"><span class="meta">@Singular</span></span><br><span class="line"><span class="meta">@Delegate</span></span><br><span class="line"><span class="meta">@Value</span></span><br><span class="line"><span class="meta">@Accessors</span></span><br><span class="line"><span class="meta">@Wither</span></span><br><span class="line"><span class="meta">@With</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="meta">@val</span></span><br><span class="line"><span class="meta">@var</span></span><br><span class="line">experimental <span class="meta">@var</span></span><br><span class="line"><span class="meta">@UtilityClass</span></span><br><span class="line"><span class="meta">@ExtensionMethod</span> (Experimental, activate manually in plugin settings)</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span>:æ— å‚æ„é€ ï¼Œgetï¼Œsetï¼ŒtoStringï¼Œhashcodeï¼Œequals</span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@FieldNameConstants</span></span><br><span class="line"><span class="meta">@ToString</span></span><br></pre></td></tr></tbody></table></figure></li></ol><h2 id="9ã€å¤šå¯¹ä¸€å¤„ç†"><a href="#9ã€å¤šå¯¹ä¸€å¤„ç†" class="headerlink" title="9ã€å¤šå¯¹ä¸€å¤„ç†"></a>9ã€å¤šå¯¹ä¸€å¤„ç†</h2><p>å¤šå¯¹ä¸€ï¼š</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210716171244575.png" alt="image-20210716171244575"></p><ul><li>å¤šä¸ªå­¦ç”Ÿï¼Œå¯¹åº”ä¸€ä¸ªè€å¸ˆ</li><li>å¯¹äºå­¦ç”Ÿè¿™è¾¹è€Œè¨€ï¼Œå…³è”ã€‚ã€‚å¯¹ä¸ªå­¦ç”Ÿï¼Œå…³è”ä¸€ä¸ªè€å¸ˆ</li><li>å¯¹äºè€å¸ˆè€Œè¨€ï¼Œé›†åˆï¼Œ</li></ul><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210716174404362.png" alt="image-20210716174404362"></p><p>ç»¿è‰²ï¼š1   è“è‰²ï¼šâˆ</p><p>SQLï¼š</p><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `teacher` (</span><br><span class="line">                           `id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">                           `name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">                           <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> teacher(`id`, `name`) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'ç§¦è€å¸ˆ'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `student` (</span><br><span class="line">                           `id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">                           `name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">                           `tid` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">                           <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">                           KEY `fktid` (`tid`),</span><br><span class="line">                           <span class="keyword">CONSTRAINT</span> `fktid` <span class="keyword">FOREIGN</span> KEY (`tid`) <span class="keyword">REFERENCES</span> `teacher` (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'å°æ˜'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">'å°çº¢'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">'å°å¼ '''</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">'å°æ'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">'å°ç‹'</span>, <span class="number">1</span>);</span><br></pre></td></tr></tbody></table></figure><h3 id="æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="æµ‹è¯•ç¯å¢ƒæ­å»º"></a>æµ‹è¯•ç¯å¢ƒæ­å»º</h3><ol><li>å¯¼å…¥Lombok</li><li>æ–°å»ºå®ä½“ç±»Teacherï¼ŒStudent</li><li>å»ºç«‹Mapperæ¥å£</li><li>å»ºç«‹Mapper.XMLæ–‡ä»¶</li><li>åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ç»‘å®šæ³¨å†Œæˆ‘ä»¬çš„Mapperæ¥å£æˆ–è€…æ–‡ä»¶ï¼ã€æ–¹å¼å¾ˆå¤šï¼Œéšå¿ƒé€‰ã€‘</li><li>æµ‹è¯•æŸ¥è¯¢æ˜¯å¦èƒ½èƒ½å¤ŸæˆåŠŸ</li></ol><h3 id="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        æ€è·¯:</span></span><br><span class="line"><span class="comment">            1.æŸ¥è¯¢æ‰€æœ‰çš„å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line"><span class="comment">            2.æ ¹æ®æŸ¥è¯¢å‡ºæ¥çš„å­¦ç”Ÿçš„tidï¼Œå¯»æ‰¾å¯¹åº”çš„è€å¸ˆ! å­æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudent"</span> <span class="attr">resultmap</span>=<span class="string">"studentTeacher"</span>&gt;</span></span><br><span class="line">    select * from student</span><br><span class="line">    <span class="tag">&lt;/<span class="name">se1ect</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"StudentTeacher"</span> <span class="attr">type</span>=<span class="string">"student"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resu1t</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resu1t</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¤æ‚çš„å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦å•ç‹¬å¤„ç†å¯¹è±¡:associationé›†åˆ:collection --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">column</span>=<span class="string">"tid"</span> <span class="attr">javaType</span>=<span class="string">"Teacher"</span> <span class="attr">select</span>=<span class="string">"getTeacher"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resu1tMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher"</span> <span class="attr">resultType</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">    select * from teacher where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"></a>æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudent2"</span> <span class="attr">resultMap</span>=<span class="string">"StudentTeacher2"</span>&gt;</span></span><br><span class="line">    select s.id sid,s.name sname,t.name tname</span><br><span class="line">    from student s,teacher t</span><br><span class="line">    where s.tid = t.id</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"StudentTeacher2"</span> <span class="attr">type</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">javaType</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"tname"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>å›é¡¾Mysqlå¤šå¯¹ä¸€æŸ¥è¯¢æ–¹å¼</p><ul><li>å­æŸ¥è¯¢</li><li>è”è¡¨æŸ¥è¯¢</li></ul><h2 id="10ã€ä¸€å¯¹å¤šå¤„ç†"><a href="#10ã€ä¸€å¯¹å¤šå¤„ç†" class="headerlink" title="10ã€ä¸€å¯¹å¤šå¤„ç†"></a>10ã€ä¸€å¯¹å¤šå¤„ç†</h2><p>æ¯”å¦‚ï¼šä¸€ä¸ªè€å¸ˆæ‹¥æœ‰å¤šä¸ªå­¦ç”Ÿï¼</p><p>å¯¹äºè€å¸ˆè€Œè¨€å°±æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼</p><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><ol><li><p>ç¯å¢ƒæ­å»ºå’Œåˆšæ‰ä¸€æ ·</p><p><strong>å®ä½“ç±»</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> {</span><br><span class="line">    <span class="keyword">private</span>  <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> tid;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Teacher</span> {</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸€ä¸ªè€å¸ˆæ‹¥æœ‰å¤šä¸ªå­¦ç”Ÿ</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; students;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><h3 id="æŒ‰ç…§è¿‡åµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§è¿‡åµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§è¿‡åµŒå¥—å¤„ç†"></a>æŒ‰ç…§è¿‡åµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher"</span> <span class="attr">resultMap</span>=<span class="string">"TeacherStudent"</span>&gt;</span></span><br><span class="line">    select s.id sid ,s.name sname,t.name tname,t.id tid</span><br><span class="line">    from student s,teacher t</span><br><span class="line">    where s.tid = t.id and t.id = #{tid}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"TeacherStudent"</span> <span class="attr">type</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"tname"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">ofType</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"sname"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"tid"</span> <span class="attr">column</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher2"</span> <span class="attr">resultMap</span>=<span class="string">"TeacherStudent2"</span>&gt;</span></span><br><span class="line">    select * from mybatis.teacher where id = #{tid}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"TeacherStudent2"</span> <span class="attr">type</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">javaType</span>=<span class="string">"ArrayList"</span> <span class="attr">ofType</span>=<span class="string">"Student"</span> <span class="attr">select</span>=<span class="string">"getStudentByTeacherId"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudentByTeacherId"</span> <span class="attr">resultType</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">    select * from mybatis.student where tid=#{tid}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>å°ç»“</p><ol><li>å…³è” - associationã€å¤šå¯¹ä¸€ã€‘</li><li>é›†åˆ - collection ã€ä¸€å¯¹å¤šã€‘ </li><li>javaType &amp; ofType<ol><li>javaTypeç”¨æ¥æŒ‡å®šå®ä½“ç±»ä¸­çš„å±æ€§ç±»å‹</li><li>ofType   ç”¨æ¥æŒ‡å®šæ˜ å°„åˆ°Listæˆ–è€…é›†åˆä¸­çš„pojoç±»å‹ä¸­ï¼Œæ³›å‹ä¸­çš„çº¦æŸç±»å‹</li></ol></li></ol><p>æ³¨æ„ç‚¹ï¼š</p><ul><li>ä¿è¯SQLçš„å¯è¯»æ€§ï¼Œå°½é‡ä¿è¯é€šä¿—æ˜“æ‡‚</li><li>æ³¨æ„ä¸€å¯¹å¤šå’Œå¤šå¯¹ä¸€ä¸­ï¼Œå±æ€§åå’Œå­—æ®µçš„é—®é¢˜</li><li>å¦‚æœé—®é¢˜ä¸å¥½æ’æŸ¥é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨æ—¥å¿—ã€‚å»ºè®®ä½¿ç”¨log4j</li></ul><p>é¢è¯•é«˜é¢‘</p><ul><li>Mysqlå¼•æ“</li><li>InnoDBä¸€å±‚åŸç†</li><li>ç´¢å¼•</li><li>ç´¢å¼•ä¼˜åŒ–ï¼</li></ul><h2 id="11ã€åŠ¨æ€SQL"><a href="#11ã€åŠ¨æ€SQL" class="headerlink" title="11ã€åŠ¨æ€SQL"></a>11ã€åŠ¨æ€SQL</h2><p><strong>ä»€ä¹ˆæ˜¯åŠ¨æ€SQLï¼šåŠ¨æ€SQLå°±æ˜¯æ ¹æ®ä¸åŒæ¡ä»¶ç”Ÿæˆä¸åŒçš„SQLè¯­å¥</strong></p><p>åˆ©ç”¨åŠ¨æ€SQLè¿™ä¸€ç‰¹æ€§å¯ä»¥å½»åº•æ‘†è„±è¿™ç§ç—›è‹¦ã€‚</p><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">åŠ¨æ€SQLå…ƒç´ å’ŒJSTLæˆ–åŸºäºç±»ä¼¼XMLçš„æ–‡æœ¬å¤„ç†å™¨ç›¸ä¼¼ã€‚åœ¨MyBatis ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæœ‰å¾ˆå¤šå…ƒç´ éœ€è¦èŠ±æ—¶é—´</span><br><span class="line">äº†è§£ã€‚MyBatis 3å¤§å¤§ç²¾ç®€äº†å…ƒç´ ç§ç±»ï¼Œç°åœ¨åªéœ€å­¦ä¹ åŸæ¥ä¸€åŠçš„å…ƒç´ ä¾¿å¯ã€‚MyBatisé‡‡ç”¨åŠŸèƒ½å¼ºå¤§çš„åŸºäºOGNL</span><br><span class="line">çš„è¡¨è¾¾å¼æ¥æ·˜æ±°å…¶å®ƒå¤§éƒ¨åˆ†å…ƒç´ ã€‚</span><br><span class="line">if</span><br><span class="line">choose (whenï¼Œ otherwise)</span><br><span class="line">trim (whereï¼Œ set)</span><br><span class="line">foreach</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="æ­å»ºç¯å¢ƒ"><a href="#æ­å»ºç¯å¢ƒ" class="headerlink" title="æ­å»ºç¯å¢ƒ"></a>æ­å»ºç¯å¢ƒ</h3><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `blog`(</span><br><span class="line">    `id` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'åšå®¢id'</span>,</span><br><span class="line">    `title` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'åšå®¢æ ‡é¢˜'</span>,</span><br><span class="line">    `author` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'åšå®¢ä½œè€…'</span>,</span><br><span class="line">    `create_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">    `views` <span class="type">int</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'æµè§ˆé‡'</span></span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br></pre></td></tr></tbody></table></figure><p>åˆ›å»ºä¸€ä¸ªåŸºç¡€å·¥ç¨‹</p><ol><li><p>å¯¼åŒ…</p></li><li><p>ç¼–å†™é…ç½®æ–‡ä»¶</p></li><li><p>ç¼–å†™å®ä½“ç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Blog</span> {</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">    <span class="keyword">private</span> Date creatTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> views;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>ç¼–å†™å®ä½“ç±»å¯¹åº”çš„Mapperæ¥å£å’ŒMapper.XMLæ–‡ä»¶</p></li></ol><h3 id="IF"><a href="#IF" class="headerlink" title="IF"></a>IF</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogIf"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog where 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">        and title = #{title}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">        and author = #{author}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="choose-whenï¼Œ-otherwise"><a href="#choose-whenï¼Œ-otherwise" class="headerlink" title="choose (whenï¼Œ otherwise)"></a>choose (whenï¼Œ otherwise)</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogChoose"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">                title = #{title}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">                and authot = #{author}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                and views = #{views}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="trim-whereï¼Œ-set-ã€trimå¯ä»¥è‡ªå®šä¹‰ã€‘"><a href="#trim-whereï¼Œ-set-ã€trimå¯ä»¥è‡ªå®šä¹‰ã€‘" class="headerlink" title="trim (whereï¼Œ set)ã€trimå¯ä»¥è‡ªå®šä¹‰ã€‘"></a>trim (whereï¼Œ set)ã€trimå¯ä»¥è‡ªå®šä¹‰ã€‘</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateBlog"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> &gt;</span></span><br><span class="line">    update mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">            title = #{title},</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">            author = #{author},</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">&lt;trim prefix="" prefixOverrides="" suffix="" suffixOverrides=""&gt;</span><br><span class="line">    </span><br><span class="line">&lt;/trim&gt;</span><br></pre></td></tr></tbody></table></figure><p><strong>æ‰€è°“åŠ¨æ€SQLï¼Œæœ¬è´¨è¿˜æ˜¯SQLè¯­å¥ï¼Œåªæ˜¯æˆ‘ä»¬å¯ä»¥å†SQLå±‚é¢å»æ‰§è¡Œä¸€äº›é€»è¾‘ä»£ç </strong></p><p>if </p><p>where set  choose  when</p><h3 id="SQLç‰‡æ®µ"><a href="#SQLç‰‡æ®µ" class="headerlink" title="SQLç‰‡æ®µ"></a>SQLç‰‡æ®µ</h3><p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè®²ä¸€äº›åŠŸèƒ½çš„éƒ¨åˆ†æŠ½å–å‡ºæ¥ï¼Œæ–¹ä¾¿å¤ç”¨</p><ol><li>ä½¿ç”¨SQLæ ‡ç­¾æŠ½å–çš„å…¬å…±éƒ¨åˆ†</li></ol><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"if-title-author"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">        title = #{title}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">        and author = #{author}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><ol start="2"><li>åœ¨éœ€è¦ä½¿ç”¨çš„åœ°æ–¹ä½¿ç”¨includeæ ‡ç­¾å¼•ç”¨å³å¯</li></ol><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogIf"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"if-title-author"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="Foreach"><a href="#Foreach" class="headerlink" title="Foreach"></a>Foreach</h3><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> </span><br><span class="line"><span class="operator">&lt;</span>foreach item<span class="operator">=</span>"id" index<span class="operator">=</span>"index" collection<span class="operator">=</span>"ids"</span><br><span class="line"><span class="keyword">open</span><span class="operator">=</span>"(" separator <span class="operator">=</span> "or"  <span class="keyword">close</span><span class="operator">=</span>")"</span><br><span class="line">#{id}</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span>foreach<span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">or</span> id<span class="operator">=</span><span class="number">2</span> <span class="keyword">or</span> id <span class="operator">=</span><span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210717161103126.png" alt="image-20210717161103126"></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogForeach"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"ids"</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">open</span>=<span class="string">"and ("</span> <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">"or"</span>&gt;</span></span><br><span class="line">            id = #{id}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p> <strong>åŠ¨æ€SQLå°±æ˜¯åœ¨æ‹¼æ¥SQLè¯­å¥ï¼Œæˆ‘ä»¬åªè¦ä¿è¯SQLçš„æ­£ç¡®æ€§ï¼ŒæŒ‰ç…§SQLçš„æ ¼å¼ï¼Œå»æ’åˆ—ç»„åˆå°±å¯ä»¥äº†</strong></p><p>å»ºè®®</p><ul><li>å…ˆåœ¨Mysqlä¸­å†™å‡ºå®Œæ•´çš„SQLï¼Œåœ¨å¯¹åº”çš„å»ä¿®æ”¹æˆä¸ºæˆ‘ä»¬çš„åŠ¨æ€SQLå®ç°é€šç”¨</li></ul><h2 id="12ã€ç¼“å­˜"><a href="#12ã€ç¼“å­˜" class="headerlink" title="12ã€ç¼“å­˜"></a>12ã€ç¼“å­˜</h2><h3 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h3><figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">æŸ¥è¯¢ ï¼šé“¾æ¥æ•°æ®åº“ ï¼Œè€—èµ„æº</span><br><span class="line">ä¸€æ¬¡æŸ¥è¯¢çš„ç»“æœï¼Œç»™ä»–æš‚å­˜ä¸€ä¸ªå¯ä»¥ç›´æ¥å–åˆ°çš„åœ°æ–¹ï¼--&gt;å†…å­˜ ï¼šç¼“å­˜</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢ç›¸åŒçš„æ•°æ®çš„æ—¶å€™ï¼Œç›´æ¥èµ°ç¼“å­˜ï¼Œå°±ä¸ç”¨èµ°æ•°æ®åº“äº†</span><br></pre></td></tr></tbody></table></figure><ol><li>ä»€ä¹ˆæ˜¯ç¼“å­˜[ Cache ]?<ul><li>å­˜åœ¨å†…å­˜ä¸­çš„ä¸´æ—¶æ•°æ®ã€‚</li><li>å°†ç”¨æˆ·ç»å¸¸æŸ¥è¯¢çš„æ•°æ®æ”¾åœ¨ç¼“å­˜(å†…å­˜)ä¸­ï¼Œç”¨æˆ·å»æŸ¥è¯¢æ•°æ®å°±ä¸ç”¨ä»ç£ç›˜ä¸Š(å…³ç³»å‹æ•°æ®åº“æ•°æ®æ–‡ä»¶)æŸ¥è¯¢ï¼Œä»ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡,è§£å†³äº†é«˜å¹¶å‘ç³»ç»Ÿçš„æ€§èƒ½é—®é¢˜ã€‚</li></ul></li><li>ä¸ºä»€ä¹ˆä½¿ç”¨ç¼“å­˜?<ul><li>å‡å°‘å’Œæ•°æ®åº“çš„äº¤äº’æ¬¡æ•°,å‡å°‘ç³»ç»Ÿå¼€é”€,æé«˜ç³»ç»Ÿæ•ˆç‡ã€‚</li></ul></li><li>ä»€ä¹ˆæ ·çš„æ•°æ®èƒ½ä½¿ç”¨ç¼“å­˜?<ul><li>ç»å¸¸æŸ¥è¯¢å¹¶ä¸”ä¸ç»å¸¸æ”¹å˜çš„æ•°æ®ã€‚ã€å¯ä»¥ä½¿ç”¨ç¼“å­˜ã€‘</li></ul></li></ol><h3 id="2ã€Mybatisç¼“å­˜"><a href="#2ã€Mybatisç¼“å­˜" class="headerlink" title="2ã€Mybatisç¼“å­˜"></a>2ã€Mybatisç¼“å­˜</h3><ul><li>MyBatisåŒ…å«ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æŸ¥è¯¢ç¼“å­˜ç‰¹æ€§ï¼Œå®ƒå¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®šåˆ¶å’Œé…ç½®ç¼“å­˜ã€‚ç¼“å­˜å¯ä»¥æå¤§çš„æå‡æŸ¥è¯¢æ•ˆ<br>ç‡ã€‚</li><li>MyBatisç³»ç»Ÿä¸­é»˜è®¤å®šä¹‰äº†ä¸¤çº§ç¼“å­˜: <strong>ä¸€çº§ç¼“å­˜</strong>å’Œ<strong>äºŒçº§ç¼“å­˜</strong><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€-çº§ç¼“å­˜å¼€å¯ã€‚ (SqlSessionçº§åˆ«çš„ç¼“å­˜ï¼Œ ä¹Ÿç§°ä¸ºæœ¬åœ°ç¼“å­˜)</li><li>äºŒçº§ç¼“å­˜éœ€è¦æ‰‹åŠ¨å¼€å¯å’Œé…ç½®ï¼Œ ä»–æ˜¯åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ã€‚</li><li>ä¸ºäº†æé«˜æ‰©å±•æ€§, MyBatiså®šä¹‰äº†ç¼“å­˜æ¥å£Cacheã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°Cacheæ¥å£æ¥è‡ªå®šä¹‰äºŒçº§ç¼“å­˜</li></ul></li></ul><h3 id="3ã€ä¸€çº§ç¼“å­˜"><a href="#3ã€ä¸€çº§ç¼“å­˜" class="headerlink" title="3ã€ä¸€çº§ç¼“å­˜"></a>3ã€ä¸€çº§ç¼“å­˜</h3><ul><li>ä¸€çº§ç¼“å­˜ä¹Ÿå«æœ¬åœ°ç¼“å­˜: SqlSession<ul><li>ä¸æ•°æ®åº“åŒä¸€æ¬¡ä¼šè¯æœŸé—´æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼šæ”¾åœ¨æœ¬åœ°ç¼“å­˜ä¸­ã€‚</li><li>ä»¥åå¦‚æœéœ€è¦è·å–ç›¸åŒçš„æ•°æ®ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿ï¼Œæ²¡å¿…é¡»å†å»æŸ¥è¯¢æ•°æ®åº“;</li></ul></li></ul><p>æµ‹è¯•æ­¥éª¤ï¼š</p><ol><li><p>å¼€å¯æ—¥å¿—</p></li><li><p>æµ‹è¯•åœ¨ä¸€ä¸ªSessionä¸­æŸ¥è¯¢ä¸¤æ¬¡ç›¸åŒçš„è®°å½•</p></li><li><p>æŸ¥çœ‹æ—¥å¿—è¾“å‡º</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210717175732648.png" alt="image-20210717175732648"></p></li></ol><p>ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µ</p><ol><li><p>æŸ¥è¯¢ä¸åŒçš„ä¸œè¥¿</p></li><li><p>å¢åˆ æ”¹æ“ä½œï¼Œå¯èƒ½ä¼šæ”¹å˜åŸæ¥çš„æ•°æ®ï¼Œæ‰€ä»¥å¿…å®šä¼šåˆ·æ–°ç¼“å­˜ï¼</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210717180544621.png" alt="image-20210717180544621"></p></li><li><p>æŸ¥è¯¢ä¸åŒçš„Mapper.xml</p></li><li><p>æ‰‹åŠ¨æ¸…ç†ç¼“å­˜ï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> MybatisUtils.getSqlSession();</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line"></span><br><span class="line">    sqlSession.clearCache();<span class="comment">//æ‰‹åŠ¨æ¸…ç†ç¼“å­˜</span></span><br><span class="line">    System.out.println(<span class="string">"========================="</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> mapper.queryUserById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    System.out.println(user==user2);</span><br><span class="line">    sqlSession.close();</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p>å°ç»“ï¼šä¸€çº§ç¼“å­˜é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œåªæœ‰åœ¨ä¸€æ¬¡SqlSessionä¸­æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯æ‹¿åˆ°é“¾æ¥åˆ°å…³é—­è¿æ¥è¿™ä¸ªåŒºé—´æ®µï¼</p><p>ä¸€çº§ç¼“å­˜å°±æ˜¯ä¸€ä¸ªMap</p><h3 id="4ã€-äºŒçº§ç¼“å­˜"><a href="#4ã€-äºŒçº§ç¼“å­˜" class="headerlink" title="4ã€ äºŒçº§ç¼“å­˜"></a>4ã€ äºŒçº§ç¼“å­˜</h3><ul><li>äºŒçº§ç¼“å­˜ä¹Ÿå«å…¨å±€ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜ä½œç”¨åŸŸå¤ªä½äº†ï¼Œæ‰€ä»¥è¯ç”Ÿäº†äºŒçº§ç¼“å­˜</li><li>åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ï¼Œ ä¸€ä¸ªåç§°ç©ºé—´ï¼Œå¯¹åº”ä¸€ ä¸ªäºŒçº§ç¼“å­˜</li><li>å·¥ä½œæœºåˆ¶<ul><li>ä¸ªä¼šè¯æŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®å°±ä¼šè¢«æ”¾åœ¨å½“å‰ä¼šè¯çš„- -çº§ç¼“å­˜ä¸­</li><li>å¦‚æœå½“å‰ä¼šè¯å…³é—­äº†ï¼Œè¿™ä¸ªä¼šè¯å¯¹åº”çš„ä¸€çº§ç¼“å­˜å°±æ²¡äº†;ä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ˜¯ï¼Œä¼šè¯å…³é—­äº†ï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®è¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­</li><li>æ–°çš„ä¼šè¯æŸ¥è¯¢ä¿¡æ¯ï¼Œå°±å¯ä»¥ä»äºŒçº§ç¼“å­˜ä¸­è·å–å†…å®¹;</li><li>ä¸åŒçš„mapperæŸ¥å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜(map)ä¸­</li></ul></li></ul><p>æ­¥éª¤ï¼š</p><ol><li><p>å¼€å¯å…¨å±€ç¼“å­˜</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        æ˜¾ç¤ºçš„å¼€å¯å…¨å±€ç¼“å­˜--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span>xxxxxxxxxx2&nbsp;1<span class="comment">&lt;!-- &nbsp; &nbsp; &nbsp;  æ˜¾ç¤ºçš„å¼€å¯å…¨å±€ç¼“å­˜--&gt;</span>2 &nbsp; &nbsp; &nbsp; &nbsp;<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>å†è¦ä½¿ç”¨deMapperä¸­å¼€å¯</p></li></ol>   <figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        åœ¨å½“å‰xmlä¸­ä½¿ç”¨ç¼“å­˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>   ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å‚æ•°</p>   <figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">"FIFO"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">flushInterval</span>=<span class="string">"60000"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">size</span>=<span class="string">"512"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">readOnly</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><ol start="3"><li><p>æµ‹è¯•</p></li><li><p>é—®é¢˜ï¼šæˆ‘ä»¬éœ€è¦å°†å®ä½“ç±»åºåˆ—åŒ–ï¼å¦åˆ™å°±ä¼šæŠ¥é”™ï¼</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Caused by: java. io. NotSerializableExcepti on:com.miaobuyi.pojo.user</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> {</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li></ol><p>å°ç»“ï¼š</p><ul><li>åªè¦å¼€å¯äº†äºŒçº§ç¼“å­˜ï¼Œåœ¨åŒä¸€ä¸ªMapperä¸‹å°±æœ‰æ•ˆ</li><li>æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šå…ˆæ”¾åœ¨ä¸€çº§ç¼“å­˜ä¸­</li><li>åªæœ‰å½“å›è¯æäº¤æˆ–è€…å…³é—­çš„æ—¶å€™ï¼Œæ‰ä¼šæäº¤åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼</li></ul><h3 id="5ã€ç¼“å­˜åŸç†"><a href="#5ã€ç¼“å­˜åŸç†" class="headerlink" title="5ã€ç¼“å­˜åŸç†"></a>5ã€ç¼“å­˜åŸç†</h3><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210717191347109.png" alt="image-20210717191347109"></p><h3 id="6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache"><a href="#6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache" class="headerlink" title="6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache"></a>6ã€è‡ªå®šä¹‰ç¼“å­˜-ehcache</h3><p>Redisæ•°æ®åº“æ¥åšç¼“å­˜ï¼ K-V</p>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼</title>
      <link href="/2021/09/21/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2021/09/21/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><blockquote><p>é¥¿æ±‰å¼å•ä¾‹</p></blockquote><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//é¥¿æ±‰å¼å•ä¾‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hungry</span> {</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯èƒ½ä¼šæµªè´¹ç©ºé—´</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] datal = <span class="keyword">new</span> <span class="title class_">byte</span> [<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] data2 = <span class="keyword">new</span> <span class="title class_">by</span> mte [<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] data3 = <span class="keyword">new</span> <span class="title class_">byte</span> [<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="type">byte</span>[] data4 = <span class="keyword">new</span> <span class="title class_">byte</span> [<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Hungry</span><span class="params">()</span>{</span><br><span class="line">        </span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> fina1 <span class="keyword">static</span> <span class="type">Hungry</span> <span class="variable">HUNGRY</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hungry</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Hungry <span class="title function_">getInstance</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> HUNGRY;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>DCLæ‡’æ±‰å¼</p></blockquote><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//æ‡’æ±‰å¼å•ä¾‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazyMan</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">qinjiang</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span> <span class="title function_">LazyMan</span><span class="params">()</span>{</span><br><span class="line"><span class="keyword">synchronized</span> (LazyMan. class){</span><br><span class="line">            <span class="keyword">if</span> (qinjiang == <span class="literal">false</span>){</span><br><span class="line">            qinjiang = <span class="literal">true</span>;</span><br><span class="line">            }<span class="keyword">else</span> {|</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">"ä¸ è¦è¯•å›¾ä½¿ç”¨åå°„ç ´åå¼‚å¸¸"</span>);</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">        </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> LazyMan LazyMan;</span><br><span class="line"><span class="comment">//åŒé‡æ£€æµ‹é”æ¨¡å¼çš„æ‡’æ±‰å¼å•ä¾‹DCL æ‡’æ±‰å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> LazyMan <span class="title function_">getInstance</span><span class="params">( )</span>{</span><br><span class="line"><span class="keyword">if</span> (LazyMan==nu1l){</span><br><span class="line"><span class="keyword">synchronized</span> (LazyMan. class){</span><br><span class="line"><span class="keyword">if</span> (LazyMan==nu1l){</span><br><span class="line">lazyMan = <span class="keyword">new</span> <span class="title class_">LazyMan</span>(); <span class="comment">//ä¸æ˜¯ä¸€ä¸ªåŸå­æ€§æ“ä½œ</span></span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> LazyMan;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//åå°„!</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line"><span class="type">LazyMan</span> <span class="variable">instance</span> <span class="operator">=</span> LazyMan.getInstance();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">qinjiang</span> <span class="operator">=</span> LazyMan.class.getDeclaredField( name: <span class="string">"qinjiang"</span>);</span><br><span class="line">        qinjiang. setAccessible(<span class="literal">true</span>);</span><br><span class="line">        Constructor&lt;LazyMan&gt; declaredConstructor = LazyMan. class. getDeclaredConstructor(<span class="literal">null</span>)</span><br><span class="line">        declaredConstructor . setAccessible(<span class="literal">true</span>);</span><br><span class="line">        LazyManÏ„ instance = declaredConstructor.newInstance();</span><br><span class="line">        qinjiang. set(instance,<span class="literal">false</span>);</span><br><span class="line">        <span class="type">LazyMan</span> <span class="variable">instance2</span> <span class="operator">=</span> declaredConstructor.newInstance();</span><br><span class="line">        System.out.print1n(instance);</span><br><span class="line">        System.out.print1n(instance2);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>é™æ€å†…éƒ¨ç±»</p></blockquote><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">    <span class="comment">// é™æ€å†…éƒ¨ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Holder</span> {</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Holder</span><span class="params">()</span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    pub1ic <span class="keyword">static</span> Holder <span class="title function_">getInstace</span><span class="params">()</span>{</span><br><span class="line">        <span class="keyword">return</span> InnerClass. HOLDER;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    pub1ic <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">InnerClass</span>{</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Holder</span> <span class="variable">HOLDER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Holder</span>();</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><blockquote><p>å•ä¾‹ä¸å®‰å…¨ï¼Œåå°„</p></blockquote><blockquote><p>æšä¸¾</p></blockquote><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="comment">//enumæ˜¯ä¸€ä¸ªä»€ä¹ˆ?æœ¬èº«ä¹Ÿæ˜¯ ä¸€ä¸ªCLassç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">EnumSingle</span> {</span><br><span class="line">    INSTANCE;</span><br><span class="line">    <span class="keyword">public</span> EnumSingle <span class="title function_">getInstance</span><span class="params">()</span>{</span><br><span class="line">    <span class="keyword">return</span> INS TANCE ;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Test</span>{</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception{</span><br><span class="line">        <span class="type">EnumSingle</span> <span class="variable">instance1</span> <span class="operator">=</span> EnumSingle.INSTANCE;</span><br><span class="line">        Constructor&lt;EnumSingle&gt; declaredConstructor = EnumSingle.class.getDeclaredConstructor(String.class,<span class="type">int</span>.class)</span><br><span class="line">        declaredConstructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">EnumSingle</span> <span class="variable">instance2</span> <span class="operator">=</span> declaredConstructor . newInstance();</span><br><span class="line">        <span class="comment">// NoSuchMethodException: com. kuang. single. EnumSingle. &lt;init&gt;()</span></span><br><span class="line">        System.out.println( instance1);</span><br><span class="line">        System.out.println( instance2);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>æšä¸¾çš„æœ€ç»ˆåç¼–è¯‘</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">pub1ic <span class="keyword">static</span> Enumsing1e[] values(){</span><br><span class="line">    <span class="keyword">return</span> (EnumSingle[]) $VALUES. clone();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> EnumSingle <span class="title function_">valueOf</span> <span class="params">(String name)</span>{</span><br><span class="line">    <span class="keyword">return</span> (EnumS ing1e)Enum. valueOf (com/kuang/s ing1e/Enumsingle, name);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">private</span> <span class="title function_">Enumsingle</span><span class="params">(String Sï¼Œ<span class="type">int</span> i)</span>{</span><br><span class="line">    <span class="built_in">super</span>(sï¼Œi);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> EnumSingle <span class="title function_">getInstance</span><span class="params">()</span>{</span><br><span class="line">    <span class="keyword">return</span> INSTANCE;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> EnumSingle INSTANCE;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> EnumSingle $VALUES[];</span><br><span class="line"><span class="keyword">static</span>{</span><br><span class="line">    INSTANCE = <span class="keyword">new</span> <span class="title class_">EnumSingle</span>(<span class="string">"INSTANCE"</span>ï¼Œ<span class="number">0</span>);</span><br><span class="line">    $VALUES = (<span class="keyword">new</span> <span class="title class_">EnumSing1e</span>[] {</span><br><span class="line">        INSTANCE</span><br><span class="line">    });</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å•ä¾‹æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring</title>
      <link href="/2021/09/21/Spring/"/>
      <url>/2021/09/21/Spring/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2 id="1ã€Spring"><a href="#1ã€Spring" class="headerlink" title="1ã€Spring"></a>1ã€Spring</h2><h3 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h3><ul><li><p>2002 ï¼Œé¦–æ¬¡æ¨å‡ºäº†Springæ¡†æ¶çš„é›å½¢ï¼š<strong>interface21</strong>æ¡†æ¶</p></li><li><p>2004-3-24æ­£å¼å‘å¸ƒ1.0ç‰ˆæœ¬ï¼ŒSpringæ¡†æ¶ä»¥interface21æ¡†æ¶ä¸ºåŸºç¡€ï¼Œç»è¿‡é‡æ–°è®¾è®¡ï¼Œå¹¶ä¸å¯¹ä¸°å¯Œå…¶å†…æ¶µ</p></li><li><p>Rod Johnsonï¼ŒSpringæ¡†æ¶çš„åˆ›å§‹äºº</p></li><li><p>springçš„ç†å¿µï¼šä½¿ç°æœ‰çš„æŠ€æœ¯æ›´åŠ å®¹æ˜“ä½¿ç”¨ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ï¼Œæ•´åˆäº†ç°æœ‰çš„æŠ€æœ¯æ¡†æ¶</p></li><li><p>SSH ï¼š Struct + Spring + Hibernateï¼</p></li><li><p>SSM ï¼š SpringMVC + Spring + Mybatisï¼</p></li></ul><p>maven</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="2-ä¼˜ç‚¹"><a href="#2-ä¼˜ç‚¹" class="headerlink" title="2.ä¼˜ç‚¹"></a>2.ä¼˜ç‚¹</h3><ul><li>Springæ˜¯ä¸€ä¸ªå¼€æºçš„å…è´¹çš„æ¡†æ¶ï¼ˆå®¹å™¨ï¼‰ï¼</li><li>Springæ˜¯ä¸€ä¸ªè½»é‡çº§ï¼Œéå…¥ä¾µå¼çš„å®¹å™¨ï¼</li><li>æ§åˆ¶ç¿»è½¬ï¼ˆIOCï¼‰ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰</li><li>æ”¯æŒäº‹åŠ¡çš„å¤„ç†ï¼Œå¯¹æ¡†æ¶æ•´åˆçš„æ”¯æŒ</li></ul><p>æ€»ç»“ä¸€å¥è¯ï¼šSpringå°±æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬ï¼ˆIOC)å’Œé¢å‘åˆ‡é¢(AOP)çš„æ¡†æ¶</p><h3 id="3ã€ç»„æˆ"><a href="#3ã€ç»„æˆ" class="headerlink" title="3ã€ç»„æˆ"></a>3ã€ç»„æˆ</h3><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210719152443040.png" alt="image-20210719152443040"></p><h3 id="4ã€æ‹“å±•"><a href="#4ã€æ‹“å±•" class="headerlink" title="4ã€æ‹“å±•"></a>4ã€æ‹“å±•</h3><p>åœ¨Springçš„å®˜ç½‘æœ‰è¿™ä¸ªä»‹ç»ï¼šç°ä»£åŒ–çš„javaå¼€å‘ï¼è¯´ç™½äº†å°±æ˜¯åŸºäºSpringå¼€å‘</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210719152719225.png" alt="image-20210719152719225"></p><ul><li>Srping Boot<ul><li>ä¸€ä¸ªå¿«é€Ÿå¼€å‘çš„è„šæ‰‹æ¶</li><li>åŸºäºSpringBootå¯ä»¥å¿«é€Ÿçš„å¼€å‘å•ä¸ªå¾®æœåŠ¡</li><li>çº¦å®šå¤§äºé…ç½®ï¼</li></ul></li><li>Spring Cloud<ul><li>SpringCloudæ˜¯åŸºäºSpringBootå®ç°çš„ã€‚</li></ul></li></ul><p>å› ä¸ºç°åœ¨å¤§å¤šæ•°å…¬å¸éƒ½åœ¨ä½¿ç”¨SpringBootè¿›è¡Œå¿«é€Ÿå¼€å‘ï¼Œå­¦ä¹ SpringBootçš„å‰æï¼Œéœ€è¦å®Œå…¨æŒæ¡Srpingå’ŒSpringMVC</p><p><strong>å¼Šç«¯ï¼šå‘å±•äº†å¤ªä¹…ä¹‹åï¼Œè¿èƒŒäº†åŸæ¥çš„ç†å¿µï¼é…ç½®ååˆ†ç¹çï¼Œäººç§°â€œé…ç½®åœ°ç‹±ï¼â€</strong></p><h2 id="2ã€IOCç†è®ºæ¨å¯¼"><a href="#2ã€IOCç†è®ºæ¨å¯¼" class="headerlink" title="2ã€IOCç†è®ºæ¨å¯¼"></a>2ã€IOCç†è®ºæ¨å¯¼</h2><ol><li>UserDaoæ¥å£</li><li>UserDaoImplå®ç°ç±»</li><li>USerServiceä¸šåŠ¡æ¥å£</li><li>UserServiceUmplä¸šåŠ¡å®ç°ç±»</li></ol><p>åœ¨æˆ‘ä»¬ä¹‹å‰çš„ä¸šåŠ¡ä¸­ï¼Œç”¨æˆ·çš„éœ€æ±‚å¯èƒ½ä¼šå½±å“æˆ‘ä»¬åŸæ¥çš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚å»ä¿®æ”¹æºä»£ç ï¼å¦‚æœç¨‹åºä»£ç é‡ååˆ†å¤§ï¼Œä¿®æ”¹ä¸€æ¬¡çš„ä»£ç ä»£ä»·ååˆ†æ˜‚è´µï¼</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210719165232920.png" alt="image-20210719165232920"></p><p>æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªSetæ¥å£å®ç°</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">UserMapper</span> <span class="variable">userMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserMapperImpl</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ©ç”¨setè¿›è¡ŒåŠ¨æ€å®ç°å€¼å¾—æ³¨å…¥</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserMapper</span><span class="params">(UserMapper userMapper)</span> {</span><br><span class="line">    <span class="built_in">this</span>.userMapper = userMapper; </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>ä¹‹å‰ï¼Œç¨‹åºæ˜¯ä¸»åŠ¨åˆ›å»ºå¯¹è±¡ï¼æ§åˆ¶æƒåœ¨ç¨‹åºçŒ¿æ‰‹ä¸Š</li><li>ä½¿ç”¨setæ³¨å…¥åï¼Œç¨‹åºä¸åœ¨å…·æœ‰ä¸»åŠ¨æ€§ï¼Œè€Œæ˜¯å˜æˆäº†è¢«åŠ¨çš„æ¥å—å¯¹è±¡</li></ul><p>è¿™ç§æ€æƒ³ï¼Œä»æœ¬è´¨ä¸Šè§£å†³äº†é—®é¢˜ï¼Œæˆ‘ä»¬ç¨‹åºçŒ¿ä¸å†å»ç®¡ç†å¯¹è±¡çš„åˆ›å»ºã€‚ç³»ç»Ÿçš„è€¦åˆæ€§å¤§å¤§å‡ä½ï¼Œå¯ä»¥æ›´åŠ ä¸“æ³¨åœ°åœ¨ä¸šåŠ¡çš„å®ç°ä¸Šï¼è¿™æ˜¯IOCçš„åŸå‹ï¼ </p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210719165243411.png" alt="image-20210719165243411"></p><h3 id="IOCæœ¬è´¨"><a href="#IOCæœ¬è´¨" class="headerlink" title="IOCæœ¬è´¨"></a>IOCæœ¬è´¨</h3><p><strong>æ§åˆ¶åè½¬loC(Inversion of Control),æ˜¯-ç§è®¾è®¡æ€æƒ³ï¼ŒDI(ä¾èµ–æ³¨å…¥)æ˜¯å®ç°IoCçš„ä¸€ç§æ–¹æ³•</strong>ï¼Œä¹Ÿæœ‰äººè®¤ä¸ºDIåªæ˜¯IoCçš„å¦ä¸€ç§è¯´æ³•ã€‚ æ²¡æœ‰IoCçš„ç¨‹åºä¸­,æˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹,å¯¹è±¡çš„åˆ›å»ºä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ï¼Œæ§åˆ¶åè½¬åå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸ªäººè®¤ä¸ºæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯:è·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†ã€‚</p><p>é‡‡ç”¨XMLæ–¹å¼é…ç½®Beançš„æ—¶å€™ï¼ŒBeançš„å®š ä¹‰ä¿¡æ¯æ˜¯å’Œå®ç°åˆ†ç¦»çš„ï¼Œè€Œé‡‡ç”¨æ³¨è§£çš„æ–¹å¼å¯ä»¥æŠŠä¸¤è€…åˆä¸ºä¸€ä½“,Beançš„å®šä¹‰ä¿¡æ¯ç›´æ¥ä»¥æ³¨è§£çš„å½¢å¼å®šä¹‰åœ¨å®ç°ç±»ä¸­ï¼Œä»è€Œè¾¾åˆ°äº†é›¶é…ç½®çš„ç›®çš„ã€‚</p><p><strong>æ§åˆ¶åè½¬æ˜¯ä¸€ç§é€šè¿‡æè¿°(XMLæˆ–æ³¨è§£) å¹¶é€šè¿‡ç¬¬ä¸‰æ–¹å»ç”Ÿäº§æˆ–è·å–ç‰¹å®šå¯¹è±¡çš„æ–¹å¼ã€‚åœ¨Springä¸­å®ç°æ§åˆ¶åè½¬çš„æ˜¯IoCå®¹å™¨ï¼Œå…¶å®ç°æ–¹æ³•æ˜¯ä¾èµ–æ³¨å…¥(Dependency Injection,DI)ã€‚</strong></p><p><strong>IOCå®é™…ä¸Šæ˜¯å¯¹è±¡ç”±springåˆ›å»ºï¼Œç®¡ç†ï¼Œè£…é…</strong></p><h2 id="3ã€HelloSpring"><a href="#3ã€HelloSpring" class="headerlink" title="3ã€HelloSpring"></a>3ã€HelloSpring</h2><h3 id="1-å¯¼å…¥Springç›¸å…³çš„JaråŒ…"><a href="#1-å¯¼å…¥Springç›¸å…³çš„JaråŒ…" class="headerlink" title="1.å¯¼å…¥Springç›¸å…³çš„JaråŒ…"></a>1.å¯¼å…¥Springç›¸å…³çš„JaråŒ…</h3><p>æ³¨ï¼šSpringéœ€è¦å¯¼å…¥commons-loggingè¿›è¡Œæ—¥å¿—è®°å½•ï¼Œæˆ‘ä»¬åˆ©ç”¨mavenï¼Œå®ƒä¼šè‡ªåŠ¨ä¸‹è½½å¯¹åº”çš„ä¾èµ–é¡¹</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="2ã€ç¼–å†™ç›¸å…³ä»£ç "><a href="#2ã€ç¼–å†™ç›¸å…³ä»£ç " class="headerlink" title="2ã€ç¼–å†™ç›¸å…³ä»£ç "></a>2ã€ç¼–å†™ç›¸å…³ä»£ç </h3><ol><li>ç¼–å†™ä¸€ä¸ªHelloå®ä½“ç±»</li></ol><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hello</span> {</span><br><span class="line">    <span class="keyword">private</span> String str;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getStr</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStr</span><span class="params">(String str)</span> {</span><br><span class="line">        <span class="built_in">this</span>.str = str;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello{"</span> +</span><br><span class="line">                <span class="string">"str='"</span> + str + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'}'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ol start="2"><li><p>åœ¨xmlä¸­æ³¨å†Œ</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    ä½¿ç”¨Springæ¥åˆ›å»ºå¯¹æ´—é‚£ä¸ªï¼Œåœ¨Springè¿™äº›éƒ½æˆä¸ºBean</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        ç±»å‹ å˜é‡å = new ç±»å‹();</span></span><br><span class="line"><span class="comment">        Hello hello = new Hello();</span></span><br><span class="line"><span class="comment">        bean = å¯¹è±¡    new Hello();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        id = å˜é‡å</span></span><br><span class="line"><span class="comment">        class = new çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">        property ç›¸å½“äºç»™å¯¹è±¡ä¸­çš„å±æ€§è®¾ç½®ä¸€ä¸ªå€¼</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Hello"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"str"</span> <span class="attr">value</span>=<span class="string">"Spring"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>æµ‹è¯•ç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–Springçš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="comment">//æˆ‘ä»¬çš„å¯¹è±¡éƒ½åœ¨Springä¸­ç®¡ç†äº†ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ï¼Œç›´æ¥å»é‡Œé¢å–å‡ºæ¥å°±å¯ä»¥äº†ï¼</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">hello</span> <span class="operator">=</span> context.getBean(<span class="string">"hello"</span>);</span><br><span class="line">        System.out.println(hello.toString());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p>æ€è€ƒé—®é¢˜?</p><ul><li>Helloå¯¹è±¡æ˜¯è°åˆ›å»ºçš„?<ul><li>helloå¯¹è±¡æ˜¯ç”±Springåˆ›å»ºçš„</li></ul></li><li>Hello å¯¹è±¡çš„å±æ€§æ˜¯æ€ä¹ˆè®¾ç½®çš„?<ul><li>helloå¯¹è±¡çš„å±æ€§æ˜¯ç”±Springå®¹å™¨è®¾ç½®çš„ï¼Œ</li></ul></li></ul><p>è¿™ä¸ªè¿‡ç¨‹å°±å«æ§åˆ¶åè½¬ :</p><p>æ§åˆ¶ï¼šè°æ¥æ§åˆ¶å¯¹è±¡çš„åˆ›å»º,ä¼ ç»Ÿåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ˜¯ç”±ç¨‹åºæœ¬èº«æ§åˆ¶åˆ›å»ºçš„,ä½¿ç”¨Springå,å¯¹è±¡æ˜¯ç”±Springæ¥åˆ›å»ºçš„.<br>åè½¬ï¼šç¨‹åºæœ¬èº«ä¸åˆ›å»ºå¯¹è±¡,è€Œå˜æˆè¢«åŠ¨çš„æ¥æ”¶å¯¹è±¡.<br>Iä¾èµ–æ³¨å…¥ï¼šå°±æ˜¯åˆ©ç”¨setæ–¹æ³•æ¥è¿›è¡Œæ³¨å…¥çš„.<br>IOCæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³,ç”±ä¸»åŠ¨çš„ç¼–ç¨‹å˜æˆè¢«åŠ¨çš„æ¥æ”¶.<br>å¯ä»¥é€šè¿‡newClassPathXmlApplicationContextå»æµè§ˆä¸€ä¸‹åº•å±‚æºç  .<br><strong>OK,åˆ°äº†ç°åœ¨,æˆ‘ä»¬å½»åº•ä¸ç”¨å†ç¨‹åºä¸­å»æ”¹åŠ¨äº†,è¦å®ç°ä¸åŒçš„æ“ä½œ,åªéœ€è¦åœ¨xmlé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹,æ‰€è°“çš„loC,ä¸€å¥è¯æå®š:å¯¹è±¡ç”±Springæ¥åˆ›å»º,ç®¡ç†,è£…é…!</strong></p><h2 id="4ã€IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"><a href="#4ã€IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼" class="headerlink" title="4ã€IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"></a>4ã€IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h2><ol><li><p>ä½¿ç”¨æ— å‚æ„é€ åˆ›å»ºå¯¹è±¡ï¼Œé»˜è®¤</p></li><li><p>å‡è®¾æˆ‘ä»¬è¦ä½¿ç”¨æœ‰å‚æ„é€ åˆ›å»ºå¯¹è±¡</p><ol><li><p>ä¸‹æ ‡èµ‹å€¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"å–µä¸æ˜“å­¦java"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>ç±»å‹</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"miaobuyi"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>å‚æ•°å</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å–µä¸æ˜“"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li></ol></li></ol><p>æ€»ç»“ï¼šåœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ï¼Œå®¹å™¨ä¸­ç®¡ç†çš„å¯¹è±¡å°±å·²ç»åˆå§‹åŒ–äº†</p><h2 id="5ã€Springé…ç½®"><a href="#5ã€Springé…ç½®" class="headerlink" title="5ã€Springé…ç½®"></a>5ã€Springé…ç½®</h2><h3 id="1ã€åˆ«å"><a href="#1ã€åˆ«å" class="headerlink" title="1ã€åˆ«å"></a>1ã€åˆ«å</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--    åˆ«åï¼Œå¦‚æœæ·»åŠ äº†åˆ«åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«åè·å–åˆ°è¿™ä¸ªå¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">alias</span>=<span class="string">"usernew"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="2ã€Beançš„é…ç½®"><a href="#2ã€Beançš„é…ç½®" class="headerlink" title="2ã€Beançš„é…ç½®"></a>2ã€Beançš„é…ç½®</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    idï¼šbeançš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæˆ‘ä»¬å­¦çš„å¯¹è±¡å</span></span><br><span class="line"><span class="comment">    classï¼šbeanå¯¹é€‰å“ªä¸ªæ‰€å¯¹åº”çš„å…¨é™å®šåï¼šåŒ…å+ç±»å‹</span></span><br><span class="line"><span class="comment">    nameï¼šä¹Ÿæ˜¯åˆ«åï¼Œè€Œä¸”nameæ›´é«˜çº§ å¯ä»¥åŒæ—¶å–å¤šä¸ªåˆ«å</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span> <span class="attr">name</span>=<span class="string">"userNew,u2"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å–µä¸æ˜“"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="3ã€import"><a href="#3ã€import" class="headerlink" title="3ã€import"></a>3ã€import</h3><p>è¿™ä¸ªimportï¼Œä¸€èˆ¬ç”¨äºå›¢é˜Ÿå¼€å‘ä½¿ç”¨ï¼Œä»–å¯ä»¥å°†å¤šä¸ªé…ç½®æ–‡ä»¶å¯¼å…¥åˆå¹¶ä¸ºä¸€ä¸ª</p><p>å‡è®¾ï¼Œç°åœ¨é¡¹ç›®ä¸­æœ‰å¤šä¸ªäººå¼€å‘ï¼Œè¿™ä¸‰ä¸ªäººè´Ÿè´£ä¸åŒçš„ç±»å¼€å‘ï¼Œä¸åŒçš„ç±»éœ€è¦æ³¨å†Œåœ¨ä¸åŒçš„beanä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨importå°†æ‰€æœ‰äººbeans.xmlåˆå¹¶ä¸ºä¸€ä¸ªæ€»çš„ï¼</p><ul><li><p>å¼ ä¸‰</p></li><li><p>æå››</p></li><li><p>ç‹äº”</p></li><li><p>applicationContext.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"beans.xml"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></li></ul><p>ä½¿ç”¨çš„æ—¶å€™ç›´æ¥ä½¿ç”¨æ€»çš„é…ç½®å°±å¯ä»¥äº†</p><h2 id="6ã€DIä¾èµ–æ³¨å…¥"><a href="#6ã€DIä¾èµ–æ³¨å…¥" class="headerlink" title="6ã€DIä¾èµ–æ³¨å…¥"></a>6ã€DIä¾èµ–æ³¨å…¥</h2><h3 id="1ã€æ„é€ å™¨æ³¨å…¥"><a href="#1ã€æ„é€ å™¨æ³¨å…¥" class="headerlink" title="1ã€æ„é€ å™¨æ³¨å…¥"></a>1ã€æ„é€ å™¨æ³¨å…¥</h3><p> å‰é¢æœ‰</p><h3 id="2ã€Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹-ã€‘"><a href="#2ã€Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹-ã€‘" class="headerlink" title="2ã€Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ ã€‘"></a>2ã€Setæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ ã€‘</h3><ul><li>ä¾èµ–æ³¨å…¥ï¼šSetæ³¨å…¥<ul><li>ä¾èµ–ï¼šbeanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ï¼</li><li>æ³¨å…¥ï¼šbeanå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œç”±å®¹å™¨æ³¨å…¥</li></ul></li></ul><p>ã€ç¯å¢ƒæ­å»ºã€‘</p><ol><li><p>å¤æ‚ç±»å‹</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span> {</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> {</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>çœŸå®æµ‹è¯•å¯¹è±¡</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> {</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Address address ;</span><br><span class="line">    <span class="keyword">private</span> String[] books ;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hobbys;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; card;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; games;</span><br><span class="line">    <span class="keyword">private</span> String wife;</span><br><span class="line">    <span class="keyword">private</span> Properties info;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>beans.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Student"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         ç¬¬ä¸€ç§ï¼Œæ™®é€šå€¼æ³¨å…¥ value--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å–µä¸æ˜“"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>æµ‹è¯•ç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.Student;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">"beans.xml"</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> (Student) context.getBean(<span class="string">"student"</span>);</span><br><span class="line">        System.out.println(student);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p>å®Œå–„æ³¨å…¥ä¿¡æ¯</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"address"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Address"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">value</span>=<span class="string">"æˆéƒ½"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Student"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         ç¬¬ä¸€ç§ï¼Œæ™®é€šå€¼æ³¨å…¥ value--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å–µä¸æ˜“"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        ç¬¬äºŒç§ï¼ŒBeanæ³¨å…¥ ref--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">ref</span>=<span class="string">"address"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æ•°ç»„æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"books"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>çº¢æ¥¼æ¢¦<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>è¥¿æ¸¸è®°<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ°´æµ’ä¼ <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ä¸‰å›½æ¼”ä¹‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Listæ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hobbys"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¬æ­Œ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ•²ä»£ç <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>çœ‹ç”µå½±<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Mapæ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"çœä»½è¯"</span> <span class="attr">value</span>=<span class="string">"1321321321"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"é“¶è¡Œå¡"</span> <span class="attr">value</span>=<span class="string">"64654654"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Setæ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"games"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>LOL<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>COC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>BOB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Nullæ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"wife"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">null</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Propertiesæ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"å­¦å·"</span>&gt;</span>15846532<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"æ€§åˆ«"</span>&gt;</span>ç”·<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"å§“å"</span>&gt;</span>å¼ ä¸‰<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="3ã€æ‹“å±•æ–¹å¼æ³¨å…¥"><a href="#3ã€æ‹“å±•æ–¹å¼æ³¨å…¥" class="headerlink" title="3ã€æ‹“å±•æ–¹å¼æ³¨å…¥"></a>3ã€æ‹“å±•æ–¹å¼æ³¨å…¥</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨på‘½åç©ºé—´å’Œcå‘½åç©ºé—´è¿›è¡Œæ³¨å…¥</p><p>å®˜æ–¹è§£é‡Šï¼š</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210720195043436.png" alt="image-20210720195043436"></p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">"http://www.springframework.org/schema/p"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:c</span>=<span class="string">"http://www.springframework.org/schema/c"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--på‘½åç©ºé—´æ³¨å…¥ï¼Œå¯ä»¥ç›´æ¥æ³¨å…¥å±æ€§çš„å€¼ï¼šproperties--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span> <span class="attr">p:name</span>=<span class="string">"å–µä¸æ˜“"</span> <span class="attr">p:age</span>=<span class="string">"18"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--cå‘½åç©ºé—´æ³¨å…¥ï¼Œå¯ä»¥ç›´æ¥æ³¨å…¥å±æ€§çš„å€¼ï¼šconstruct--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span> <span class="attr">c:age</span>=<span class="string">"18"</span> <span class="attr">c:name</span>=<span class="string">"å–µä¸æ˜“"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>{</span><br><span class="line">    <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">"userbeans.xml"</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> context.getBean(<span class="string">"user2"</span>, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æ³¨æ„ç‚¹ï¼špå‘½åå’Œcå‘½åä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å¯¼å…¥xmlçº¦æŸ </p><h3 id="4ã€Beançš„ä½œç”¨åŸŸ"><a href="#4ã€Beançš„ä½œç”¨åŸŸ" class="headerlink" title="4ã€Beançš„ä½œç”¨åŸŸ"></a>4ã€Beançš„ä½œç”¨åŸŸ</h3><p> <img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210720205700969.png" alt="image-20210720205700969"></p><ol><li><p>å•ä¾‹æ¨¡å¼ï¼ˆSpringé»˜è®¤æœºåˆ¶ï¼‰</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span> <span class="attr">c:age</span>=<span class="string">"18"</span> <span class="attr">c:name</span>=<span class="string">"å–µä¸æ˜“"</span> <span class="attr">scope</span>=<span class="string">"singleton"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>åŸå‹æ¨¡å¼ï¼šæ¯æ¬¡ä»å®¹å™¨ä¸­getçš„æ—¶å€™ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°å¯¹è±¡ï¼</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.User"</span> <span class="attr">c:age</span>=<span class="string">"18"</span> <span class="attr">c:name</span>=<span class="string">"å–µä¸æ˜“"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>å…¶ä½™çš„ requestã€sessionã€applicationè¿™äº›åªèƒ½åœ¨webå¼€æ”¾ä¸­ä½¿ç”¨</p></li></ol><h2 id="7ã€Beançš„è‡ªåŠ¨è£…é…"><a href="#7ã€Beançš„è‡ªåŠ¨è£…é…" class="headerlink" title="7ã€Beançš„è‡ªåŠ¨è£…é…"></a>7ã€Beançš„è‡ªåŠ¨è£…é…</h2><ul><li>è‡ªåŠ¨è£…é…æ˜¯Springæ»¡è¶³Beanä¾èµ–çš„ä¸€ç§æ–¹å¼ï¼</li><li>Springä¼šåœ¨ä¸Šä¸‹æ–‡ä¸­è‡ªåŠ¨å¯»æ‰¾ï¼Œå¹¶è‡ªåŠ¨ç»™beanè£…é…å±æ€§ï¼</li></ul><p>åœ¨Springä¸­æœ‰ä¸‰ç§è£…é…çš„æ–¹å¼</p><ol><li>åœ¨xmlä¸­æ˜¾ç¤ºçš„é…ç½®</li><li>åœ¨Javaä¸­æ˜¾ç¤ºé…ç½®</li><li>éšå¼çš„è‡ªåŠ¨è£…é…beanã€é‡è¦ã€‘</li></ol><h3 id="1ã€æµ‹è¯•"><a href="#1ã€æµ‹è¯•" class="headerlink" title="1ã€æµ‹è¯•"></a>1ã€æµ‹è¯•</h3><p>ç¯å¢ƒæ­å»ºï¼šä¸€ä¸ªäººæœ‰ä¸¤ä¸ªå® ç‰©ï¼</p><h3 id="2ã€byNameè‡ªåŠ¨è£…é…"><a href="#2ã€byNameè‡ªåŠ¨è£…é…" class="headerlink" title="2ã€byNameè‡ªåŠ¨è£…é…"></a>2ã€byNameè‡ªåŠ¨è£…é…</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"cat"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Cat"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dog"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Dog"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">byName:ä¼šè‡ªåŠ¨åœ¨å®¹å™¨ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡setæ–¹æ³•åé¢çš„å€¼å¯¹åº”çš„bean id</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"people"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.People"</span> <span class="attr">autowire</span>=<span class="string">"byName"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å–µä¸æ˜“"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h3 id="3ã€byTypeè‡ªåŠ¨è£…é…"><a href="#3ã€byTypeè‡ªåŠ¨è£…é…" class="headerlink" title="3ã€byTypeè‡ªåŠ¨è£…é…"></a>3ã€byTypeè‡ªåŠ¨è£…é…</h3><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"cat"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Cat"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dog11"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.Dog"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">byType:ä¼šè‡ªåŠ¨åœ¨å®¹å™¨ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾ï¼Œå’Œè‡ªå·±å¯¹è±¡å±æ€§ç±»å‹ç›¸åŒçš„bean</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"people"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.pojo.People"</span> <span class="attr">autowire</span>=<span class="string">"byType"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"å–µä¸æ˜“"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>å°ç»“ï¼š</p><ul><li>byNameçš„æ—¶å€™ï¼Œéœ€è¦ä¿è¯æ‰€æœ‰beançš„idå”¯ä¸€ï¼Œå¹¶ä¸”è¿™ä¸ªbeanéœ€è¦å’Œè‡ªåŠ¨æ³¨å…¥çš„å±æ€§çš„setæ–¹æ³•çš„å€¼ä¸€è‡´ï¼</li><li>byTypeçš„æ—¶å€™ï¼Œéœ€è¦ä¿è¯æ‰€æœ‰beançš„classå”¯ä¸€ï¼Œå¹¶ä¸”è¿™ä¸ªbeanéœ€è¦å’Œè‡ªåŠ¨æ³¨å…¥çš„å±æ€§çš„ç±»å‹ä¸€è‡´ï¼</li></ul><h3 id="4ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"><a href="#4ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…" class="headerlink" title="4ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"></a>4ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…</h3><p>autowire å…ˆbyTypeï¼Œå¦‚æœç±»å‹å¤§äº1ï¼Œå†byName</p><p>jdk1.5æ”¯æŒçš„æ³¨è§£ï¼ŒSpring2.5å°±æ”¯æŒæ³¨è§£äº†ï¼</p><p>åŸºäºæ³¨é‡Šçš„é…ç½®çš„å¼•å…¥æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå³è¿™ç§æ–¹æ³•æ˜¯å¦æ¯”XMLâ€œæ›´å¥½â€ã€‚</p><p>è¦ä½¿ç”¨æ³¨è§£é¡»çŸ¥ï¼š</p><ol><li>å¯¼å…¥çº¦æŸ contextçº¦æŸ</li><li>é…ç½®æ³¨è§£çš„æ”¯æŒï¼š==&lt;context: annotation-config/&gt;==</li></ol><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xm1 version="1. 0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xm7ns</span>=<span class="string">"http://www.springframework.org/ schema/beans"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xm1ns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xm1ns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemalocati</span> <span class="attr">on</span>=<span class="string">"http: / /www. springf ramework. org/ schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springf ramework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    https://www.springf ramework.org/schema/context/spring-context. xsd"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--å¼€å¯æ³¨è§£çš„æ”¯æŒ--&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">context:</span> <span class="attr">annotation-config</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span>|</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>@Autowired</p><p>ç›´æ¥åœ¨å±æ€§ä¸Šä½¿ç”¨å³å¯ï¼ä¹Ÿå¯ä»¥åœ¨setæ–¹å¼ä¸Šä½¿ç”¨ï¼</p><p>ä½¿ç”¨Autowiredæˆ‘ä»¬å¯ä»¥ä¸ç”¨ç¼–å†™setæ–¹æ³•äº†ï¼Œå‰ææ˜¯ä½ è¿™ä¸ªè‡ªåŠ¨è£…é…çš„å±æ€§åœ¨IOCå®¹å™¨ï¼ˆSpringï¼‰å®¹å™¨ä¸­å­˜åœ¨ã€‚ä¸”ç¬¦åˆbyNameå’ŒbyType</p><p>ç§‘æ™®ï¼š</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Nullable</span> å­—æ®µæ ‡è®°äº†è¿™ä¸ªæ³¨è§£ï¼Œè¯´æ˜è¿™ä¸ªå­—æ®µå¯ä»¥ä¸º<span class="literal">null</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Autowired {</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å¦‚æœæ˜¾ç¤ºå®šä¹‰äº†Autowiredçš„requiredå±æ€§ä¸ºfalse,è¯´æ˜è¿™ä¸ªå¯¹è±¡å¯ä»¥ä¸ºnullï¼Œå¦åˆ™ä¸å…è®¸ä¸ºç©º</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired(rerequired = false)</span></span><br></pre></td></tr></tbody></table></figure><p>æµ‹è¯•ä»£ç </p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> {</span><br><span class="line">    <span class="comment">//å¦‚æœæ˜¾ç¤ºå®šä¹‰äº†Autowi redçš„requi redå±æ€§ä¸ºfalseï¼Œè¯´æ˜è¿™ä¸ªå¯¹è±¡å¯ä»¥ä¸ºnu11ï¼Œå¦åˆ™ä¸å…è®¸ä¸ºç©º</span></span><br><span class="line">    <span class="meta">@Autowired(required = false)</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>å¦‚æœ@Autowiredè‡ªåŠ¨è£…é…çš„ç¯å¢ƒæ¯”è¾ƒå¤æ‚ï¼Œè‡ªåŠ¨è£…é…æ— æ³•é€šè¿‡ä¸€ä¸ªæ³¨è§£ã€@Autowiredã€‘å®Œæˆçš„æ—¶å€™ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Qualifier(value=â€xxxâ€)å»é…ç½®@Autowiredçš„ä½¿ç”¨ï¼ŒæŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„beanå¯¹è±¡æ³¨å…¥! </p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">pub1ic <span class="keyword">class</span> <span class="title class_">People</span> {</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(va1ue="cat111")</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowi</span> red</span><br><span class="line">    <span class="meta">@Qualifier(va1ue="dog222")</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>@Resourceæ³¨è§£</strong></p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">pub1ic <span class="keyword">class</span> <span class="title class_">Peop1e</span> {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = "cat2")</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>jdk11æ²¡æœ‰@Resource</p><p>å°ç»“ï¼š</p><p>autowiredæ˜¯å…ˆbyteType,å¦‚æœå”¯ä¸€å‰‡æ³¨å…¥ï¼Œå¦åˆ™byNameæŸ¥æ‰¾ã€‚</p><p>resourceæ˜¯å…ˆbyname,ä¸ç¬¦åˆå†ç»§ç»­byType</p><h2 id="8ã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8ã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8ã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8ã€ä½¿ç”¨æ³¨è§£å¼€å‘</h2><p><strong>æ³¨è§£è¯´æ˜</strong>ï¼š</p><ul><li><p>@Autowired :è‡ªåŠ¨è£…é…é€šè¿‡ç±»å‹ã€‚åå­—å¦‚æœAutowiredä¸èƒ½å”¯ä¸€è‡ªåŠ¨è£…é… ä¸Šå±æ€§ï¼Œåˆ™éœ€è¦é€šè¿‡@Qualifier(value=â€ xxxâ€ )</p></li><li><p>@Nu1lableå­—æ®µæ ‡è®° äº†è¿™ä¸ªæ³¨è§£ï¼Œè¯´æ˜è¿™ä¸ªå­—æ®µå¯ä»¥ä¸ºnu11; .</p></li><li><p>@Resource:è‡ªåŠ¨è£…é…é€šè¿‡åå­—ã€‚ç±»å‹ã€‚</p></li><li><p>@Component :ç»„ä»¶ï¼Œæ”¾åœ¨ç±»ä¸Šï¼Œè¯´æ˜è¿™ä¸ªç±»è¢«Springç®¡ç†äº†ï¼Œå°±æ˜¯bean!</p></li></ul><p>åœ¨Spring4ä¹‹åï¼Œè¦ä½¿ç”¨æ³¨è§£å¼€å‘ï¼ŒAOPçš„åŒ…å¿…é¡»å¯¼å…¥</p><p>ä½¿ç”¨æ³¨è§£éœ€è¦å¯¼å…¥contextçº¦æŸï¼Œå¢åŠ æ³¨è§£çš„æ”¯æŒï¼</p><ol><li><p>bean</p></li><li><p>å±æ€§å¦‚ä½•æ³¨å…¥</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//ç­‰ä»·äº    &lt;bean id="user" class="com.miaobuyi.pojo.User"/&gt;</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line">    <span class="comment">//ç›¸å½“äº&lt;property name="name" value="å–µä¸æ˜“"/&gt;</span></span><br><span class="line">    <span class="meta">@Value("miaobuyi")</span></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> {</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure></li><li><p>è¡ç”Ÿçš„æ³¨è§£</p><p>@Componentæœ‰å‡ ä¸ªè¡ç”Ÿæ³¨è§£ï¼Œæˆ‘ä»¬åœ¨webå¼€å‘ä¸­ï¼Œä¼šæŒ‰ç…§mvcä¸‰å±‚æ¶æ„åˆ†å±‚</p><ul><li>daoã€@Repositoryã€‘</li><li>serviceã€@Serviceã€‘</li><li>controllerã€@Controllerã€‘</li></ul><p>è¿™å››ä¸ªæ³¨è§£åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä»£è¡¨å°†æŸä¸ªç±»æ³¨å†Œåˆ°Springä¸­ï¼Œè£…é…Bean</p></li><li><p>è‡ªåŠ¨è£…é…</p><ul><li>@Autowired :è‡ªåŠ¨è£…é…é€šè¿‡ç±»å‹ã€‚åå­—å¦‚æœAutowiredä¸èƒ½å”¯ä¸€è‡ªåŠ¨è£…é… ä¸Šå±æ€§ï¼Œåˆ™éœ€è¦é€šè¿‡@Qualifier(value=â€ xxxâ€ )</li><li>@Nu1lableå­—æ®µæ ‡è®° äº†è¿™ä¸ªæ³¨è§£ï¼Œè¯´æ˜è¿™ä¸ªå­—æ®µå¯ä»¥ä¸ºnu11; .</li><li>@Resource:è‡ªåŠ¨è£…é…é€šè¿‡åå­—ã€‚ç±»å‹ã€‚</li></ul></li><li><p>ä½œç”¨åŸŸ</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope("prototype")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line">    <span class="comment">//ç›¸å½“äº&lt;property name="name" value="å–µä¸æ˜“"/&gt;</span></span><br><span class="line">    <span class="meta">@Value("miaobuyi")</span></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> {</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>å°ç»“</p></li></ol><p> xmlä¸æ³¨è§£ï¼š</p><ul><li>xmlæ›´åŠ ä¸‡èƒ½ï¼Œé€‚ç”¨äºä»»ä½•åœºåˆï¼ç»´æŠ¤ç®€å•æ–¹ä¾¿</li><li>æ³¨è§£ï¼Œä¸æ˜¯è‡ªå·±çš„ç±»ä¸èƒ½ä½¿ç”¨ï¼Œç»´æŠ¤ç›¸å¯¹å¤æ‚</li></ul><p>xmlä¸æ³¨è§£æœ€ä½³å®è·µï¼š</p><ul><li>xmlç”¨æ¥ç®¡ç†beanï¼›</li><li>æ³¨è§£åªè´Ÿè´£å®Œæˆå±æ€§çš„æ³¨å…¥ï¼›</li><li>æˆ‘ä»¬åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼šå¿…é¡»è®©æ³¨è§£ç”Ÿæ•ˆï¼Œå°±éœ€è¦å¼€å¯æ³¨è§£æ”¯æŒ</li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æŒ‡å®šè¦æ‰«æçš„åŒ…ï¼Œè¿™ä¸ªåŒ…ä¸‹çš„æ³¨è§£å°±ä¼šç”Ÿæ•ˆ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.miaobuyi"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><h2 id="9ã€ä½¿ç”¨javaçš„æ–¹å¼é…ç½®Spring"><a href="#9ã€ä½¿ç”¨javaçš„æ–¹å¼é…ç½®Spring" class="headerlink" title="9ã€ä½¿ç”¨javaçš„æ–¹å¼é…ç½®Spring"></a>9ã€ä½¿ç”¨javaçš„æ–¹å¼é…ç½®Spring</h2><p>æˆ‘ä»¬ç°åœ¨è¦å®Œå…¨ä¸ä½¿ç”¨Springçš„xmlé…ç½®äº†ï¼Œå…¨æƒäº¤ç»™javaæ¥åšï¼</p><p>javaConfigæ˜¯Springçš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œåœ¨Spring4ä¹‹åï¼Œå®ƒæˆä¸ºäº†æ ¸å¿ƒåŠŸèƒ½</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210722194702296.png" alt="image-20210722194702296"></p><p>å®ä½“ç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡Œè¿™ä¸ªæ³¨è§£çš„æ„æ€ï¼Œå°±æ˜¯è¯´æ˜è¿™ä¸ªç±»è¢«Springæ¥ç®¡äº†ï¼Œæ³¨å†Œåˆ°äº†å®¹å™¨ä¸­</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value("miaobuyi")</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> {</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User{"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'}'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>é…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.config;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Import;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™ä¸ªä¹Ÿä¼šSpringå®¹å™¨æ‰˜ç®¡ï¼Œæ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œåº”ä¸ºä»–æœ¬æ¥å°±æ˜¯ä¸€ä¸ª@Componentï¼Œ@Configurationä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œå°±å’Œæˆ‘ä»¬ä¹‹å‰çœ‹çš„beans.xmlä¸€æ ·çš„</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan("com.miaobuyi")</span></span><br><span class="line"><span class="meta">@Import(MyConfig2.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> {</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ³¨å†Œä¸€ä¸ªbeanï¼Œå°±ç›¸å½“äºæˆ‘ä»¬ä¹‹å‰çš„ä¸€ä¸ªbeanæ ‡ç­¾</span></span><br><span class="line">    <span class="comment">//è¿™ä¸ªæ–¹æ³•çš„åå­—ï¼Œå°±ç›¸å½“äºbeanæ ‡ç­¾ä¸­çš„idå±æ€§</span></span><br><span class="line">    <span class="comment">//è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼Œå°±ç›¸å½“äºbeanæ ‡ç­¾ä¸­çš„classå±æ€§</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">()</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();<span class="comment">//å°±æ˜¯è¦è¿”å›è¦æ³¨å…¥åˆ°beançš„å¯¹è±¡</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>æµ‹è¯•ç±»</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.miaobuyi.config.MyConfig;</span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> {</span><br><span class="line">    <span class="comment">//å¦‚æœå®Œå…¨ä½¿ç”¨äº†é…ç½®ç±»æ–¹å¼å»åšï¼Œæˆ‘ä»¬å°±åªèƒ½é€šè¿‡AnnotationConfig ä¸Šä¸‹æ–‡æ¥è·å–å®¹å™¨ï¼Œé€šè¿‡é…ç½®ç±»çš„classå¯¹è±¡åŠ è½½</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MyConfig.class);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> context.getBean(<span class="string">"getUser"</span>, User.class);</span><br><span class="line">        System.out.println(user.getName());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>è¿™ç§çº¯javaçš„é…ç½®æ–¹å¼ï¼Œåœ¨SpringBootä¸­éšå¤„å¯è§ï¼</p><h2 id="10ã€ä»£ç†æ¨¡å¼"><a href="#10ã€ä»£ç†æ¨¡å¼" class="headerlink" title="10ã€ä»£ç†æ¨¡å¼"></a>10ã€ä»£ç†æ¨¡å¼</h2><p>ä¸ºä»€ä¹ˆè¦å­¦ä¹ ä»£ç†æ¨¡å¼ï¼Ÿå› ä¸ºè¿™å°±æ˜¯SpringAOPçš„åº•å±‚ï¼ã€SpringAOPå’ŒSpringMVCã€‘</p><p>ä»£ç†æ¨¡å¼çš„åˆ†ç±»ï¼š</p><ul><li>é™æ€ä»£ç†</li><li>åŠ¨æ€ä»£ç†</li></ul><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210722212902919.png" alt="image-20210722212902919"></p><h3 id="1ã€-é™æ€ä»£ç†"><a href="#1ã€-é™æ€ä»£ç†" class="headerlink" title="1ã€ é™æ€ä»£ç†"></a>1ã€ é™æ€ä»£ç†</h3><p>è§’è‰²åˆ†æï¼š</p><ul><li>æŠ½è±¡è§’è‰²ï¼šä¸€èˆ¬ä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥è§£å†³</li><li>çœŸå®è§’è‰²ï¼šè¢«ä»£ç†çš„è§’è‰²</li><li>ä»£ç†è§’è‰²ï¼šä»£ç†çœŸå®è§’è‰²ï¼Œä»£ç†æ­£å¼è§’è‰²åï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåšä¸€äº›é™„å±æ“ä½œ</li><li>å®¢æˆ·ï¼šè®¿é—®ä»£ç†å¯¹è±¡çš„äºº</li></ul><p>ä»£ç æ­¥éª¤ï¼š</p><ol><li><p>æ¥å£</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo01;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç§Ÿæˆ¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>çœŸå®è§’è‰²</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo01;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ¿ä¸œ</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Host</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"æˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Proxy</span> <span class="keyword">implements</span> <span class="title class_">Rent</span>{</span><br><span class="line">    <span class="keyword">private</span> Host host;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">()</span> {</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">(Host host)</span> {</span><br><span class="line">        <span class="built_in">this</span>.host = host;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> {</span><br><span class="line">        seeHouse();</span><br><span class="line">        host.rent();</span><br><span class="line">        hetong();</span><br><span class="line">        fare();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//çœ‹æˆ¿</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span>{</span><br><span class="line">        System.out.println(<span class="string">"ä¸­ä»‹å¸¦ä½ çœ‹æˆ¿"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç­¾åˆåŒ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hetong</span><span class="params">()</span>{</span><br><span class="line">        System.out.println(<span class="string">"ç­¾åˆåŒ"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ”¶ä¸­ä»‹è´¹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fare</span><span class="params">()</span>{</span><br><span class="line">        System.out.println(<span class="string">"æ”¶ä¸­ä»‹è´¹"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>å®¢æˆ·ç«¯è®¿é—®ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">client</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="comment">//ç§Ÿå®¢è¦ç§Ÿæˆ¿å­ï¼Œéœ€è¦ä¸€ä¸ªæˆ¿ä¸œ</span></span><br><span class="line">        <span class="type">Host</span> <span class="variable">host</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Host</span>();</span><br><span class="line">        <span class="comment">//ä»£ç†ï¼Œä¸­ä»‹å¸®ç§Ÿå®¢ç§Ÿæˆ¿å­ï¼Œä½†æ˜¯ï¼Œä»£ç†è§’è‰²ä¸€èˆ¬ä¼šæœ‰ä¸€äº›é™„å±æ“ä½œ</span></span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(host);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä½ ä¸ç”¨é¢å¯¹æˆ¿ä¸œç›´æ¥æ‰¾ä¸­ä»‹ç§Ÿæˆ¿</span></span><br><span class="line">        proxy.rent();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p>ä»£ç†æ¨¡å¼çš„å¥½å¤„ï¼š</p><ul><li>å¯ä»¥ä½¿çœŸå®è§’è‰²çš„æ“ä½œæ›´åŠ çº¯ç²¹ï¼ä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡</li><li>å…¬å…±ä¹Ÿå°±äº¤ç»™äº†ä»£ç†è§’è‰²ï¼å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ï¼</li><li>å…¬å…±ä¸šåŠ¡é˜²èº«ä¸ªæ‹“å±•çš„æ—¶å€™ï¼Œæ–¹ä¾¿é›†ä¸­ç®¡ç†ï¼</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä¸€ä¸ªçœŸå®è§’è‰²å°±ä¼šäº§ç”Ÿä¸€ä¸ªä»£ç†è§’è‰²ï¼›ä»£ç é‡ä¼šç¿»~å¼€å‘æ•ˆç‡ä¼šè´¬å˜ä½</li></ul><h3 id="2ã€åŠ æ·±ç†è§£"><a href="#2ã€åŠ æ·±ç†è§£" class="headerlink" title="2ã€åŠ æ·±ç†è§£"></a>2ã€åŠ æ·±ç†è§£</h3><p>ä»£ç æ­¥éª¤ï¼š</p><ol><li><p>æ¥å£</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li><li><p>çœŸå®è§’è‰²</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo02;</span><br><span class="line"></span><br><span class="line"><span class="comment">//çœŸå®å¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"ä¿®æ”¹äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.æ”¹åŠ¨åŸæœ‰çš„ä¸šåŠ¡ä»£ç ï¼Œåœ¨å…¬å¸ä¸­æ˜¯å¤§å¿Œï¼</span></span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li><li><p>ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceProxy</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserServiceImpl userService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserService</span><span class="params">(UserServiceImpl userService)</span> {</span><br><span class="line">        <span class="built_in">this</span>.userService = userService;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> {</span><br><span class="line">        log(<span class="string">"add"</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> {</span><br><span class="line">        log(<span class="string">"delete"</span>);</span><br><span class="line">        userService.delete();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> {</span><br><span class="line">        log(<span class="string">"update"</span>);</span><br><span class="line">        userService.update();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> {</span><br><span class="line">        log(<span class="string">"query"</span>);</span><br><span class="line">        userService.query();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åŠ ä¸€ä¸ªæ—¥å¿—æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String msg)</span>{</span><br><span class="line">        System.out.println(<span class="string">"[Debug] ä½¿ç”¨äº†"</span>+msg+<span class="string">"æ–¹æ³•"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li><li><p>å®¢æˆ·ç«¯è®¿é—®ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">UserServiceImpl</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line">        <span class="type">UserServiceProxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceProxy</span>();</span><br><span class="line">        proxy.setUserService(userService);</span><br><span class="line">        proxy.add();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li></ol><p>èŠèŠAOP</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210722221543080.png" alt="image-20210722221543080"></p><h3 id="3ã€åŠ¨æ€ä»£ç†"><a href="#3ã€åŠ¨æ€ä»£ç†" class="headerlink" title="3ã€åŠ¨æ€ä»£ç†"></a>3ã€åŠ¨æ€ä»£ç†</h3><ul><li>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†è§’è‰²ä¸€æ ·</li><li>åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œä¸æ˜¯æˆ‘ä»¬å†™å¥½çš„ï¼</li><li>åŠ¨æ€ä»£ç†å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šåŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†ï¼ŒåŸºäºç±»çš„åŠ¨æ€ä»£ç†<ul><li>åŸºäºæ¥å£â€”JDKåŠ¨æ€ä»£ç†ã€æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ã€‘</li><li>åŸºäºç±»â€”cglib</li><li>Javaå­—èŠ‚ç å®ç°ï¼šjavassist</li></ul></li></ul><p>éœ€è¦äº†è§£ä¸¤ä¸ªç±»ï¼šProxyï¼šä»£ç†ï¼ŒInvocationHandlerï¼šè°ƒç”¨å¤„ç†ç¨‹åº</p><p>åŠ¨æ€ä»£ç†çš„å¥½å¤„ï¼š</p><ul><li>å¯ä»¥ä½¿çœŸå®è§’è‰²çš„æ“ä½œæ›´åŠ çº¯ç²¹ï¼ä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡</li><li>å…¬å…±ä¹Ÿå°±äº¤ç»™äº†ä»£ç†è§’è‰²ï¼å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ï¼</li><li>å…¬å…±ä¸šåŠ¡é˜²èº«ä¸ªæ‹“å±•çš„æ—¶å€™ï¼Œæ–¹ä¾¿é›†ä¸­ç®¡ç†ï¼</li><li>ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»ä»£ç†çš„æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸€èˆ¬å¯¹åº”çš„ä¸€ç±»ä¸šåŠ¡</li><li>ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œåªè¦å®ç°äº†åŒä¸€ä¸ªæ¥å£å³å¯</li></ul><h2 id="11ã€AOP"><a href="#11ã€AOP" class="headerlink" title="11ã€AOP"></a>11ã€AOP</h2><p><strong>æ¨ªå‘ç¼–ç¨‹çš„æ€æƒ³ï¼Œåœ¨ä¸å½±å“åŸæ¥ä¸šåŠ¡ç±»çš„æƒ…å†µä¸‹å®ç°åŠ¨æ€å¢å¼º</strong></p><h3 id="1ã€ä»€ä¹ˆæ˜¯AOP"><a href="#1ã€ä»€ä¹ˆæ˜¯AOP" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯AOP"></a>1ã€ä»€ä¹ˆæ˜¯AOP</h3><p>AOP (Aspect Oriented Programming)æ„ä¸º:é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOP æ˜¯OOPçš„å»¶ç»­,æ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹,ä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€-ä¸ªé‡è¦å†…å®¹,æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒå‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210726160535693.png" alt="image-20210726160535693"></p><h3 id="2ã€Aopåœ¨Springä¸­çš„ä½œç”¨"><a href="#2ã€Aopåœ¨Springä¸­çš„ä½œç”¨" class="headerlink" title="2ã€Aopåœ¨Springä¸­çš„ä½œç”¨"></a>2ã€Aopåœ¨Springä¸­çš„ä½œç”¨</h3><p>==æä¾›å£°æ˜å¼äº‹åŠ¡;å…è®¸ç”¨æˆ·è‡ªå®šä¹‰åˆ‡é¢==</p><ul><li>æ¨ªåˆ‡å…³æ³¨ç‚¹:è·¨è¶Šåº”ç”¨ç¨‹åºå¤šä¸ªæ¨¡å—çš„æ–¹æ³•æˆ–åŠŸèƒ½ã€‚å³æ˜¯ï¼Œä¸æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘æ— å…³çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„éƒ¨åˆ†ï¼Œå°±æ˜¯æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¦‚æ—¥å¿—ï¼Œå®‰å…¨,ç¼“å­˜,äº‹åŠ¡ç­‰ç­‰â€¦</li><li>åˆ‡é¢(ASPECT) :æ¨ªåˆ‡å…³æ³¨ç‚¹è¢«æ¨¡å—åŒ–çš„ç‰¹æ®Šå¯¹è±¡ã€‚å³ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»ã€‚</li><li>é€šçŸ¥(Advice) :åˆ‡é¢å¿…é¡»è¦å®Œæˆçš„å·¥ä½œã€‚å³ï¼Œå®ƒæ˜¯ç±»ä¸­çš„-ä¸€ä¸ªæ–¹æ³•ã€‚</li><li>ç›®æ ‡(Target) :è¢«é€šçŸ¥å¯¹è±¡ã€‚</li><li>ä»£ç†(Proxy) :å‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„å¯¹è±¡ã€‚</li><li>åˆ‡å…¥ç‚¹(PointCut) :åˆ‡é¢é€šçŸ¥æ‰§è¡Œçš„â€œåœ°ç‚¹â€çš„å®šä¹‰ã€‚</li><li>è¿æ¥ç‚¹(JointPoint) :ä¸åˆ‡å…¥ç‚¹åŒ¹é…çš„æ‰§è¡Œç‚¹ã€‚</li></ul><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210726190134497.png" alt="image-20210726190134497"></p><p>SpringAOPä¸­ï¼Œé€šè¿‡Adviceå®šä¹‰æ¨ªåˆ‡é€»è¾‘ï¼ŒSpringä¸­æ”¯æŒ5ä¸­ç±»å‹çš„Adviceï¼š</p><p><img src="C:\Users\æ¨å®‡\AppData\Roaming\Typora\typora-user-images\image-20210726203150571.png" alt="image-20210726203150571"></p><p>å³AOPåœ¨ä¸ç›–é¢åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œå»å¢åŠ æ–°çš„åŠŸèƒ½</p><h3 id="3ã€ä½¿ç”¨Springå®ç°AOP"><a href="#3ã€ä½¿ç”¨Springå®ç°AOP" class="headerlink" title="3ã€ä½¿ç”¨Springå®ç°AOP"></a>3ã€ä½¿ç”¨Springå®ç°AOP</h3><p>ã€é‡ç‚¹ã€‘ä½¿ç”¨AOPç»‡å…¥ï¼Œéœ€è¦ä¸€ä¸ªä¾èµ–åŒ…</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj <span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h4 id="æ–¹å¼ä¸€ï¼šä½¿ç”¨Springçš„APIæ¥å£ã€ä¸»è¦æ˜¯SpringAPIæ¥å£å®ç°ã€‘"><a href="#æ–¹å¼ä¸€ï¼šä½¿ç”¨Springçš„APIæ¥å£ã€ä¸»è¦æ˜¯SpringAPIæ¥å£å®ç°ã€‘" class="headerlink" title="æ–¹å¼ä¸€ï¼šä½¿ç”¨Springçš„APIæ¥å£ã€ä¸»è¦æ˜¯SpringAPIæ¥å£å®ç°ã€‘"></a>æ–¹å¼ä¸€ï¼šä½¿ç”¨Springçš„APIæ¥å£ã€ä¸»è¦æ˜¯SpringAPIæ¥å£å®ç°ã€‘</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.AfterReturningAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AfterLog</span>  <span class="keyword">implements</span> <span class="title class_">AfterReturningAdvice</span> {</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnValue è¿”å›å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> method</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">(Object returnValue, Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable {</span><br><span class="line">        System.out.println(<span class="string">"æ‰§è¡Œäº†"</span>+method.getName()+<span class="string">"æ–¹æ³•ï¼Œè¿”å›ç»“æœä¸ºï¼š"</span>+returnValue);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.MethodBeforeAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">log</span> <span class="keyword">implements</span> <span class="title class_">MethodBeforeAdvice</span> {</span><br><span class="line"></span><br><span class="line">    <span class="comment">//method:è¦æ‰§è¡Œçš„ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//argsï¼šå‚æ•°</span></span><br><span class="line">    <span class="comment">//targetï¼šç›®æ ‡å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(Method method, Object[] objects, Object target)</span> <span class="keyword">throws</span> Throwable {</span><br><span class="line">        System.out.println(target.getClass().getName()+<span class="string">"çš„"</span>+method.getName()+<span class="string">"è¢«æ‰§è¡Œäº†"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">select</span><span class="params">()</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">select</span><span class="params">()</span> {</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.service.UserServiceImpl"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"log"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.log.log"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"afterLog"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.log.AfterLog"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ–¹å¼ä¸€ï¼šä½¿ç”¨SpringåŸç”ŸSpring APIæ¥å£--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®aop:éœ€è¦å¯¼å…¥aopçš„çº¦æŸ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆ‡å…¥ç‚¹ expression:è¡¨è¾¾å¼,execution(è¦æ‰§è¡Œçš„ä½ç½®ï¼ * * * *)--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pointcut"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.miaobuyi.service.UserServiceImpl.*(..))"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--æ‰§è¡Œç¯ç»•å¢å¼º--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"log"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"afterLog"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æ–¹å¼äºŒï¼šè‡ªå®šä¹‰ç±»æ¥å®ç°AOPã€ä¸»è¦æ˜¯åˆ‡é¢å®šä¹‰ã€‘"><a href="#æ–¹å¼äºŒï¼šè‡ªå®šä¹‰ç±»æ¥å®ç°AOPã€ä¸»è¦æ˜¯åˆ‡é¢å®šä¹‰ã€‘" class="headerlink" title="æ–¹å¼äºŒï¼šè‡ªå®šä¹‰ç±»æ¥å®ç°AOPã€ä¸»è¦æ˜¯åˆ‡é¢å®šä¹‰ã€‘"></a>æ–¹å¼äºŒï¼šè‡ªå®šä¹‰ç±»æ¥å®ç°AOPã€ä¸»è¦æ˜¯åˆ‡é¢å®šä¹‰ã€‘</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.diy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiyPointCut</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>{</span><br><span class="line">        System.out.println(<span class="string">"==========æ–¹æ³•æ‰§è¡Œå‰=========="</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>{</span><br><span class="line">        System.out.println(<span class="string">"==========æ–¹æ³•æ‰§è¡Œå=========="</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.service.UserServiceImpl"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"log"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.log.log"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"afterLog"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.log.AfterLog"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ–¹å¼ä¸€ï¼šä½¿ç”¨SpringåŸç”ŸSpring APIæ¥å£--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®aop:éœ€è¦å¯¼å…¥aopçš„çº¦æŸ--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;aop:config&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash;åˆ‡å…¥ç‚¹ expression:è¡¨è¾¾å¼,execution(è¦æ‰§è¡Œçš„ä½ç½®ï¼ * * * *)&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;aop:pointcut id="pointcut" expression="execution(* com.miaobuyi.service.UserServiceImpl.*(..))"/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash;æ‰§è¡Œç¯ç»•å¢å¼º&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;aop:advisor advice-ref="log" pointcut-ref="pointcut"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;aop:advisor advice-ref="afterLog" pointcut-ref="pointcut"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/aop:config&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ–¹å¼äºŒï¼šè‡ªå®šä¹‰ç±»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"diyPointCut"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.diy.DiyPointCut"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è‡ªå®šä¹‰åˆ‡é¢ï¼Œref è¦å¼•ç”¨çš„ç±»--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"diyPointCut"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--åˆ‡å…¥ç‚¹--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"point"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.miaobuyi.service.UserServiceImpl.*(..))"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--é€šçŸ¥--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"before"</span> <span class="attr">pointcut-ref</span>=<span class="string">"point"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"after"</span> <span class="attr">pointcut-ref</span>=<span class="string">"point"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h4 id="æ–¹å¼ä¸‰ï¼šä½¿ç”¨æ³¨è§£"><a href="#æ–¹å¼ä¸‰ï¼šä½¿ç”¨æ³¨è§£" class="headerlink" title="æ–¹å¼ä¸‰ï¼šä½¿ç”¨æ³¨è§£"></a>æ–¹å¼ä¸‰ï¼šä½¿ç”¨æ³¨è§£</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å†Œbean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.service.UserServiceImpl"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"log"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.log.log"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"afterLog"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.log.AfterLog"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ–¹å¼ä¸€ï¼šä½¿ç”¨SpringåŸç”ŸSpring APIæ¥å£--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®aop:éœ€è¦å¯¼å…¥aopçš„çº¦æŸ--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;aop:config&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash;åˆ‡å…¥ç‚¹ expression:è¡¨è¾¾å¼,execution(è¦æ‰§è¡Œçš„ä½ç½®ï¼ * * * *)&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;aop:pointcut id="pointcut" expression="execution(* com.miaobuyi.service.UserServiceImpl.*(..))"/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash;æ‰§è¡Œç¯ç»•å¢å¼º&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;aop:advisor advice-ref="log" pointcut-ref="pointcut"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;aop:advisor advice-ref="afterLog" pointcut-ref="pointcut"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/aop:config&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ–¹å¼äºŒï¼šè‡ªå®šä¹‰ç±»--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;bean id="diyPointCut" class="com.miaobuyi.diy.DiyPointCut"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;aop:config&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &amp;lt;!&amp;ndash;è‡ªå®šä¹‰åˆ‡é¢ï¼Œref è¦å¼•ç”¨çš„ç±»&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;aop:aspect ref="diyPointCut"&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &amp;lt;!&amp;ndash;åˆ‡å…¥ç‚¹&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;aop:pointcut id="point" expression="execution(* com.miaobuyi.service.UserServiceImpl.*(..))"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &amp;lt;!&amp;ndash;é€šçŸ¥&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;aop:before method="before" pointcut-ref="point"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;aop:after method="after" pointcut-ref="point"/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/aop:aspect&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/aop:config&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ–¹å¼ä¸‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"annotationPointCut"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.diy.AnnotationPointCut"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¼€å¯æ³¨è§£æ”¯æŒ  JDK(é»˜è®¤ proxy-target-class="false")  cglibï¼ˆproxy-target-class="true"ï¼‰--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.diy;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹å¼ä¸‰ ä½¿ç”¨æ³¨è§£æ–¹å¼å®ç°AOP</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.Signature;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span><span class="comment">//æ ‡æ³¨è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªåˆ‡é¢</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationPointCut</span> {</span><br><span class="line">    <span class="meta">@Before("execution(* com.miaobuyi.service.UserServiceImpl.*(..))")</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>{</span><br><span class="line">        System.out.println(<span class="string">"==========æ–¹æ³•æ‰§è¡Œå‰=========="</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="meta">@After("execution(* com.miaobuyi.service.UserServiceImpl.*(..))")</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>{</span><br><span class="line">        System.out.println(<span class="string">"==========æ–¹æ³•æ‰§è¡Œå=========="</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨ç¯ç»•å¢å¼ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®šä¸€ä¸ªå‚æ•°ï¼Œä»£è¡¨æˆ‘ä»¬è¦è·å–å¤„ç†åˆ‡å…¥çš„ç‚¹</span></span><br><span class="line">    <span class="meta">@Around("execution(* com.miaobuyi.service.UserServiceImpl.*(..))")</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">around</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable {</span><br><span class="line">        System.out.println(<span class="string">"ç¯ç»•å‰"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> joinPoint.getSignature();<span class="comment">//è·å¾—ç­¾å</span></span><br><span class="line">        System.out.println(signature);</span><br><span class="line">        <span class="comment">//æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">proceed</span> <span class="operator">=</span> joinPoint.proceed();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"ç¯ç»•å"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(proceed);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="12ã€æ•´åˆMybatis"><a href="#12ã€æ•´åˆMybatis" class="headerlink" title="12ã€æ•´åˆMybatis"></a>12ã€æ•´åˆMybatis</h2><p>æ­¥éª¤ï¼š</p><ol><li><p>å¯¼å…¥ç›¸å…³jaråŒ…</p><ul><li>junit</li><li>mybatis</li><li>mysqlæ•°æ®åº“</li><li>Springç›¸å…³çš„</li><li>aopç»‡å…¥</li><li>mybatis-Springã€newã€‘</li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Springæ“ä½œæ•°æ®åº“çš„è¯è¿˜éœ€è¦ä¸€ä¸ªspring-jdbc--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>ç¼–å†™é…ç½®æ–‡ä»¶</p></li><li><p>æµ‹è¯•</p></li></ol><h3 id="1ã€å›å¿†Mybatis"><a href="#1ã€å›å¿†Mybatis" class="headerlink" title="1ã€å›å¿†Mybatis"></a>1ã€å›å¿†Mybatis</h3><ol><li>ç¼–å†™å®ä½“ç±»</li><li>ç¼–å†™æ ¸å¿ƒé…ç½®æ–‡ä»¶</li><li>ç¼–å†™æ¥å£</li><li>ç¼–å†™Mapper.xml</li><li>æµ‹è¯•</li></ol><h3 id="2ã€Mybatis-spring"><a href="#2ã€Mybatis-spring" class="headerlink" title="2ã€Mybatis-spring"></a>2ã€Mybatis-spring</h3><ol><li>ç¼–å†™æ•°æ®æº</li><li>sqlSessionFactory</li><li>sqlSessionTemplate</li><li>éœ€è¦ç»™æ¥å£åŠ å®ç°ç±»ã€ã€‘</li><li>å°†è‡ªå·±å†™çš„å®ç°ç±»ï¼Œæ³¨å…¥åˆ°Springä¸­</li><li>æµ‹è¯•ä½¿ç”¨å³å¯</li></ol><p>spring-dao.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--DataSourceï¼šä½¿ç”¨Springçš„æ•°æ®æºæ›¿æ¢Mybatisçš„é…ç½® c3p0 dbcp druid</span></span><br><span class="line"><span class="comment">    æˆ‘ä»¬è¿™é‡Œä½¿ç”¨Springæä¾›çš„JDBC</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"datasource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--SqlSessionFactory--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"datasource"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç»‘å®šmybatisé…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/miaobuyi/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--SqlSessionTemplate:å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„sqlSession--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionTemplate"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åªèƒ½ä½¿ç”¨æ„é€ å™¨æ³¨å…¥sqlSessionFactoryï¼Œå› ä¸ºä»–æ²¡æœ‰setæ–¹æ³•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!----&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"UserMapper"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.mapper.UserMapperImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSession"</span> <span class="attr">ref</span>=<span class="string">"sqlSession"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>applicationContext.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring-dao.xml"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!----&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"UserMapper"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.mapper.UserMapperImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSession"</span> <span class="attr">ref</span>=<span class="string">"sqlSession"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>UserMapperImpl.java</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ‘ä»¬æ‰€æœ‰æ“ä½œï¼Œåœ¨åŸæ¥éƒ½ä½¿ç”¨sqlSessionæ¥æ‰§è¡Œï¼Œç°åœ¨éƒ½ä½¿ç”¨SqlSessionTemplate</span></span><br><span class="line">    <span class="keyword">private</span> SqlSessionTemplate sqlSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSqlSession</span><span class="params">(SqlSessionTemplate sqlSession)</span> {</span><br><span class="line">        <span class="built_in">this</span>.sqlSession = sqlSession;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span> {</span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        <span class="keyword">return</span> mapper.selectUser();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>UserMapper.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.miaobuyi.mapper.UserMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUser"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>UserMapper.java</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> {</span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.miaobuyi.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> <span class="keyword">throws</span> IOException {</span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">"spring-dao.xml"</span>);</span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">userMapper</span> <span class="operator">=</span> context.getBean(<span class="string">"UserMapper"</span>, UserMapper.class);</span><br><span class="line">        <span class="keyword">for</span> (User user : userMapper.selectUser()) {</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æ–¹å¼äºŒ</p><p>é€šè¿‡ç»§æ‰¿è·å–SqlSession</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.miaobuyi.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.miaobuyi.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.support.SqlSessionDaoSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMapperImpl2</span> <span class="keyword">extends</span> <span class="title class_">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectUser</span><span class="params">()</span> {</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> getSqlSession().getMapper(UserMapper.class).selectUser();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>applicationContext.xml</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring-dao.xml"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!----&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"UserMapper"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.mapper.UserMapperImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSession"</span> <span class="attr">ref</span>=<span class="string">"sqlSession"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"UserMapper2"</span> <span class="attr">class</span>=<span class="string">"com.miaobuyi.mapper.UserMapperImpl2"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h2 id="13ã€å£°æ˜å¼äº‹åŠ¡"><a href="#13ã€å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="13ã€å£°æ˜å¼äº‹åŠ¡"></a>13ã€å£°æ˜å¼äº‹åŠ¡</h2><h3 id="1ã€å›é¡¾äº‹åŠ¡"><a href="#1ã€å›é¡¾äº‹åŠ¡" class="headerlink" title="1ã€å›é¡¾äº‹åŠ¡"></a>1ã€å›é¡¾äº‹åŠ¡</h3><ul><li>æŠŠä¸€ç»„ä¸šåŠ¡å½“æˆä¸€ä¸ªä¸šåŠ¡æ¥åšï¼šè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼</li><li>äº‹åŠ¡åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œååˆ†çš„é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œä¸èƒ½é©¬è™ï¼</li><li>ç¡®ä¿å®Œæ•´æ€§å’Œä¸€è‡´æ€§</li></ul><p>äº‹åŠ¡ACIDåŸåˆ™ï¼š</p><ul><li>åŸå­æ€§</li><li>ä¸€è‡´æ€§</li><li>éš”ç¦»æ€§<ul><li>å¤šä¸ªä¸šåŠ¡å¯èƒ½æ“ä½œåŒä¸€ä¸ªèµ„æºï¼Œé˜²æ­¢æ•°æ®æŸå</li></ul></li><li>æŒä¹…æ€§<ul><li>äº‹åŠ¡ä¸€æ—¦ä½“æ£€ï¼Œæ— è®ºç³»ç»Ÿå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Œç»“æœéƒ½ä¸ä¼šå†è¢«å½±å“ï¼Œè¢«æŒä¹…åŒ–çš„å†™åˆ°å­˜å‚¨å™¨ä¸­ï¼</li></ul></li></ul><p>2ã€Springå½“ä¸­çš„äº‹åŠ¡ç®¡ç†</p><ul><li>å£°æ˜å¼äº‹åŠ¡ï¼šAOP</li><li>ç¼–ç¨‹å¼äº‹åŠ¡ï¼šéœ€è¦åœ¨ä»£ç ä¸­ï¼Œè¿›è¡Œäº‹åŠ¡çš„ç®¡ç†</li></ul><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--DataSourceï¼šä½¿ç”¨Springçš„æ•°æ®æºæ›¿æ¢Mybatisçš„é…ç½® c3p0 dbcp druid</span></span><br><span class="line"><span class="comment">    æˆ‘ä»¬è¿™é‡Œä½¿ç”¨Springæä¾›çš„JDBC</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"datasource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--SqlSessionFactory--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"datasource"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç»‘å®šmybatisé…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/miaobuyi/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--SqlSessionTemplate:å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„sqlSession--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionTemplate"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åªèƒ½ä½¿ç”¨æ„é€ å™¨æ³¨å…¥sqlSessionFactoryï¼Œå› ä¸ºä»–æ²¡æœ‰setæ–¹æ³•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®å£°æ˜å¼äº‹åŠ¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"datasource"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»“åˆAOPå®ç°äº‹åŠ¡çš„ç»‡å…¥--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®äº‹åŠ¡é€šçŸ¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç»™é‚£äº›æ–¹æ³•é…ç½®äº‹åŠ¡--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é…ç½®äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§ï¼šnew  propagation= --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"delete"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"query"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®äº‹åŠ¡åˆ‡å…¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"txPoint"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.miaobuyi.mapper.*.*(..))"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"txPoint"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>æ€è€ƒï¼š</p><p>ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡ï¼Ÿ</p><ul><li>å¦‚æœä¸é…ç½®äº‹åŠ¡ï¼Œå¯èƒ½å­˜åœ¨æ•°æ®æäº¤ä¸ä¸€è‡´çš„æƒ…å†µä¸‹ï¼›</li><li>å¦‚æœæˆ‘ä»¬ä¸åœ¨Springä¸­å»é…ç½®å£°æ˜å¼äº‹åŠ¡ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨ä»£ç ä¸­æ‰‹åŠ¨é…ç½®äº‹åŠ¡ï¼</li><li>äº‹åŠ¡åœ¨é¡¹ç›®çš„å¼€å‘ä¸­ååˆ†é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§é—®é¢˜ï¼Œä¸å®¹é©¬è™</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
